<!DOCTYPE html><html lang="zh-CN" data-theme="light"><head><meta charset="UTF-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1.0,viewport-fit=cover"><title>9.前端工程化下篇_数据请求_状态管理 | yuezi</title><meta name="author" content="yuezi"><meta name="copyright" content="yuezi"><meta name="format-detection" content="telephone=no"><meta name="theme-color" content="#ffffff"><meta name="description" content="9. Vue3数据交互axios9.0 前置知识——promise9.0.1 回调函数 普通函数: 正常调用的函数,一般函数执行完毕后才会继续执行下一行代码 回调函数: 一些特殊的函数,表示未来才会执行的一些功能,后续代码不会等待该函数执行完毕就开始执行了  function fun1() &#123;    console.log(&quot;fun1 invoked&quot;);&#125;">
<meta property="og:type" content="article">
<meta property="og:title" content="9.前端工程化下篇_数据请求_状态管理">
<meta property="og:url" content="https://yuezi2048.github.io/2024/10/03/2.Areas%F0%9F%8C%90/back-end-java/4.JavaWeb/9.%E5%89%8D%E7%AB%AF%E5%B7%A5%E7%A8%8B%E5%8C%96%E4%B8%8B%E7%AF%87_%E6%95%B0%E6%8D%AE%E8%AF%B7%E6%B1%82_%E7%8A%B6%E6%80%81%E7%AE%A1%E7%90%86/index.html">
<meta property="og:site_name" content="yuezi">
<meta property="og:description" content="9. Vue3数据交互axios9.0 前置知识——promise9.0.1 回调函数 普通函数: 正常调用的函数,一般函数执行完毕后才会继续执行下一行代码 回调函数: 一些特殊的函数,表示未来才会执行的一些功能,后续代码不会等待该函数执行完毕就开始执行了  function fun1() &#123;    console.log(&quot;fun1 invoked&quot;);&#125;">
<meta property="og:locale" content="zh_CN">
<meta property="og:image" content="https://yuezi2048.github.io/img/touxiang.jpg">
<meta property="article:published_time" content="2024-10-03T13:51:57.000Z">
<meta property="article:modified_time" content="2024-10-03T13:51:57.000Z">
<meta property="article:author" content="yuezi">
<meta property="article:tag" content="4.JavaWeb">
<meta name="twitter:card" content="summary">
<meta name="twitter:image" content="https://yuezi2048.github.io/img/touxiang.jpg"><script type="application/ld+json">{
  "@context": "https://schema.org",
  "@type": "BlogPosting",
  "headline": "9.前端工程化下篇_数据请求_状态管理",
  "url": "https://yuezi2048.github.io/2024/10/03/2.Areas%F0%9F%8C%90/back-end-java/4.JavaWeb/9.%E5%89%8D%E7%AB%AF%E5%B7%A5%E7%A8%8B%E5%8C%96%E4%B8%8B%E7%AF%87_%E6%95%B0%E6%8D%AE%E8%AF%B7%E6%B1%82_%E7%8A%B6%E6%80%81%E7%AE%A1%E7%90%86/",
  "image": "https://yuezi2048.github.io/img/touxiang.jpg",
  "datePublished": "2024-10-03T13:51:57.000Z",
  "dateModified": "2024-10-03T13:51:57.000Z",
  "author": [
    {
      "@type": "Person",
      "name": "yuezi",
      "url": "https://yuezi2048.github.io/"
    }
  ]
}</script><link rel="shortcut icon" href="/img/favicon.png"><link rel="canonical" href="https://yuezi2048.github.io/2024/10/03/2.Areas%F0%9F%8C%90/back-end-java/4.JavaWeb/9.%E5%89%8D%E7%AB%AF%E5%B7%A5%E7%A8%8B%E5%8C%96%E4%B8%8B%E7%AF%87_%E6%95%B0%E6%8D%AE%E8%AF%B7%E6%B1%82_%E7%8A%B6%E6%80%81%E7%AE%A1%E7%90%86/index.html"><link rel="preconnect" href="//cdn.jsdelivr.net"/><link rel="preconnect" href="//hm.baidu.com"/><link rel="preconnect" href="//busuanzi.ibruce.info"/><link rel="stylesheet" href="/css/index.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fortawesome/fontawesome-free/css/all.min.css"><script>
    (() => {
      
    const saveToLocal = {
      set: (key, value, ttl) => {
        if (!ttl) return
        const expiry = Date.now() + ttl * 86400000
        localStorage.setItem(key, JSON.stringify({ value, expiry }))
      },
      get: key => {
        const itemStr = localStorage.getItem(key)
        if (!itemStr) return undefined
        const { value, expiry } = JSON.parse(itemStr)
        if (Date.now() > expiry) {
          localStorage.removeItem(key)
          return undefined
        }
        return value
      }
    }

    window.btf = {
      saveToLocal,
      getScript: (url, attr = {}) => new Promise((resolve, reject) => {
        const script = document.createElement('script')
        script.src = url
        script.async = true
        Object.entries(attr).forEach(([key, val]) => script.setAttribute(key, val))
        script.onload = script.onreadystatechange = () => {
          if (!script.readyState || /loaded|complete/.test(script.readyState)) resolve()
        }
        script.onerror = reject
        document.head.appendChild(script)
      }),
      getCSS: (url, id) => new Promise((resolve, reject) => {
        const link = document.createElement('link')
        link.rel = 'stylesheet'
        link.href = url
        if (id) link.id = id
        link.onload = link.onreadystatechange = () => {
          if (!link.readyState || /loaded|complete/.test(link.readyState)) resolve()
        }
        link.onerror = reject
        document.head.appendChild(link)
      }),
      addGlobalFn: (key, fn, name = false, parent = window) => {
        if (!false && key.startsWith('pjax')) return
        const globalFn = parent.globalFn || {}
        globalFn[key] = globalFn[key] || {}
        globalFn[key][name || Object.keys(globalFn[key]).length] = fn
        parent.globalFn = globalFn
      }
    }
  
      
      const activateDarkMode = () => {
        document.documentElement.setAttribute('data-theme', 'dark')
        if (document.querySelector('meta[name="theme-color"]') !== null) {
          document.querySelector('meta[name="theme-color"]').setAttribute('content', '#0d0d0d')
        }
      }
      const activateLightMode = () => {
        document.documentElement.setAttribute('data-theme', 'light')
        if (document.querySelector('meta[name="theme-color"]') !== null) {
          document.querySelector('meta[name="theme-color"]').setAttribute('content', '#ffffff')
        }
      }

      btf.activateDarkMode = activateDarkMode
      btf.activateLightMode = activateLightMode

      const theme = saveToLocal.get('theme')
    
          theme === 'dark' ? activateDarkMode() : theme === 'light' ? activateLightMode() : null
        
      
      const asideStatus = saveToLocal.get('aside-status')
      if (asideStatus !== undefined) {
        document.documentElement.classList.toggle('hide-aside', asideStatus === 'hide')
      }
    
      
    const detectApple = () => {
      if (/iPad|iPhone|iPod|Macintosh/.test(navigator.userAgent)) {
        document.documentElement.classList.add('apple')
      }
    }
    detectApple()
  
    })()
  </script><script>var _hmt = _hmt || [];
(function() {
  var hm = document.createElement("script");
  hm.src = "https://hm.baidu.com/hm.js?bfb48b678d82bea9f9cc9d59227767e4";
  var s = document.getElementsByTagName("script")[0];
  s.parentNode.insertBefore(hm, s);
})();
btf.addGlobalFn('pjaxComplete', () => {
  _hmt.push(['_trackPageview',window.location.pathname])
}, 'baidu_analytics')
</script><script>const GLOBAL_CONFIG = {
  root: '/',
  algolia: {"appId":"FPH6F2TOJL","apiKey":"06d9ea26c803ba912b4d8e13404ed34d","indexName":"blog","hitsPerPage":6,"languages":{"input_placeholder":"搜索","hits_empty":"未找到符合您查询的内容：${query}","hits_stats":"找到 ${hits} 条结果，耗时 ${time} 毫秒"}},
  localSearch: undefined,
  translate: undefined,
  highlight: {"plugin":"highlight.js","highlightCopy":true,"highlightLang":true,"highlightHeightLimit":350,"highlightFullpage":false,"highlightMacStyle":false},
  copy: {
    success: '复制成功',
    error: '复制失败',
    noSupport: '浏览器不支持'
  },
  relativeDate: {
    homepage: false,
    post: false
  },
  runtime: '天',
  dateSuffix: {
    just: '刚刚',
    min: '分钟前',
    hour: '小时前',
    day: '天前',
    month: '个月前'
  },
  copyright: undefined,
  lightbox: 'null',
  Snackbar: undefined,
  infinitegrid: {
    js: 'https://cdn.jsdelivr.net/npm/@egjs/infinitegrid/dist/infinitegrid.min.js',
    buttonText: '加载更多'
  },
  isPhotoFigcaption: false,
  islazyloadPlugin: false,
  isAnchor: false,
  percent: {
    toc: true,
    rightside: false,
  },
  autoDarkmode: false
}</script><script id="config-diff">var GLOBAL_CONFIG_SITE = {
  title: '9.前端工程化下篇_数据请求_状态管理',
  isHighlightShrink: false,
  isToc: true,
  pageType: 'post'
}</script><link rel="stylesheet" href="/css/backgound.css"><meta name="generator" content="Hexo 8.0.0"></head><body><div id="sidebar"><div id="menu-mask"></div><div id="sidebar-menus"><div class="avatar-img text-center"><img src="/img/loading.gif" data-original="/img/touxiang.jpg" onerror="this.onerror=null;this.src='/img/friend_404.gif'" alt="avatar"/></div><div class="site-data text-center"><a href="/archives/"><div class="headline">文章</div><div class="length-num">603</div></a><a href="/tags/"><div class="headline">标签</div><div class="length-num">61</div></a><a href="/categories/"><div class="headline">分类</div><div class="length-num">85</div></a></div><div class="menus_items"><div class="menus_item"><a class="site-page" href="/"><i class="fa-fw fas fa-home"></i><span> 主页</span></a></div><div class="menus_item"><span class="site-page group"><i class="fa-fw fa fa-graduation-cap"></i><span> 博文</span><i class="fas fa-chevron-down"></i></span><ul class="menus_item_child"><li><a class="site-page child" href="/categories/"><i class="fa-fw fa fa-archive"></i><span> 分类</span></a></li><li><a class="site-page child" href="/tags/"><i class="fa-fw fa fa-tags"></i><span> 标签</span></a></li><li><a class="site-page child" href="/archives/"><i class="fa-fw fa fa-folder-open"></i><span> 归档</span></a></li></ul></div><div class="menus_item"><a class="site-page" href="/about/"><i class="fa-fw fas fa-heart"></i><span> 关于笔者</span></a></div></div></div></div><div class="post" id="body-wrap"><header class="post-bg" id="page-header" style="background-image: url(/img/default.png);"><nav id="nav"><span id="blog-info"><a class="nav-site-title" href="/"><span class="site-name">yuezi</span></a><a class="nav-page-title" href="/"><span class="site-name">9.前端工程化下篇_数据请求_状态管理</span></a></span><div id="menus"><div id="search-button"><span class="site-page social-icon search"><i class="fas fa-search fa-fw"></i><span> 搜索</span></span></div><div class="menus_items"><div class="menus_item"><a class="site-page" href="/"><i class="fa-fw fas fa-home"></i><span> 主页</span></a></div><div class="menus_item"><span class="site-page group"><i class="fa-fw fa fa-graduation-cap"></i><span> 博文</span><i class="fas fa-chevron-down"></i></span><ul class="menus_item_child"><li><a class="site-page child" href="/categories/"><i class="fa-fw fa fa-archive"></i><span> 分类</span></a></li><li><a class="site-page child" href="/tags/"><i class="fa-fw fa fa-tags"></i><span> 标签</span></a></li><li><a class="site-page child" href="/archives/"><i class="fa-fw fa fa-folder-open"></i><span> 归档</span></a></li></ul></div><div class="menus_item"><a class="site-page" href="/about/"><i class="fa-fw fas fa-heart"></i><span> 关于笔者</span></a></div></div><div id="toggle-menu"><span class="site-page"><i class="fas fa-bars fa-fw"></i></span></div></div></nav><div id="post-info"><h1 class="post-title">9.前端工程化下篇_数据请求_状态管理</h1><div id="post-meta"><div class="meta-firstline"><span class="post-meta-date"><i class="far fa-calendar-alt fa-fw post-meta-icon"></i><span class="post-meta-label">发表于</span><time class="post-meta-date-created" datetime="2024-10-03T13:51:57.000Z" title="发表于 2024-10-03 21:51:57">2024-10-03</time><span class="post-meta-separator">|</span><i class="fas fa-history fa-fw post-meta-icon"></i><span class="post-meta-label">更新于</span><time class="post-meta-date-updated" datetime="2024-10-03T13:51:57.000Z" title="更新于 2024-10-03 21:51:57">2024-10-03</time></span><span class="post-meta-categories"><span class="post-meta-separator">|</span><i class="fas fa-inbox fa-fw post-meta-icon"></i><a class="post-meta-categories" href="/categories/2-Areas%F0%9F%8C%90/">2.Areas🌐</a><i class="fas fa-angle-right post-meta-separator"></i><i class="fas fa-inbox fa-fw post-meta-icon"></i><a class="post-meta-categories" href="/categories/2-Areas%F0%9F%8C%90/back-end-java/">back-end-java</a><i class="fas fa-angle-right post-meta-separator"></i><i class="fas fa-inbox fa-fw post-meta-icon"></i><a class="post-meta-categories" href="/categories/2-Areas%F0%9F%8C%90/back-end-java/4-JavaWeb/">4.JavaWeb</a></span></div><div class="meta-secondline"><span class="post-meta-separator">|</span><span class="post-meta-wordcount"><i class="far fa-file-word fa-fw post-meta-icon"></i><span class="post-meta-label">总字数:</span><span class="word-count">11.1k</span><span class="post-meta-separator">|</span><i class="far fa-clock fa-fw post-meta-icon"></i><span class="post-meta-label">阅读时长:</span><span>50分钟</span></span><span class="post-meta-separator">|</span><span class="post-meta-pv-cv" id="" data-flag-title=""><i class="far fa-eye fa-fw post-meta-icon"></i><span class="post-meta-label">浏览量:</span><span id="busuanzi_value_page_pv"><i class="fa-solid fa-spinner fa-spin"></i></span></span></div></div></div></header><main class="layout" id="content-inner"><div id="post"><article class="container post-content" id="article-container"><h2 id="9-Vue3数据交互axios"><a href="#9-Vue3数据交互axios" class="headerlink" title="9. Vue3数据交互axios"></a>9. Vue3数据交互axios</h2><h3 id="9-0-前置知识——promise"><a href="#9-0-前置知识——promise" class="headerlink" title="9.0 前置知识——promise"></a>9.0 前置知识——promise</h3><h4 id="9-0-1-回调函数"><a href="#9-0-1-回调函数" class="headerlink" title="9.0.1 回调函数"></a>9.0.1 回调函数</h4><ul>
<li><code>普通函数</code>: 正常调用的函数,一般函数执行完毕后才会继续执行下一行代码</li>
<li><code>回调函数</code>: 一些特殊的函数,表示未来才会执行的一些功能,后续代码不会等待该函数执行完毕就开始执行了</li>
</ul>
<figure class="highlight js"><table><tr><td class="code"><pre><span class="line"><span class="keyword">function</span> <span class="title function_">fun1</span>(<span class="params"></span>) &#123;</span><br><span class="line">    <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">&quot;fun1 invoked&quot;</span>);</span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">// 测试普通函数调用;</span></span><br><span class="line"><span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">&quot;code1 invoked&quot;</span>);</span><br><span class="line"><span class="title function_">fun1</span>();</span><br><span class="line"><span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">&quot;code2 invoked&quot;</span>);</span><br><span class="line"></span><br><span class="line"><span class="comment">/*</span></span><br><span class="line"><span class="comment">	测试回调函数，以setTimeout为例</span></span><br><span class="line"><span class="comment">	回调函数是一种基于事件的，自动调用函数</span></span><br><span class="line"><span class="comment">	回调函数的其他代码不会等待回调函数执行完毕</span></span><br><span class="line"><span class="comment"></span></span><br><span class="line"><span class="comment">	回调函数是一种未来会执行的函数，回调函数以外的其他代码</span></span><br><span class="line"><span class="comment">	生活案例：</span></span><br><span class="line"><span class="comment">		邻家小美，那年18岁</span></span><br><span class="line"><span class="comment">		承诺：10年之后，他未娶，你未嫁，匿名就结婚 &gt;&gt;&gt; function() &#123;&#125;</span></span><br><span class="line"><span class="comment">			1. 进行中   其他代码继续执行</span></span><br><span class="line"><span class="comment">			2. 成功     准备好成功时处理的预案</span></span><br><span class="line"><span class="comment">			3. 失败     准备好失败时处理的预案</span></span><br><span class="line"><span class="comment">*/</span></span><br><span class="line"></span><br><span class="line"><span class="built_in">setTimeout</span>(<span class="function">() =&gt;</span> &#123;</span><br><span class="line">    <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">&quot;fun1 invoked&quot;</span>);</span><br><span class="line">&#125;, <span class="number">2000</span>);</span><br><span class="line"><span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">&quot;code1 invoked&quot;</span>);</span><br><span class="line"><span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">&quot;code2 invoked&quot;</span>);</span><br></pre></td></tr></table></figure>

<p>运行结果</p>
<img src="/img/loading.gif" data-original="https://yuezi-1308313119.cos.ap-guangzhou.myqcloud.com/typora-user-images%2Fimage-20241003185251357.png" alt="image-20241003185251357" style="zoom:80%;" />	

<h4 id="9-0-2-Promise简介"><a href="#9-0-2-Promise简介" class="headerlink" title="9.0.2 Promise简介"></a>9.0.2 Promise简介</h4><ul>
<li><code>Promise</code>是前端中异步请求的技术，可类比Java中的多线程 + 多线程结果回调<ul>
<li>Promise是异步编程的一种解决方案，相比于传统方法（通过回调函数和事件）更加合理，称为ES6的语言标准，统一提供原生的<code>Promise</code>对象</li>
<li>Promise实际上是一个容器，里面保存着待完成事件（通常是异步操作）的结果</li>
<li>语法上，Promise是一个对象，提供了统一API，可以进一步获取信息和处理</li>
</ul>
</li>
<li><code>Promise</code>具有如下两个特点<ul>
<li>一个Promise对象代表一个异步操作，仅包含三种状态：<code>Pending</code>（进行中）、<code>Resolved</code>（已完成，又称 Fulfilled）和<code>Rejected</code>（已失败），只能通过异步操作的结果来决定是哪种状态，其他操作无法改变，这就是名称Promise（承诺）的由来</li>
<li>Promise对象一旦状态改变，就不能再变，并且任何时候都可获取到结果。状态改变只有两种可能：从<code>Pending</code>变为<code>Resolved</code>和从<code>Pending</code>变为<code>Rejected</code></li>
</ul>
</li>
</ul>
<h4 id="9-0-3-Promise用法"><a href="#9-0-3-Promise用法" class="headerlink" title="9.0.3 Promise用法"></a>9.0.3 Promise用法</h4><ul>
<li>ES6规定，Promise对象是一个构造函数，用来生成Promise实例</li>
<li>reject写法有两种，一种将函数写在then第二个参数，另一种是写到catch后面（调用同一个对象的API可以简化成这样的写法）<ul>
<li><code>Promise.prototype.catch</code>方法是<code>.then(null, rejection)</code>的别名，用于指定发生错误时的回调函数。</li>
</ul>
</li>
</ul>
<figure class="highlight js"><table><tr><td class="code"><pre><span class="line"><span class="comment">/*</span></span><br><span class="line"><span class="comment">      resolove: 回调函数如果调用resolve方法，promise的状态：pending -&gt; resolved(fullfilled)</span></span><br><span class="line"><span class="comment">      reject: 回调函数如果调用reject方法/error，promise的状态：pending -&gt; rejected</span></span><br><span class="line"><span class="comment">*/</span></span><br><span class="line"><span class="keyword">let</span> promise = <span class="keyword">new</span> <span class="title class_">Promise</span>(<span class="function">(<span class="params">resolve, reject</span>) =&gt;</span> &#123;</span><br><span class="line">    <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">&quot;function invoked&quot;</span>);</span><br><span class="line">    <span class="comment">// resolve(&quot;hhh&quot;);</span></span><br><span class="line">    <span class="comment">// reject(&quot;nonono&quot;);</span></span><br><span class="line">    <span class="keyword">throw</span> <span class="keyword">new</span> <span class="title class_">Error</span>(<span class="string">&quot;error message&quot;</span>);</span><br><span class="line">&#125;);</span><br><span class="line"></span><br><span class="line"><span class="comment">// promise执行的预案，其他代码不等待promise,继续执行</span></span><br><span class="line"><span class="comment">// promise.then(等待promise状态改变后，执行的代码);</span></span><br><span class="line"><span class="comment">// 可以简写为.then.catch，catch就可以接收失败或者异常的代码了</span></span><br><span class="line">promise.<span class="title function_">then</span>(</span><br><span class="line">    <span class="function">(<span class="params">value</span>) =&gt;</span> &#123;</span><br><span class="line">        <span class="comment">// promise -&gt; resolved 后执行的函数</span></span><br><span class="line">        <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">&quot;promise success: &quot;</span> + value);</span><br><span class="line">    &#125;,</span><br><span class="line">    <span class="comment">// (value) =&gt; &#123;</span></span><br><span class="line">    <span class="comment">//     // promise -&gt; rejected 后执行的函数</span></span><br><span class="line">    <span class="comment">//     console.log(&quot;promise failed: &quot; + value);</span></span><br><span class="line">    <span class="comment">// &#125;</span></span><br><span class="line">).<span class="title function_">catch</span>(</span><br><span class="line">    <span class="function">(<span class="params">value</span>) =&gt;</span> &#123;</span><br><span class="line">        <span class="comment">// 当promise状态是rejected 或者 promise 出现异常时 执行的函数，可替换上面第二个参数</span></span><br><span class="line">        <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">&quot;promise failed: &quot;</span> + value);</span><br><span class="line">    &#125;</span><br><span class="line">);</span><br><span class="line"></span><br><span class="line"><span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">&quot;other code1&quot;</span>);</span><br><span class="line"><span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">&quot;other code2&quot;</span>);</span><br></pre></td></tr></table></figure>

<p>运行结果</p>
<img src="/img/loading.gif" data-original="https://yuezi-1308313119.cos.ap-guangzhou.myqcloud.com/typora-user-images%2Fimage-20241003185539924.png" alt="image-20241003185539924" style="zoom: 80%;" />	

<h4 id="9-0-4-优化——async和await使用"><a href="#9-0-4-优化——async和await使用" class="headerlink" title="9.0.4 优化——async和await使用"></a>9.0.4 优化——async和await使用</h4><p>ES6 在异步操作上提供了async和await关键字。异步操作通常涉及到Promise，而该处关键字则是提供更直观和简单使用的语法</p>
<p><code>async</code></p>
<ul>
<li>被async标识的函数，返回值是作为一个Promise对象<ul>
<li>如果返回的是非Promise普通对象，则默认是一个成功状态的Promise对象</li>
<li>如果返回的是异常，则默认返回一个失败的Promise对象</li>
<li>如果返回的是一个Promise对象，则async函数返回的状态由该Promise对象的状态决定</li>
</ul>
</li>
</ul>
<p><code>await</code></p>
<ul>
<li>await右侧一般是一个Promise对象，但也可以是普通的值<ul>
<li>如果是Promise对象，则返回Promise成功的值</li>
<li>如果是其他值，则直接返回该值</li>
</ul>
</li>
<li>await会等右边promise对象执行结束再获取结果，async后续的代码会等待await的进行</li>
<li>await必须在async函数中，但async函数可以没有await</li>
<li>如果await右边的promise失效了，会抛出异常，需要用try..catch捕获处理</li>
</ul>
<figure class="highlight html"><table><tr><td class="code"><pre><span class="line"><span class="comment">&lt;!-- 取</span></span><br><span class="line"><span class="comment">    async：帮助我们用简洁的语法获得一个promise对象</span></span><br><span class="line"><span class="comment">    let promise = new Promise(function() &#123;&#125;) ==&gt; async function aaa() &#123;&#125; / let aaa = async () =&gt; &#123;&#125;</span></span><br><span class="line"><span class="comment">    1. async用于标识函数，async函数返回的结果就是一个promise对象</span></span><br><span class="line"><span class="comment">    2. 方法如果return 结果，promise的状态结果就是resolved，return的结果就是成功状态的返回值</span></span><br><span class="line"><span class="comment">    3. 方法中出现了异常，则返回的promise就是失败状态的promise</span></span><br><span class="line"><span class="comment">    4. async返回的结果如果是promise对象，则状态由内部的promise决定</span></span><br><span class="line"><span class="comment"></span></span><br><span class="line"><span class="comment">    await：帮助我们获promise成功状态的返回值的关键字</span></span><br><span class="line"><span class="comment">    1. await右边如果是一个普通值，则直接返回该值 let res = await &quot;zhangsan&quot;; // res = &quot;zhangsan&quot;</span></span><br><span class="line"><span class="comment">    而如果右边是一个promise对象，则返回promise成功状态的结果 let res = await Promise.resolve(&quot;zhangsan&quot;); // res = &quot;zhangsan&quot;</span></span><br><span class="line"><span class="comment">    2. await右边如果是一个失败状态的promise，那么await直接抛异常 let res = await Promise.reject(&quot;error&quot;); // 抛出异常 error</span></span><br><span class="line"><span class="comment">    3. await关键字必须在async修饰的函数中使用，async函数中可以没有await</span></span><br><span class="line"><span class="comment">    4. await后面的代码会等待await执行完毕继续执行</span></span><br><span class="line"><span class="comment"></span></span><br><span class="line"><span class="comment">--&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">script</span>&gt;</span><span class="language-javascript"></span></span><br><span class="line"><span class="language-javascript"><span class="keyword">async</span> <span class="keyword">function</span> <span class="title function_">fun1</span>(<span class="params"></span>) &#123;</span></span><br><span class="line"><span class="language-javascript">    <span class="keyword">return</span> <span class="number">10</span>;</span></span><br><span class="line"><span class="language-javascript">&#125;</span></span><br><span class="line"><span class="language-javascript"></span></span><br><span class="line"><span class="language-javascript"><span class="keyword">async</span> <span class="keyword">function</span> <span class="title function_">fun2</span>(<span class="params"></span>) &#123;</span></span><br><span class="line"><span class="language-javascript">    <span class="keyword">try</span> &#123;</span></span><br><span class="line"><span class="language-javascript">        <span class="keyword">let</span> res = <span class="keyword">await</span> <span class="title function_">fun1</span>(); <span class="comment">// 后面的代码会等待awiat执行完毕，但是外面调用层面 后面的代码是不会等待的</span></span></span><br><span class="line"><span class="language-javascript">        <span class="comment">// let res = await Promise.reject(&quot;Promise Error&quot;);</span></span></span><br><span class="line"><span class="language-javascript">        <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">&quot;await got: &quot;</span> + res);</span></span><br><span class="line"><span class="language-javascript">    &#125; <span class="keyword">catch</span> (e) &#123;</span></span><br><span class="line"><span class="language-javascript">        <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">&quot;catch error: &quot;</span> + e);</span></span><br><span class="line"><span class="language-javascript">    &#125;</span></span><br><span class="line"><span class="language-javascript">&#125;</span></span><br><span class="line"><span class="language-javascript"></span></span><br><span class="line"><span class="language-javascript"><span class="title function_">fun2</span>();</span></span><br><span class="line"><span class="language-javascript"></span></span><br><span class="line"><span class="language-javascript"><span class="comment">// async function fun1() &#123;</span></span></span><br><span class="line"><span class="language-javascript"><span class="comment">//     // return 10;</span></span></span><br><span class="line"><span class="language-javascript"><span class="comment">//     // throw new Error(&quot;errorMsg&quot;);</span></span></span><br><span class="line"><span class="language-javascript"><span class="comment">//     let promise = Promise.resolve(&quot;heihei&quot;); // 状态和fun1()一样</span></span></span><br><span class="line"><span class="language-javascript"><span class="comment">//     return promise;</span></span></span><br><span class="line"><span class="language-javascript"><span class="comment">// &#125;</span></span></span><br><span class="line"><span class="language-javascript"></span></span><br><span class="line"><span class="language-javascript"><span class="comment">// let promise = fun1();</span></span></span><br><span class="line"><span class="language-javascript"></span></span><br><span class="line"><span class="language-javascript"><span class="comment">// promise.then((value) =&gt; &#123;</span></span></span><br><span class="line"><span class="language-javascript"><span class="comment">//     console.log(&quot;success: &quot; + value);</span></span></span><br><span class="line"><span class="language-javascript"><span class="comment">// &#125;).catch((value) =&gt; &#123;</span></span></span><br><span class="line"><span class="language-javascript"><span class="comment">//     console.log(&quot;failed: &quot; + value);</span></span></span><br><span class="line"><span class="language-javascript"><span class="comment">// &#125;);</span></span></span><br><span class="line"><span class="language-javascript"></span><span class="tag">&lt;/<span class="name">script</span>&gt;</span></span><br></pre></td></tr></table></figure>

<p>测试结果</p>
<p><img src="/img/loading.gif" data-original="https://yuezi-1308313119.cos.ap-guangzhou.myqcloud.com/typora-user-images%2Fimage-20241003192059225.png" alt="image-20241003192059225">	</p>
<h3 id="9-1-Axios简介"><a href="#9-1-Axios简介" class="headerlink" title="9.1 Axios简介"></a>9.1 Axios简介</h3><p>回顾ajax</p>
<ul>
<li>AJAX &#x3D; Asynchronous JavaScript and XML（异步的 JavaScript 和 XML）。</li>
<li>AJAX 不是新的编程语言，而是一种使用现有标准的新方法。</li>
<li>AJAX 最大的优点是在不重新加载整个页面的情况下，可以与服务器交换数据并更新部分网页内容。</li>
<li>AJAX 不需要任何浏览器插件，但需要用户允许 JavaScript 在浏览器上执行。</li>
<li>XMLHttpRequest 只是实现 Ajax 的一种方式。</li>
</ul>
<p><img src="/img/loading.gif" data-original="https://yuezi-1308313119.cos.ap-guangzhou.myqcloud.com/typora-user-images%2Fimage-20241003192953917.png" alt="image-20241003192953917">	</p>
<p>JS原生实现Ajax写法</p>
<figure class="highlight js"><table><tr><td class="code"><pre><span class="line"></span><br><span class="line"><span class="keyword">function</span> <span class="title function_">loadXMLDoc</span>(<span class="params"></span>)&#123;</span><br><span class="line">  <span class="keyword">var</span> xmlhttp;</span><br><span class="line">  <span class="keyword">if</span> (<span class="variable language_">window</span>.<span class="property">XMLHttpRequest</span>)&#123;</span><br><span class="line">    <span class="comment">//  IE7+, Firefox, Chrome, Opera, Safari 浏览器执行代码</span></span><br><span class="line">    xmlhttp=<span class="keyword">new</span> <span class="title class_">XMLHttpRequest</span>();</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="keyword">else</span>&#123;</span><br><span class="line">    <span class="comment">// IE6, IE5 浏览器执行代码</span></span><br><span class="line">    xmlhttp=<span class="keyword">new</span> <span class="title class_">ActiveXObject</span>(<span class="string">&quot;Microsoft.XMLHTTP&quot;</span>);</span><br><span class="line">  &#125;</span><br><span class="line">    <span class="comment">// 设置回调函数处理响应结果</span></span><br><span class="line">  xmlhttp.<span class="property">onreadystatechange</span>=<span class="keyword">function</span>(<span class="params"></span>)&#123;</span><br><span class="line">    <span class="keyword">if</span> (xmlhttp.<span class="property">readyState</span>==<span class="number">4</span> &amp;&amp; xmlhttp.<span class="property">status</span>==<span class="number">200</span>)</span><br><span class="line">    &#123;</span><br><span class="line">      <span class="variable language_">document</span>.<span class="title function_">getElementById</span>(<span class="string">&quot;myDiv&quot;</span>).<span class="property">innerHTML</span>=xmlhttp.<span class="property">responseText</span>;</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line">    <span class="comment">// 设置请求方式和请求的资源路径</span></span><br><span class="line">  xmlhttp.<span class="title function_">open</span>(<span class="string">&quot;GET&quot;</span>,<span class="string">&quot;/try/ajax/ajax_info.txt&quot;</span>,<span class="literal">true</span>);</span><br><span class="line">    <span class="comment">// 发送请求</span></span><br><span class="line">  xmlhttp.<span class="title function_">send</span>();</span><br><span class="line">&#125;</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<blockquote>
<p> 什么是axios  官网介绍:<a target="_blank" rel="noopener" href="https://axios-http.com/zh/docs/intro">https://axios-http.com/zh/docs/intro</a></p>
</blockquote>
<ul>
<li>Axios 是一个基于 <a target="_blank" rel="noopener" href="https://javascript.info/promise-basics" title="promise"><em>promise</em></a> 网络请求库，作用于<a target="_blank" rel="noopener" href="https://nodejs.org/" title="node.js">node.js</a> 和浏览器中。 它是 <a target="_blank" rel="noopener" href="https://www.lullabot.com/articles/what-is-an-isomorphic-application" title="isomorphic"><em>isomorphic</em></a> 的(即同一套代码可以运行在浏览器和node.js中)。在服务端它使用原生 node.js <code>http</code> 模块, 而在客户端 (浏览端) 则使用 XMLHttpRequests。它有如下特性<ul>
<li>从浏览器创建 <a target="_blank" rel="noopener" href="https://developer.mozilla.org/en-US/docs/Web/API/XMLHttpRequest" title="XMLHttpRequests">XMLHttpRequests</a></li>
<li>从 node.js 创建 <a target="_blank" rel="noopener" href="http://nodejs.org/api/http.html" title="http">http</a> 请求</li>
<li>支持 <a target="_blank" rel="noopener" href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Promise" title="Promise">Promise</a> API</li>
<li>拦截请求和响应</li>
<li>转换请求和响应数据</li>
<li>取消请求</li>
<li>自动转换JSON数据</li>
<li>客户端支持防御[XSRF](</li>
</ul>
</li>
</ul>
<h3 id="9-2-Axios案例"><a href="#9-2-Axios案例" class="headerlink" title="9.2 Axios案例"></a>9.2 Axios案例</h3><blockquote>
<p>1 案例需求:请求后台获取随机土味情话</p>
</blockquote>
<ul>
<li>请求的url</li>
</ul>
<figure class="highlight http"><table><tr><td class="code"><pre><span class="line">https://api.uomg.com/api/rand.qinghua?format=json    或者使用  http://forum.atguigu.cn/api/rand.qinghua?format=json</span><br></pre></td></tr></table></figure>

<ul>
<li>请求的方式</li>
</ul>
<figure class="highlight http"><table><tr><td class="code"><pre><span class="line">GET/POST</span><br></pre></td></tr></table></figure>

<ul>
<li>数据返回的格式</li>
</ul>
<p><img src="/img/loading.gif" data-original="https://yuezi-1308313119.cos.ap-guangzhou.myqcloud.com/typora-user-images%2Fimage-20241003194225655.png" alt="image-20241003194225655">	</p>
<h4 id="9-2-1-Axios发送get-post请求"><a href="#9-2-1-Axios发送get-post请求" class="headerlink" title="9.2.1 Axios发送get post请求"></a>9.2.1 Axios发送get post请求</h4><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">&lt;script setup&gt;</span><br><span class="line">import axios from &quot;axios&quot;;</span><br><span class="line">import &#123; ref, reactive &#125; from &quot;vue&quot;;</span><br><span class="line"></span><br><span class="line">let message = reactive(&#123;</span><br><span class="line">  code: &quot;&quot;,</span><br><span class="line">  content: &quot;&quot;,</span><br><span class="line">&#125;);</span><br><span class="line"></span><br><span class="line">// 使用axios发送请求获取土味情话</span><br><span class="line">// axios(&#123;请求的参数&#125;)  请求三要素: 1.url 2.method 3.请求参数 k-v json...</span><br><span class="line">function getLoveWords() &#123;</span><br><span class="line">  // return axios(&#123;</span><br><span class="line">  //   method: &quot;post&quot;,</span><br><span class="line">  //   url: &quot;https://api.uomg.com/api/rand.qinghua&quot;,</span><br><span class="line">  //   params: &#123;</span><br><span class="line">  //     // 如果请求方式是get，则params中的数据会以键值对形式放在url后(params的参数都是放到url后 get post都支持)</span><br><span class="line">  //     // 如果请求方式是post，则data中的数据会以json形式放到请求体中(仅post支持)</span><br><span class="line">  //     format: &quot;json&quot;,</span><br><span class="line">  //   &#125;,</span><br><span class="line">  //   data: &#123;</span><br><span class="line">  //     username: &quot;zhangsan&quot;,</span><br><span class="line">  //   &#125;,</span><br><span class="line">  // &#125;);</span><br><span class="line">  </span><br><span class="line">  // 发送get请求的方法，无需指定</span><br><span class="line">  // axios.get(url, &#123;请求的其他信息(可选)&#125;)</span><br><span class="line">  // axios.get(url, &#123;params: &#123;键值对&#125;, headers: &#123;请求头&#125;&#125;)</span><br><span class="line">  // 返回promise对象</span><br><span class="line">  // return axios.get(&quot;https://api.uomg.com/api/rand.qinghua&quot;, </span><br><span class="line">  //   &#123;</span><br><span class="line">  //     params: &#123;</span><br><span class="line">  //       format: &quot;json&quot;,</span><br><span class="line">  //       username: &quot;zhangsan&quot;,</span><br><span class="line">  //       userpwd: &quot;123456&quot;,</span><br><span class="line">  //     &#125;,</span><br><span class="line">  //     headers: &#123;</span><br><span class="line">  //       &quot;Accept&quot;: &quot;application/json, text/plain, text/html, */*&quot;,</span><br><span class="line">  //     &#125;,</span><br><span class="line">  //   &#125;</span><br><span class="line">  // );</span><br><span class="line"></span><br><span class="line">  // axios.post(url, &#123;要放入请求体中的json串&#125; , &#123;请求的其他信息(可选)&#125;)</span><br><span class="line">  // return axios.post(&quot;https://api.uomg.com/api/rand.qinghua&quot;, </span><br><span class="line">  //   &#123;</span><br><span class="line">  //       username: &quot;zhangsan&quot;,</span><br><span class="line">  //       userpwd: &quot;123456&quot;,</span><br><span class="line">  //   &#125;,</span><br><span class="line">  //   &#123;</span><br><span class="line">  //     params: &#123;</span><br><span class="line">  //       format: &quot;json&quot;,</span><br><span class="line">  //     &#125;,</span><br><span class="line">  //     headers: &#123;</span><br><span class="line">  //       &quot;Accept&quot;: &quot;application/json, text/plain, text/html, */*&quot;,</span><br><span class="line">  //     &#125;,</span><br><span class="line">  //   &#125;</span><br><span class="line">  // );</span><br><span class="line"></span><br><span class="line">  return axios.post(&quot;https://api.uomg.com/api/rand.qinghua?format=json&quot;);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">async function getLoveMsg() &#123;</span><br><span class="line">  /* resp响应结果对象</span><br><span class="line">          data 服务端响应回来的数据(json字符串自动解析，无需手动parse)</span><br><span class="line">          status 响应状态码 200</span><br><span class="line">          statusTest 响应状态描述文字 OK</span><br><span class="line">          headers 本次响应的所有响应头</span><br><span class="line">          config 本次请求的配置信息</span><br><span class="line">          request 本次请求发送时使用的XMLHttpRequest对象</span><br><span class="line">      </span><br><span class="line">  */</span><br><span class="line">  let response = await getLoveWords();</span><br><span class="line">  console.log(response);</span><br><span class="line"></span><br><span class="line">  // Object.assign(对象1, 对象2): 将对象2的属性值赋值给对象1的同名属性</span><br><span class="line">  Object.assign(message, response.data);</span><br><span class="line"></span><br><span class="line">&#125;</span><br><span class="line">&lt;/script&gt;</span><br><span class="line"></span><br><span class="line">&lt;template&gt;</span><br><span class="line">  &lt;div&gt;</span><br><span class="line">    &lt;h1 v-text=&quot;message.content&quot;&gt;&lt;/h1&gt;</span><br><span class="line">    &lt;button @click=&quot;getLoveMsg()&quot;&gt;change&lt;/button&gt;</span><br><span class="line">  &lt;/div&gt;</span><br><span class="line">&lt;/template&gt;</span><br><span class="line"></span><br><span class="line">&lt;style scoped&gt;</span><br><span class="line">&lt;/style&gt;</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<p>实现效果</p>
<p>前三种方式对应的请求头和请求体</p>
<p><img src="/img/loading.gif" data-original="https://yuezi-1308313119.cos.ap-guangzhou.myqcloud.com/typora-user-images%2Fimage-20241003194850146.png" alt="image-20241003194850146">	</p>
<p>网页的显示和输出内容</p>
<img src="/img/loading.gif" data-original="https://yuezi-1308313119.cos.ap-guangzhou.myqcloud.com/typora-user-images%2Fimage-20241003194314902.png" alt="image-20241003194314902" style="zoom:80%;" />	

<p><img src="/img/loading.gif" data-original="https://yuezi-1308313119.cos.ap-guangzhou.myqcloud.com/typora-user-images%2Fimage-20241003194331176.png" alt="image-20241003194331176"></p>
<h4 id="9-2-2-Axios拦截器"><a href="#9-2-2-Axios拦截器" class="headerlink" title="9.2.2 Axios拦截器"></a>9.2.2 Axios拦截器</h4><ul>
<li>如果想在axios发送请求之前,或者是数据响应回来在执行then方法之前做一些额外的工作,可以通过拦截器完成（先有这个概念，后面项目会用到）</li>
</ul>
<p>axios.js</p>
<figure class="highlight js"><table><tr><td class="code"><pre><span class="line"><span class="keyword">import</span> axios <span class="keyword">from</span> <span class="string">&#x27;axios&#x27;</span>;</span><br><span class="line"></span><br><span class="line"><span class="comment">// 使用axios函数创建一个可以发送请求的实例对象</span></span><br><span class="line"><span class="keyword">const</span> instance = axios.<span class="title function_">create</span>(&#123;</span><br><span class="line">    <span class="comment">// 设置请求的基础URL，后续请求的URL更改只需修改该参数即可</span></span><br><span class="line">    <span class="attr">baseURL</span>: <span class="string">&quot;https://api.uomg.com/&quot;</span>,</span><br><span class="line">    <span class="attr">timeout</span>: <span class="number">10000</span> <span class="comment">// 超时时间 10秒，单位是毫秒</span></span><br><span class="line">&#125;);</span><br><span class="line"></span><br><span class="line"><span class="comment">// 设置请求拦截器</span></span><br><span class="line">instance.<span class="property">interceptors</span>.<span class="property">request</span>.<span class="title function_">use</span>(</span><br><span class="line">    <span class="keyword">function</span> (<span class="params">config</span>) &#123;</span><br><span class="line">        <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">&quot;请求前拦截器&quot;</span>);</span><br><span class="line"></span><br><span class="line">        <span class="comment">// 请求之前设置请求信息的方法</span></span><br><span class="line">        config.<span class="property">headers</span>.<span class="property">Accept</span> = <span class="string">&quot;application/json, text/plain, text/html, */*&quot;</span>;</span><br><span class="line"></span><br><span class="line">        <span class="comment">// 设置完毕必须返回config</span></span><br><span class="line">        <span class="keyword">return</span> config;</span><br><span class="line">    &#125;,</span><br><span class="line">    <span class="keyword">function</span> (<span class="params">error</span>) &#123;</span><br><span class="line">        <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">&quot;请求前拦截器异常方法:&quot;</span>, error);</span><br><span class="line">        <span class="comment">// 返回失败状态的promise</span></span><br><span class="line">        <span class="keyword">return</span> <span class="title class_">Promise</span>.<span class="title function_">reject</span>(error);</span><br><span class="line">    &#125;</span><br><span class="line">);</span><br><span class="line"></span><br><span class="line"><span class="comment">// 设置响应拦截器</span></span><br><span class="line">instance.<span class="property">interceptors</span>.<span class="property">response</span>.<span class="title function_">use</span>(</span><br><span class="line">    <span class="keyword">function</span> (<span class="params">response</span>) &#123;</span><br><span class="line">        <span class="comment">// 响应状态码为200的方法</span></span><br><span class="line">        <span class="comment">// 预处理/修改 response...</span></span><br><span class="line">        <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">&quot;响应成功拦截器:&quot;</span>, response.<span class="property">data</span>);</span><br><span class="line"></span><br><span class="line">        <span class="comment">// 响应成功后必须返回response, 从而让client得到响应数据</span></span><br><span class="line">        <span class="keyword">return</span> response;</span><br><span class="line">    &#125;, </span><br><span class="line">    <span class="keyword">function</span> (<span class="params">error</span>) &#123;</span><br><span class="line">        <span class="comment">// 状态码不为200的方法</span></span><br><span class="line">        <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">&quot;响应失败拦截器:&quot;</span>, error);</span><br><span class="line"></span><br><span class="line">        <span class="comment">// 响应失败后必须返回promise.reject</span></span><br><span class="line">        <span class="keyword">return</span> <span class="title class_">Promise</span>.<span class="title function_">reject</span>(error);</span><br><span class="line">    &#125;</span><br><span class="line">);</span><br><span class="line"></span><br><span class="line"><span class="comment">// 向外默认导出instance</span></span><br><span class="line"><span class="keyword">export</span> <span class="keyword">default</span> instance;</span><br></pre></td></tr></table></figure>

<h2 id="10-案例开发——日程管理第六期"><a href="#10-案例开发——日程管理第六期" class="headerlink" title="10. 案例开发——日程管理第六期"></a>10. 案例开发——日程管理第六期</h2><h3 id="10-1-前端向后端发送请求"><a href="#10-1-前端向后端发送请求" class="headerlink" title="10.1 前端向后端发送请求"></a>10.1 前端向后端发送请求</h3><h4 id="10-1-1-封装工具类src-utils-request-js"><a href="#10-1-1-封装工具类src-utils-request-js" class="headerlink" title="10.1.1 封装工具类src&#x2F;utils&#x2F;request.js"></a>10.1.1 封装工具类src&#x2F;utils&#x2F;request.js</h4><figure class="highlight js"><table><tr><td class="code"><pre><span class="line"><span class="keyword">import</span> axios <span class="keyword">from</span> <span class="string">&#x27;axios&#x27;</span></span><br><span class="line"></span><br><span class="line"><span class="comment">//  创建instance实例</span></span><br><span class="line"><span class="keyword">const</span> instance = axios.<span class="title function_">create</span>(&#123;</span><br><span class="line">    <span class="attr">baseURL</span>:<span class="string">&#x27;http://localhost:8080/&#x27;</span></span><br><span class="line">   </span><br><span class="line">&#125;)</span><br><span class="line"></span><br><span class="line"><span class="comment">//  添加请求拦截</span></span><br><span class="line">instance.<span class="property">interceptors</span>.<span class="property">request</span>.<span class="title function_">use</span>(</span><br><span class="line">    <span class="comment">// 设置请求头配置信息</span></span><br><span class="line">    <span class="function"><span class="params">config</span>=&gt;</span>&#123;</span><br><span class="line">        <span class="comment">//处理指定的请求头</span></span><br><span class="line">        </span><br><span class="line">        <span class="keyword">return</span> config</span><br><span class="line">    &#125;,</span><br><span class="line">    <span class="comment">// 设置请求错误处理函数</span></span><br><span class="line">    <span class="function"><span class="params">error</span>=&gt;</span>&#123;</span><br><span class="line">    </span><br><span class="line">        <span class="keyword">return</span> <span class="title class_">Promise</span>.<span class="title function_">reject</span>(error)</span><br><span class="line">    &#125;</span><br><span class="line">)</span><br><span class="line"><span class="comment">// 添加响应拦截器</span></span><br><span class="line">instance.<span class="property">interceptors</span>.<span class="property">response</span>.<span class="title function_">use</span>(</span><br><span class="line">    <span class="comment">// 设置响应正确时的处理函数</span></span><br><span class="line">    <span class="function"><span class="params">response</span>=&gt;</span>&#123;</span><br><span class="line">      </span><br><span class="line">        <span class="keyword">return</span> response</span><br><span class="line">    &#125;,</span><br><span class="line">    <span class="comment">// 设置响应异常时的处理函数</span></span><br><span class="line">    <span class="function"><span class="params">error</span>=&gt;</span>&#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="title class_">Promise</span>.<span class="title function_">reject</span>(error)</span><br><span class="line">    &#125;</span><br><span class="line">)</span><br><span class="line"><span class="comment">// 默认导出</span></span><br><span class="line"><span class="keyword">export</span> <span class="keyword">default</span> instance</span><br></pre></td></tr></table></figure>

<h4 id="10-1-2-注册登录请求实现"><a href="#10-1-2-注册登录请求实现" class="headerlink" title="10.1.2 注册登录请求实现"></a>10.1.2 注册登录请求实现</h4><p>在原先基础上 导入前面的request对象，然后请求即可</p>
<p>regist.vue</p>
<p><img src="/img/loading.gif" data-original="https://yuezi-1308313119.cos.ap-guangzhou.myqcloud.com/typora-user-images%2Fimage-20241003200209792.png" alt="image-20241003200209792">	</p>
<p>login.vue</p>
<p><img src="/img/loading.gif" data-original="https://yuezi-1308313119.cos.ap-guangzhou.myqcloud.com/typora-user-images%2Fimage-20241003200333109.png" alt="image-20241003200333109">	</p>
<h3 id="10-2-后端处理请求"><a href="#10-2-后端处理请求" class="headerlink" title="10.2 后端处理请求"></a>10.2 后端处理请求</h3><h4 id="10-2-1-跨域处理器"><a href="#10-2-1-跨域处理器" class="headerlink" title="10.2.1 跨域处理器"></a>10.2.1 跨域处理器</h4><h5 id="什么是跨域-为什么有跨域"><a href="#什么是跨域-为什么有跨域" class="headerlink" title="什么是跨域 为什么有跨域"></a>什么是跨域 为什么有跨域</h5><p><strong>什么是跨域</strong></p>
<ul>
<li>当用户尝试跨域请求时，会触发浏览器一个基础核心的安全功能——<code>同源策略（Sameoriginpolicy）</code><ul>
<li>同源策略阻止一个域的javascript脚本与另外一个域交互。（同源的意思就是在一个域下，即两个页面<code>具有相同的协议protocol 主机host 端口号</code>）</li>
</ul>
</li>
</ul>
<p><strong>为什么会产生跨域</strong></p>
<ul>
<li>在目前前后端分离模式下，前端告知浏览器向后端服务器发送异步请求资源</li>
<li>然而前端资源的地址和后端请求资源的地址不满足同源条件，因此产生跨域，将会被浏览器拦下来</li>
</ul>
<img src="/img/loading.gif" data-original="https://yuezi-1308313119.cos.ap-guangzhou.myqcloud.com/typora-user-images%2Fimage-20241003200432327.png" alt="image-20241003200432327" style="zoom:80%;" />	

<h5 id="解决跨域问题"><a href="#解决跨域问题" class="headerlink" title="解决跨域问题"></a>解决跨域问题</h5><ul>
<li>一种思路是<code>代理模式</code>，异步请求的工作交由前端服务器来做<ul>
<li>前端服务器会产生较大的负载</li>
</ul>
</li>
</ul>
<img src="/img/loading.gif" data-original="https://yuezi-1308313119.cos.ap-guangzhou.myqcloud.com/typora-user-images%2Fimage-20241003201042980.png" alt="image-20241003201042980" style="zoom:80%;" />	

<ul>
<li>第二种思路是<code>后端跨域过滤器</code>处理<ul>
<li>实际上浏览器在跨域请求时会发送<code>预检请求OPTIONS</code>来检查目标资源是否安全，所以通过后端对该请求进行回应即可解决跨域问题</li>
</ul>
</li>
</ul>
<img src="/img/loading.gif" data-original="https://yuezi-1308313119.cos.ap-guangzhou.myqcloud.com/typora-user-images%2Fimage-20241003201149299.png" alt="image-20241003201149299" style="zoom:80%;" />	

<p>后端在filter目录下新建一个CrosFilter.java</p>
<ul>
<li>后续未来使用框架的时候，直接用一个<code>@CrossOrigin</code> 就可以解决跨域问题了</li>
<li>对于<code>预检请求</code>（OPTIONS方法）的处理说明：<ul>
<li><code>Access-Control-Allow-Origin</code>：指定允许哪些域可以访问资源。如果设置为<code>*</code>，则允许任何域；如果设置为特定域名，则仅允许该域的请求。</li>
<li><code>Access-Control-Allow-Methods</code>：指定允许的HTTP方法，例如GET、POST、PUT、DELETE等。</li>
<li><code>Access-Control-Allow-Headers</code>：指定允许哪些请求头被发送。</li>
</ul>
</li>
</ul>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="keyword">package</span> com.atguigu.schedule.filter;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> com.atguigu.schedule.common.Result;</span><br><span class="line"><span class="keyword">import</span> com.atguigu.schedule.util.WebUtil;</span><br><span class="line"><span class="keyword">import</span> jakarta.servlet.*;</span><br><span class="line"><span class="keyword">import</span> jakarta.servlet.annotation.WebFilter;</span><br><span class="line"><span class="keyword">import</span> jakarta.servlet.annotation.WebServlet;</span><br><span class="line"><span class="keyword">import</span> jakarta.servlet.http.HttpServletRequest;</span><br><span class="line"><span class="keyword">import</span> jakarta.servlet.http.HttpServletResponse;</span><br><span class="line"><span class="keyword">import</span> java.io.IOException;</span><br><span class="line"></span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@author</span> yuezi2048</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@version</span> 1.0</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="meta">@WebFilter(&quot;/*&quot;)</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">CrosFilter</span> <span class="keyword">implements</span> <span class="title class_">Filter</span> &#123;</span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">doFilter</span><span class="params">(ServletRequest servletRequest, ServletResponse servletResponse, FilterChain filterChain)</span> <span class="keyword">throws</span> IOException, ServletException &#123;</span><br><span class="line"></span><br><span class="line">        <span class="type">HttpServletRequest</span> <span class="variable">request</span> <span class="operator">=</span> (HttpServletRequest) servletRequest;</span><br><span class="line">        System.out.println(request.getMethod() + <span class="string">&quot; &quot;</span> + request.getRequestURI());</span><br><span class="line">        <span class="type">HttpServletResponse</span> <span class="variable">response</span> <span class="operator">=</span> (HttpServletResponse) servletResponse;</span><br><span class="line">        response.setHeader(<span class="string">&quot;Access-Control-Allow-Origin&quot;</span>, <span class="string">&quot;*&quot;</span>);</span><br><span class="line">        response.setHeader(<span class="string">&quot;Access-Control-Allow-Methods&quot;</span>, <span class="string">&quot;POST, GET, PUT,OPTIONS, DELETE, HEAD&quot;</span>);</span><br><span class="line">        response.setHeader(<span class="string">&quot;Access-Control-Max-Age&quot;</span>, <span class="string">&quot;3600&quot;</span>);</span><br><span class="line">        response.setHeader(<span class="string">&quot;Access-Control-Allow-Headers&quot;</span>, <span class="string">&quot;access-control-allow-origin, authority, content-type, version-info, X-Requested-With&quot;</span>);</span><br><span class="line">        <span class="comment">// 如果是跨域预检请求,则直接在此响应200业务码</span></span><br><span class="line">        <span class="keyword">if</span>(request.getMethod().equalsIgnoreCase(<span class="string">&quot;OPTIONS&quot;</span>))&#123;</span><br><span class="line">            WebUtil.writeJson(response, Result.ok(<span class="literal">null</span>));</span><br><span class="line">        &#125;<span class="keyword">else</span>&#123;</span><br><span class="line">            <span class="comment">// 非预检请求,放行即可</span></span><br><span class="line">            filterChain.doFilter(servletRequest, servletResponse);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<h4 id="10-2-2-UserController重构"><a href="#10-2-2-UserController重构" class="headerlink" title="10.2.2 UserController重构"></a>10.2.2 UserController重构</h4><ul>
<li>重构的内容<ul>
<li>对于请求，需要解析出对应的用户信息</li>
<li>具体运行：controller -&gt; service -&gt; dao </li>
<li>对于响应，需要响应给客户端相关用户信息（例如登录后前端需要当前登录用户名信息）</li>
</ul>
</li>
</ul>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="keyword">package</span> com.atguigu.schedule.controller;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> com.atguigu.schedule.common.Result;</span><br><span class="line"><span class="keyword">import</span> com.atguigu.schedule.common.ResultCodeEnum;</span><br><span class="line"><span class="keyword">import</span> com.atguigu.schedule.pojo.SysUser;</span><br><span class="line"><span class="keyword">import</span> com.atguigu.schedule.service.SysUserService;</span><br><span class="line"><span class="keyword">import</span> com.atguigu.schedule.service.impl.SysUserServiceImpl;</span><br><span class="line"><span class="keyword">import</span> com.atguigu.schedule.util.MD5Util;</span><br><span class="line"><span class="keyword">import</span> com.atguigu.schedule.util.MyWebUtil;</span><br><span class="line"><span class="keyword">import</span> com.atguigu.schedule.util.WebUtil;</span><br><span class="line"><span class="keyword">import</span> com.fasterxml.jackson.databind.ObjectMapper;</span><br><span class="line"><span class="keyword">import</span> jakarta.servlet.ServletException;</span><br><span class="line"><span class="keyword">import</span> jakarta.servlet.annotation.WebServlet;</span><br><span class="line"><span class="keyword">import</span> jakarta.servlet.http.HttpServletRequest;</span><br><span class="line"><span class="keyword">import</span> jakarta.servlet.http.HttpServletResponse;</span><br><span class="line"><span class="keyword">import</span> jakarta.servlet.http.HttpSession;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> java.io.BufferedReader;</span><br><span class="line"><span class="keyword">import</span> java.io.IOException;</span><br><span class="line"><span class="keyword">import</span> java.util.HashMap;</span><br><span class="line"><span class="keyword">import</span> java.util.Map;</span><br><span class="line"></span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@author</span> yuezi2048</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@version</span> 1.0</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="meta">@WebServlet(&quot;/user/*&quot;)</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">SysUserController</span> <span class="keyword">extends</span> <span class="title class_">BaseController</span> &#123;</span><br><span class="line">    <span class="keyword">private</span> <span class="type">SysUserService</span> <span class="variable">userService</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">SysUserServiceImpl</span>();</span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * 接收用户登录请求的业务方法（完成登录的业务接口）</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@param</span> request</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@param</span> response</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@throws</span> ServletException</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@throws</span> IOException</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="keyword">protected</span> <span class="keyword">void</span> <span class="title function_">login</span><span class="params">(HttpServletRequest request, HttpServletResponse response)</span> <span class="keyword">throws</span> ServletException, IOException &#123;</span><br><span class="line">        <span class="comment">// 1. 接收用户名密码</span></span><br><span class="line">        <span class="type">SysUser</span> <span class="variable">sysUser</span> <span class="operator">=</span> WebUtil.readJson(request, SysUser.class);</span><br><span class="line"></span><br><span class="line">        <span class="comment">// 2. 调用服务层方法，根据用户名查询用户信息</span></span><br><span class="line">        <span class="type">SysUser</span> <span class="variable">loginUser</span> <span class="operator">=</span> userService.findUserName(sysUser.getUsername());</span><br><span class="line"></span><br><span class="line">        <span class="type">Result</span> <span class="variable">result</span> <span class="operator">=</span> <span class="literal">null</span>;</span><br><span class="line"></span><br><span class="line">        <span class="keyword">if</span> (loginUser == <span class="literal">null</span>) &#123;</span><br><span class="line">            <span class="comment">// 用户名有误，跳转到用户名有误提示页</span></span><br><span class="line">            result = Result.build(<span class="literal">null</span>, ResultCodeEnum.USERNAME_ERROR);</span><br><span class="line">        &#125; <span class="keyword">else</span> <span class="keyword">if</span> (!MD5Util.encrypt(sysUser.getUserPwd()).equals(loginUser.getUserPwd())) &#123;</span><br><span class="line">            <span class="comment">// 密码有误，跳转到密码有误提示也</span></span><br><span class="line">            result = Result.build(<span class="literal">null</span>, ResultCodeEnum.PASSWORD_ERROR);</span><br><span class="line">        &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">            <span class="comment">// 登录成功，将用户的uid和username响应给客户端(复用原来的loginUser对象 清空密码将该对象发回去)</span></span><br><span class="line">            Map&lt;String, Object&gt; data = <span class="keyword">new</span> <span class="title class_">HashMap</span>&lt;&gt;();</span><br><span class="line">            loginUser.setUserPwd(<span class="string">&quot;&quot;</span>);</span><br><span class="line">            data.put(<span class="string">&quot;loginUser&quot;</span>, loginUser);</span><br><span class="line"></span><br><span class="line">            result = Result.ok(data);</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        WebUtil.writeJson(response, result);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * 接收用户注册请求的业务处理方法（接口 不是java的接口）</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@param</span> req</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@param</span> resp</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@throws</span> ServletException</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@throws</span> IOException</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="keyword">protected</span> <span class="keyword">void</span> <span class="title function_">register</span><span class="params">(HttpServletRequest req, HttpServletResponse resp)</span> <span class="keyword">throws</span> ServletException, IOException &#123;</span><br><span class="line">        <span class="comment">// 1.接收用户提交的参数，并将json参数转换为User对象获取信息</span></span><br><span class="line">        <span class="type">SysUser</span> <span class="variable">registerUser</span> <span class="operator">=</span> WebUtil.readJson(req, SysUser.class);</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">        <span class="comment">// 2. 调用service层方法 完成注册功能</span></span><br><span class="line">        <span class="comment">// 将参数封装为SysUser对象中 再调用register方法时传入（后续框架会自动完成封装 传参 先养成习惯）</span></span><br><span class="line">        <span class="comment">// 为什么前端校验后，后端依然校验：考虑到并发情况下，如果同时为两个相同的用户进行注册，要求有一个注册失败</span></span><br><span class="line">        <span class="type">int</span> <span class="variable">rows</span> <span class="operator">=</span> userService.register(registerUser);</span><br><span class="line"></span><br><span class="line">        <span class="comment">// 3. 根据注册结果（成功 or 失败），做页面跳转</span></span><br><span class="line">        <span class="type">Result</span> <span class="variable">result</span> <span class="operator">=</span> Result.ok(<span class="literal">null</span>);</span><br><span class="line">        <span class="keyword">if</span> (rows &lt; <span class="number">1</span>) &#123;</span><br><span class="line">            result = Result.build(<span class="literal">null</span>, ResultCodeEnum.USERNAME_USED);</span><br><span class="line">        &#125;</span><br><span class="line">        WebUtil.writeJson(resp, result);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * 注册时接收要接受的用户名，校验用户名是否被占用的业务接口</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@param</span> req</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@param</span> resp</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@throws</span> ServletException</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@throws</span> IOException</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="keyword">protected</span> <span class="keyword">void</span> <span class="title function_">checkUsernameUsed</span><span class="params">(HttpServletRequest req, HttpServletResponse resp)</span> <span class="keyword">throws</span> ServletException, IOException &#123;</span><br><span class="line">        <span class="comment">// 接收用户名</span></span><br><span class="line">        <span class="type">String</span> <span class="variable">username</span> <span class="operator">=</span> req.getParameter(<span class="string">&quot;username&quot;</span>);</span><br><span class="line"></span><br><span class="line">        <span class="comment">// 调用service层业务处理方法，查询是否有该用户</span></span><br><span class="line">        <span class="type">SysUser</span> <span class="variable">sysUser</span> <span class="operator">=</span> userService.findUserName(username);</span><br><span class="line"></span><br><span class="line">        Result&lt;Object&gt; result = Result.ok(<span class="literal">null</span>);</span><br><span class="line"></span><br><span class="line">        <span class="comment">// 如果有，响应占用，否则响应可用</span></span><br><span class="line">        <span class="keyword">if</span> (sysUser != <span class="literal">null</span>) &#123;</span><br><span class="line">            result = Result.build(<span class="literal">null</span>, ResultCodeEnum.USERNAME_USED);</span><br><span class="line">        &#125;</span><br><span class="line"><span class="comment">//        // 将result对象转换为JSON串响应给客户端（ObjectMapper）,已封装为一个工具方法</span></span><br><span class="line"><span class="comment">//        ObjectMapper objectMapper = new ObjectMapper();</span></span><br><span class="line"><span class="comment">//        String info = objectMapper.writeValueAsString(result);</span></span><br><span class="line"><span class="comment">//</span></span><br><span class="line"><span class="comment">//        // 告诉客户端这是JSON串</span></span><br><span class="line"><span class="comment">//        resp.setContentType(&quot;application/json;charset=utf-8&quot;);</span></span><br><span class="line"><span class="comment">//        resp.getWriter().write(info);</span></span><br><span class="line">        WebUtil.writeJson(resp, result); <span class="comment">// 直接向客户返回JSON串，后续SpringMVC会封装为一个注解，了解即可</span></span><br><span class="line"></span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h4 id="10-2-3-登录校验器暂时删除"><a href="#10-2-3-登录校验器暂时删除" class="headerlink" title="10.2.3 登录校验器暂时删除"></a>10.2.3 登录校验器暂时删除</h4><p>这里暂不使用cookie和session方式记录用户状态,未来使用token,所以登录过滤器删除即可</p>
<h2 id="11-Vue3状态管理Pinia"><a href="#11-Vue3状态管理Pinia" class="headerlink" title="11. Vue3状态管理Pinia"></a>11. Vue3状态管理Pinia</h2><h3 id="11-1-Pinia介绍"><a href="#11-1-Pinia介绍" class="headerlink" title="11.1 Pinia介绍"></a>11.1 Pinia介绍</h3><p>首先回顾一下组件之间的数据传递</p>
<ul>
<li>组件传参</li>
<li>路由传参</li>
<li><strong>通过Pinia状态管理定义共享数据</strong></li>
</ul>
<p>当我们由多个组件需要<code>共享一个共同的状态（数据源）</code>，即多个视图可能依赖于同一个状态，不同视图交互可能要同时更改同一个状态，一般情况的手动状态管理解决方案（props 组件通信 模块化）在简单场景够用了，但在大规模生产环境需要考虑很多事项：</p>
<ul>
<li>更强的团队协作约定</li>
<li>与 Vue DevTools 集成，包括时间轴、组件内部审查和时间旅行调试</li>
<li>模块热更新 (HMR)</li>
<li>服务端渲染支持</li>
</ul>
<blockquote>
<p> <a target="_blank" rel="noopener" href="https://pinia.vuejs.org/zh/" title="Pinia">Pinia</a> 就是一个实现了上述需求的状态管理库，由 Vue 核心团队维护，对 Vue 2 和 Vue 3 都可用。<a target="_blank" rel="noopener" href="https://pinia.vuejs.org/zh/introduction.html">https://pinia.vuejs.org/zh/introduction.html</a></p>
</blockquote>
<h3 id="11-2-Pinia快速入门"><a href="#11-2-Pinia快速入门" class="headerlink" title="11.2 Pinia快速入门"></a>11.2 Pinia快速入门</h3><p>npm安装pinia略 说明一点：App.js和router一样需要引入</p>
<figure class="highlight js"><table><tr><td class="code"><pre><span class="line"><span class="keyword">import</span> &#123; createApp &#125; <span class="keyword">from</span> <span class="string">&#x27;vue&#x27;</span></span><br><span class="line"><span class="keyword">import</span> <span class="string">&#x27;./style.css&#x27;</span></span><br><span class="line"><span class="keyword">import</span> <span class="title class_">App</span> <span class="keyword">from</span> <span class="string">&#x27;./App.vue&#x27;</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> router <span class="keyword">from</span> <span class="string">&#x27;./routers/router&#x27;</span>;</span><br><span class="line"></span><br><span class="line"><span class="comment">// 开启全局的pinia功能，帮助我们解析defineStore</span></span><br><span class="line"><span class="keyword">import</span> &#123; createPinia &#125; <span class="keyword">from</span> <span class="string">&#x27;pinia&#x27;</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">let</span> pinia = <span class="title function_">createPinia</span>();</span><br><span class="line"></span><br><span class="line"><span class="keyword">let</span> app = <span class="title function_">createApp</span>(<span class="title class_">App</span>)</span><br><span class="line">app.<span class="title function_">use</span>(router)</span><br><span class="line">app.<span class="title function_">use</span>(pinia)</span><br><span class="line">app.<span class="title function_">mount</span>(<span class="string">&#x27;#app&#x27;</span>)</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<p>首先定义pinia<code> store对象</code> src&#x2F;store&#x2F;store.js [推荐这么命名不是强制]</p>
<figure class="highlight js"><table><tr><td class="code"><pre><span class="line"><span class="comment">/* 定义共享的pinia数据 */</span></span><br><span class="line"><span class="keyword">import</span> &#123; defineStore &#125; <span class="keyword">from</span> <span class="string">&#x27;pinia&#x27;</span>;</span><br><span class="line"></span><br><span class="line"><span class="comment">// 定义一个Person共享</span></span><br><span class="line"><span class="keyword">export</span> <span class="keyword">const</span> definedPerson = <span class="title function_">defineStore</span>(</span><br><span class="line">    &#123;</span><br><span class="line">        <span class="attr">id</span>: <span class="string">&quot;1&quot;</span>, <span class="comment">// 当前数据ID 必须全局唯一（包括多个store文件），也可以写到外层 defineStore(&#123;id: &quot;1&quot;,...&#125;)</span></span><br><span class="line">        <span class="attr">state</span>: <span class="function">() =&gt;</span> &#123; <span class="comment">// 状态：就是响应式数据</span></span><br><span class="line">            <span class="keyword">return</span> &#123; <span class="comment">// 固定写法，里面写上我们真正的数据</span></span><br><span class="line">                <span class="attr">name</span>: <span class="string">&quot;zhangsan&quot;</span>,</span><br><span class="line">                <span class="attr">age</span>: <span class="number">0</span>,</span><br><span class="line">                <span class="attr">hobbies</span>: [<span class="string">&quot;唱&quot;</span>, <span class="string">&quot;跳&quot;</span>, <span class="string">&quot;rap&quot;</span>],</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;,</span><br><span class="line">        <span class="attr">getters</span>: &#123; <span class="comment">// 专门定义一些获得数据或使用数据计算结果的函数，该函数不要修改数据</span></span><br><span class="line">            <span class="title function_">getAge</span>(<span class="params"></span>) &#123;</span><br><span class="line">                <span class="keyword">return</span> <span class="variable language_">this</span>.<span class="property">age</span>;</span><br><span class="line">            &#125;,</span><br><span class="line">            <span class="comment">// 箭头函数写法，注意this指向不到state，需要用参数state传入</span></span><br><span class="line">            <span class="attr">getHobbiesCount</span>: <span class="function">(<span class="params">state</span>) =&gt;</span> state.<span class="property">hobbies</span>.<span class="property">length</span></span><br><span class="line">        &#125;,</span><br><span class="line">        <span class="attr">actions</span>: &#123; <span class="comment">// 专门定义一些修改数据的函数</span></span><br><span class="line">            <span class="title function_">doubleAge</span>(<span class="params"></span>) &#123;</span><br><span class="line">                <span class="variable language_">this</span>.<span class="property">age</span> *= <span class="number">2</span>;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">);</span><br></pre></td></tr></table></figure>

<p>定义<strong>Operate视图</strong>，演示修改数据</p>
<ul>
<li>直接通过import {} 导入用户变量即可</li>
<li>后续可通过表单双向绑定来修改全局数据</li>
<li>亦可调用action中的方法</li>
<li>pinia特殊方法<ul>
<li>恢复默认值：person.$reset() </li>
<li>批量修改： person.$patch( {name: ‘奥特曼’, age: 18, hobbies: [‘唱’, ‘跳’, ‘rap’, ‘篮球’]} )</li>
</ul>
</li>
</ul>
<p><img src="/img/loading.gif" data-original="https://yuezi-1308313119.cos.ap-guangzhou.myqcloud.com/typora-user-images%2Fimage-20241003210128004.png" alt="image-20241003210128004"></p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">&lt;script setup&gt;</span><br><span class="line">// 导入pinia的数据</span><br><span class="line">import &#123; definedPerson &#125; from &#x27;../store/store&#x27;;</span><br><span class="line"></span><br><span class="line">let person = definedPerson();</span><br><span class="line"></span><br><span class="line">&lt;/script&gt;</span><br><span class="line"></span><br><span class="line">&lt;template&gt;</span><br><span class="line">    &lt;div&gt;</span><br><span class="line">        &lt;h1&gt;用于修改pinia数据&lt;/h1&gt;  </span><br><span class="line">        名字：&lt;input type=&quot;text&quot; value=&quot;张三&quot; v-model=&quot;person.name&quot;&gt; &lt;br&gt;</span><br><span class="line">        年龄：&lt;input type=&quot;number&quot; value=&quot;20&quot; v-model=&quot;person.age&quot;&gt; &lt;br&gt;</span><br><span class="line">        &lt;!-- getters方法调用的时候直接当作属性调用即可 --&gt;</span><br><span class="line">        &lt;span&gt;&#123;&#123; person.getAge &#125;&#125;&lt;/span&gt;</span><br><span class="line">        &lt;br&gt;</span><br><span class="line">        爱好：</span><br><span class="line">            &lt;input type=&quot;checkbox&quot; value=&quot;唱&quot; v-model=&quot;person.hobbies&quot;&gt; 唱 </span><br><span class="line">            &lt;input type=&quot;checkbox&quot; value=&quot;跳&quot; v-model=&quot;person.hobbies&quot;&gt; 跳 </span><br><span class="line">            &lt;input type=&quot;checkbox&quot; value=&quot;rap&quot; v-model=&quot;person.hobbies&quot;&gt; rap </span><br><span class="line">            &lt;input type=&quot;checkbox&quot; value=&quot;篮球&quot; v-model=&quot;person.hobbies&quot;&gt; 篮球 </span><br><span class="line">            &lt;input type=&quot;checkbox&quot; value=&quot;music&quot; v-model=&quot;person.hobbies&quot;&gt; music </span><br><span class="line">        &lt;br&gt;</span><br><span class="line">        &lt;button @click=&quot;person.doubleAge()&quot;&gt;年龄加倍&lt;/button&gt; &lt;br&gt;</span><br><span class="line">        &lt;button @click=&quot;person.$reset()&quot;&gt;恢复默认值&lt;/button&gt;</span><br><span class="line">        &lt;!-- 一次性修改多个值 $patch()方法 --&gt;</span><br><span class="line">        &lt;button @click=&quot;person.$patch(&#123;</span><br><span class="line">            name: &#x27;奥特曼&#x27;,</span><br><span class="line">            age: 18,</span><br><span class="line">            hobbies: [&#x27;唱&#x27;, &#x27;跳&#x27;, &#x27;rap&#x27;, &#x27;篮球&#x27;]</span><br><span class="line">            &#125;)&quot;&gt;变身奥特曼&lt;/button&gt;</span><br><span class="line">        &lt;hr&gt;</span><br><span class="line">        展示person数据：&#123;&#123; person &#125;&#125;</span><br><span class="line">    &lt;/div&gt;</span><br><span class="line">&lt;/template&gt;</span><br><span class="line"></span><br><span class="line">&lt;style scoped&gt;</span><br><span class="line">    </span><br><span class="line">&lt;/style&gt;</span><br></pre></td></tr></table></figure>

<p>定义list视图，演示展示数据</p>
<ul>
<li>注意一点即可，getters的方法返回值被当作一个属性来看待，无需加括号</li>
</ul>
<img src="/img/loading.gif" data-original="https://yuezi-1308313119.cos.ap-guangzhou.myqcloud.com/typora-user-images%2Fimage-20241003210652139.png" alt="image-20241003210652139" style="zoom:80%;" />	

<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">&lt;script setup type=&quot;module&quot;&gt;</span><br><span class="line">    import &#123; definedPerson&#125; from &#x27;../store/store&#x27;;</span><br><span class="line">    // 读取存储的数据</span><br><span class="line">    let person= definedPerson()</span><br><span class="line">&lt;/script&gt;</span><br><span class="line"></span><br><span class="line">&lt;template&gt;</span><br><span class="line">    &lt;div&gt;</span><br><span class="line">        &lt;h1&gt;List页面,展示Pinia中的数据&lt;/h1&gt;</span><br><span class="line">        读取姓名:&#123;&#123;person.name&#125;&#125; &lt;br&gt;</span><br><span class="line">        读取年龄:&#123;&#123;person.age&#125;&#125; &lt;br&gt;</span><br><span class="line">        通过get年龄:&#123;&#123;person.getAge&#125;&#125; &lt;br&gt;</span><br><span class="line">        爱好数量:&#123;&#123;person.getHobbiesCount&#125;&#125; &lt;br&gt;</span><br><span class="line">        所有的爱好:</span><br><span class="line">        &lt;ul&gt;</span><br><span class="line">            &lt;li v-for=&#x27;(hobby,index) in person.hobbies&#x27; :key=&quot;index&quot; v-text=&quot;hobby&quot;&gt;&lt;/li&gt;</span><br><span class="line">        &lt;/ul&gt;</span><br><span class="line">    &lt;/div&gt;</span><br><span class="line">&lt;/template&gt;</span><br><span class="line"></span><br><span class="line">&lt;style scoped&gt;</span><br><span class="line">&lt;/style&gt;</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<p>路由router.js</p>
<figure class="highlight js"><table><tr><td class="code"><pre><span class="line"><span class="keyword">import</span> &#123; createRouter, createWebHashHistory &#125; <span class="keyword">from</span> <span class="string">&#x27;vue-router&#x27;</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> <span class="title class_">List</span> <span class="keyword">from</span> <span class="string">&#x27;../components/List.vue&#x27;</span>;</span><br><span class="line"><span class="keyword">import</span> <span class="title class_">Operate</span> <span class="keyword">from</span> <span class="string">&#x27;../components/Operate.vue&#x27;</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> router = <span class="title function_">createRouter</span>(&#123;</span><br><span class="line">    <span class="attr">history</span>: <span class="title function_">createWebHashHistory</span>(),</span><br><span class="line">    <span class="attr">routes</span>: [</span><br><span class="line">        &#123;</span><br><span class="line">            <span class="attr">path</span>: <span class="string">&#x27;/&#x27;</span>,</span><br><span class="line">            <span class="attr">component</span>: <span class="title class_">Operate</span>,</span><br><span class="line">        &#125;,</span><br><span class="line">        &#123;</span><br><span class="line">            <span class="attr">path</span>: <span class="string">&#x27;/list&#x27;</span>,</span><br><span class="line">            <span class="attr">component</span>: <span class="title class_">List</span>,</span><br><span class="line">        &#125;,</span><br><span class="line">        &#123;</span><br><span class="line">            <span class="attr">path</span>: <span class="string">&#x27;/operate&#x27;</span>,</span><br><span class="line">            <span class="attr">components</span>: &#123;</span><br><span class="line">                <span class="attr">default</span>: <span class="title class_">Operate</span>,</span><br><span class="line">                <span class="attr">list</span>: <span class="title class_">List</span>,</span><br><span class="line">            &#125;,</span><br><span class="line">        &#125;,</span><br><span class="line">    ],</span><br><span class="line">&#125;);</span><br><span class="line"></span><br><span class="line"><span class="keyword">export</span> <span class="keyword">default</span> router;</span><br></pre></td></tr></table></figure>

<p>App.vue</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">&lt;script setup&gt;</span><br><span class="line">&lt;/script&gt;</span><br><span class="line"></span><br><span class="line">&lt;template&gt;</span><br><span class="line">  &lt;div&gt;</span><br><span class="line">    &lt;router-link to=&quot;/operate&quot;&gt;operate&lt;/router-link&gt;</span><br><span class="line">    &lt;br&gt;</span><br><span class="line">    &lt;router-link to=&quot;/list&quot;&gt;list&lt;/router-link&gt;</span><br><span class="line">    &lt;hr&gt;</span><br><span class="line">    &lt;router-view&gt;&lt;/router-view&gt;</span><br><span class="line">    &lt;router-view name=&quot;list&quot;&gt;&lt;/router-view&gt;</span><br><span class="line">  &lt;/div&gt;</span><br><span class="line">&lt;/template&gt;</span><br><span class="line"></span><br><span class="line">&lt;style scoped&gt;</span><br><span class="line">&lt;/style&gt;</span><br></pre></td></tr></table></figure>

<p>借助router的components一次性展示完整页面</p>
<p><img src="/img/loading.gif" data-original="https://yuezi-1308313119.cos.ap-guangzhou.myqcloud.com/typora-user-images%2Fimage-20241003210816406.png" alt="image-20241003210816406"></p>
<h3 id="11-3-Pinia细节"><a href="#11-3-Pinia细节" class="headerlink" title="11.3 Pinia细节"></a>11.3 Pinia细节</h3><blockquote>
<p> State (状态) 在大多数情况下，state 都是你的 store 的核心。人们通常会先定义能代表他们 APP 的 state。在 Pinia 中，state 被定义为一个返回初始状态的函数。</p>
</blockquote>
<ul>
<li>store.js</li>
</ul>
<figure class="highlight javascript"><table><tr><td class="code"><pre><span class="line"><span class="keyword">import</span> &#123;defineStore&#125; <span class="keyword">from</span> <span class="string">&#x27;pinia&#x27;</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">export</span> <span class="keyword">const</span> definedPerson = <span class="title function_">defineStore</span>(<span class="string">&#x27;personPinia&#x27;</span>,</span><br><span class="line">    &#123;</span><br><span class="line">        <span class="attr">state</span>:<span class="function">()=&gt;</span>&#123;</span><br><span class="line">            <span class="keyword">return</span> &#123;</span><br><span class="line">                <span class="attr">username</span>:<span class="string">&#x27;&#x27;</span>,</span><br><span class="line">                <span class="attr">age</span>:<span class="number">0</span>,</span><br><span class="line">                <span class="attr">hobbies</span>:[<span class="string">&#x27;唱歌&#x27;</span>,<span class="string">&#x27;跳舞&#x27;</span>]</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;,</span><br><span class="line">        <span class="attr">getters</span>:&#123;</span><br><span class="line">            <span class="title function_">getHobbiesCount</span>(<span class="params"></span>)&#123;</span><br><span class="line">                <span class="keyword">return</span> <span class="variable language_">this</span>.<span class="property">hobbies</span>.<span class="property">length</span></span><br><span class="line">            &#125;,</span><br><span class="line">            <span class="title function_">getAge</span>(<span class="params"></span>)&#123;</span><br><span class="line">                <span class="keyword">return</span> <span class="variable language_">this</span>.<span class="property">age</span></span><br><span class="line">            &#125;</span><br><span class="line">        &#125;,</span><br><span class="line">        <span class="attr">actions</span>:&#123;</span><br><span class="line">            <span class="title function_">doubleAge</span>(<span class="params"></span>)&#123;</span><br><span class="line">                <span class="variable language_">this</span>.<span class="property">age</span>=<span class="variable language_">this</span>.<span class="property">age</span>*<span class="number">2</span></span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">)</span><br></pre></td></tr></table></figure>

<ul>
<li>Operate.vue</li>
</ul>
<figure class="highlight html"><table><tr><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">script</span> <span class="attr">setup</span> <span class="attr">type</span>=<span class="string">&quot;module&quot;</span>&gt;</span><span class="language-javascript"></span></span><br><span class="line"><span class="language-javascript">    <span class="keyword">import</span> &#123; ref&#125; <span class="keyword">from</span> <span class="string">&#x27;vue&#x27;</span>;</span></span><br><span class="line"><span class="language-javascript">    <span class="keyword">import</span> &#123; definedPerson&#125; <span class="keyword">from</span> <span class="string">&#x27;../store/store&#x27;</span>;</span></span><br><span class="line"><span class="language-javascript">    <span class="comment">// 读取存储的数据</span></span></span><br><span class="line"><span class="language-javascript">    <span class="keyword">let</span> person= <span class="title function_">definedPerson</span>()</span></span><br><span class="line"><span class="language-javascript"></span></span><br><span class="line"><span class="language-javascript">    <span class="keyword">let</span> hobby = <span class="title function_">ref</span>(<span class="string">&#x27;&#x27;</span>)</span></span><br><span class="line"><span class="language-javascript">    <span class="keyword">let</span> <span class="title function_">addHobby</span>= (<span class="params"></span>)=&gt; &#123;</span></span><br><span class="line"><span class="language-javascript">        <span class="variable language_">console</span>.<span class="title function_">log</span>(hobby.<span class="property">value</span>)</span></span><br><span class="line"><span class="language-javascript">        person.<span class="property">hobbies</span>.<span class="title function_">push</span>(hobby.<span class="property">value</span>)</span></span><br><span class="line"><span class="language-javascript">    &#125;</span></span><br><span class="line"><span class="language-javascript">    <span class="comment">// 监听状态</span></span></span><br><span class="line"><span class="language-javascript">    person.$subscribe(<span class="function">(<span class="params">mutation,state</span>)=&gt;</span>&#123;</span></span><br><span class="line"><span class="language-javascript">        <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">&#x27;---subscribe---&#x27;</span>)</span></span><br><span class="line"><span class="language-javascript">        <span class="comment">/* </span></span></span><br><span class="line"><span class="comment"><span class="language-javascript">        mutation.storeId</span></span></span><br><span class="line"><span class="comment"><span class="language-javascript">            person.$id一样</span></span></span><br><span class="line"><span class="comment"><span class="language-javascript">        mutation.payload</span></span></span><br><span class="line"><span class="comment"><span class="language-javascript">            传递给 cartStore.$patch() 的补丁对象。</span></span></span><br><span class="line"><span class="comment"><span class="language-javascript">        state 数据状态,其实是一个代理</span></span></span><br><span class="line"><span class="comment"><span class="language-javascript">        */</span></span></span><br><span class="line"><span class="language-javascript">        <span class="variable language_">console</span>.<span class="title function_">log</span>(mutation)</span></span><br><span class="line"><span class="language-javascript">        <span class="variable language_">console</span>.<span class="title function_">log</span>(mutation.<span class="property">type</span>)</span></span><br><span class="line"><span class="language-javascript">        <span class="variable language_">console</span>.<span class="title function_">log</span>(mutation.<span class="property">payload</span>)</span></span><br><span class="line"><span class="language-javascript">        <span class="variable language_">console</span>.<span class="title function_">log</span>(mutation.<span class="property">storeId</span>)</span></span><br><span class="line"><span class="language-javascript">        <span class="variable language_">console</span>.<span class="title function_">log</span>(person.<span class="property">$id</span>)</span></span><br><span class="line"><span class="language-javascript">        <span class="comment">// 数据 其实是一个代理对象</span></span></span><br><span class="line"><span class="language-javascript">        <span class="variable language_">console</span>.<span class="title function_">log</span>(state)</span></span><br><span class="line"><span class="language-javascript">    &#125;)</span></span><br><span class="line"><span class="language-javascript"></span></span><br><span class="line"><span class="language-javascript"></span></span><br><span class="line"><span class="language-javascript"></span><span class="tag">&lt;/<span class="name">script</span>&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="tag">&lt;<span class="name">template</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">div</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">h1</span>&gt;</span>operate视图,用户操作Pinia中的数据<span class="tag">&lt;/<span class="name">h1</span>&gt;</span></span><br><span class="line">        请输入姓名:<span class="tag">&lt;<span class="name">input</span> <span class="attr">type</span>=<span class="string">&quot;text&quot;</span> <span class="attr">v-model</span>=<span class="string">&quot;person.username&quot;</span>&gt;</span> <span class="tag">&lt;<span class="name">br</span>&gt;</span></span><br><span class="line">        请输入年龄:<span class="tag">&lt;<span class="name">input</span> <span class="attr">type</span>=<span class="string">&quot;text&quot;</span> <span class="attr">v-model</span>=<span class="string">&quot;person.age&quot;</span>&gt;</span> <span class="tag">&lt;<span class="name">br</span>&gt;</span></span><br><span class="line">        请增加爱好:</span><br><span class="line">        <span class="tag">&lt;<span class="name">input</span> <span class="attr">type</span>=<span class="string">&quot;checkbox&quot;</span> <span class="attr">value</span>=<span class="string">&quot;吃饭&quot;</span>  <span class="attr">v-model</span>=<span class="string">&quot;person.hobbies&quot;</span>&gt;</span> 吃饭</span><br><span class="line">        <span class="tag">&lt;<span class="name">input</span> <span class="attr">type</span>=<span class="string">&quot;checkbox&quot;</span> <span class="attr">value</span>=<span class="string">&quot;睡觉&quot;</span>  <span class="attr">v-model</span>=<span class="string">&quot;person.hobbies&quot;</span>&gt;</span> 睡觉</span><br><span class="line">        <span class="tag">&lt;<span class="name">input</span> <span class="attr">type</span>=<span class="string">&quot;checkbox&quot;</span> <span class="attr">value</span>=<span class="string">&quot;打豆豆&quot;</span>  <span class="attr">v-model</span>=<span class="string">&quot;person.hobbies&quot;</span>&gt;</span> 打豆豆 <span class="tag">&lt;<span class="name">br</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">input</span> <span class="attr">type</span>=<span class="string">&quot;text&quot;</span> @<span class="attr">change</span>=<span class="string">&quot;addHobby&quot;</span> <span class="attr">v-model</span>=<span class="string">&quot;hobby&quot;</span>&gt;</span> <span class="tag">&lt;<span class="name">br</span>&gt;</span>  </span><br><span class="line">        <span class="comment">&lt;!-- 事件中调用person的doubleAge()方法 --&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">button</span> @<span class="attr">click</span>=<span class="string">&quot;person.doubleAge()&quot;</span>&gt;</span>年龄加倍<span class="tag">&lt;/<span class="name">button</span>&gt;</span> <span class="tag">&lt;<span class="name">br</span>&gt;</span></span><br><span class="line">        <span class="comment">&lt;!-- 事件中调用pinia提供的$reset()方法恢复数据的默认值 --&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">button</span> @<span class="attr">click</span>=<span class="string">&quot;person.$reset()&quot;</span>&gt;</span>恢复默认值<span class="tag">&lt;/<span class="name">button</span>&gt;</span> <span class="tag">&lt;<span class="name">br</span>&gt;</span></span><br><span class="line">        <span class="comment">&lt;!-- 事件中调用$patch方法一次性修改多个属性值 --&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">button</span> @<span class="attr">click</span>=<span class="string">&quot;person.$patch(&#123;username:&#x27;奥特曼&#x27;,age:100,hobbies:[&#x27;晒太阳&#x27;,&#x27;打怪兽&#x27;]&#125;)&quot;</span>&gt;</span>变身奥特曼<span class="tag">&lt;/<span class="name">button</span>&gt;</span> <span class="tag">&lt;<span class="name">br</span>&gt;</span></span><br><span class="line">		person:&#123;&#123;person&#125;&#125;</span><br><span class="line">    <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">template</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">style</span> <span class="attr">scoped</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">style</span>&gt;</span></span><br><span class="line"></span><br></pre></td></tr></table></figure>

<blockquote>
<p> 2 Getter 完全等同于 store 的 state 的<a target="_blank" rel="noopener" href="https://cn.vuejs.org/guide/essentials/computed.html" title="计算值">计算值</a>。可以通过 <code>defineStore()</code> 中的 <code>getters</code> 属性来定义它们。<strong>推荐</strong>使用箭头函数，并且它将接收 <code>state</code> 作为第一个参数：</p>
</blockquote>
<figure class="highlight javascript"><table><tr><td class="code"><pre><span class="line"><span class="keyword">export</span> <span class="keyword">const</span> useStore = <span class="title function_">defineStore</span>(<span class="string">&#x27;main&#x27;</span>, &#123;</span><br><span class="line">  <span class="attr">state</span>: <span class="function">() =&gt;</span> (&#123;</span><br><span class="line">    <span class="attr">count</span>: <span class="number">0</span>,</span><br><span class="line">  &#125;),</span><br><span class="line">  <span class="attr">getters</span>: &#123;</span><br><span class="line">    <span class="attr">doubleCount</span>: <span class="function">(<span class="params">state</span>) =&gt;</span> state.<span class="property">count</span> * <span class="number">2</span>,</span><br><span class="line">  &#125;,</span><br><span class="line">&#125;)</span><br></pre></td></tr></table></figure>

<blockquote>
<p> 3  Action 相当于组件中的 <a target="_blank" rel="noopener" href="https://v3.vuejs.org/guide/data-methods.html#methods" title="method">method</a>。它们可以通过 <code>defineStore()</code> 中的 <code>actions</code> 属性来定义，<strong>并且它们也是定义业务逻辑的完美选择。<strong>类似 <a target="_blank" rel="noopener" href="https://pinia.vuejs.org/zh/core-concepts/getters.html" title="getter">getter</a>，action 也可通过 <code>this</code> 访问</strong>整个 store 实例</strong>，并支持<strong>完整的类型标注(以及自动补全)</strong>。不同的是，<code>action</code> 可以是异步的，你可以在它们里面 <code>await</code> 调用任何 API，以及其他 action！</p>
</blockquote>
<figure class="highlight javascript"><table><tr><td class="code"><pre><span class="line"><span class="keyword">export</span> <span class="keyword">const</span> useCounterStore = <span class="title function_">defineStore</span>(<span class="string">&#x27;main&#x27;</span>, &#123;</span><br><span class="line">  <span class="attr">state</span>: <span class="function">() =&gt;</span> (&#123;</span><br><span class="line">    <span class="attr">count</span>: <span class="number">0</span>,</span><br><span class="line">  &#125;),</span><br><span class="line">  <span class="attr">actions</span>: &#123;</span><br><span class="line">    <span class="title function_">increment</span>(<span class="params"></span>) &#123;</span><br><span class="line">      <span class="variable language_">this</span>.<span class="property">count</span>++</span><br><span class="line">    &#125;,</span><br><span class="line">    <span class="title function_">randomizeCounter</span>(<span class="params"></span>) &#123;</span><br><span class="line">      <span class="variable language_">this</span>.<span class="property">count</span> = <span class="title class_">Math</span>.<span class="title function_">round</span>(<span class="number">100</span> * <span class="title class_">Math</span>.<span class="title function_">random</span>())</span><br><span class="line">    &#125;,</span><br><span class="line">  &#125;,</span><br><span class="line">&#125;)</span><br></pre></td></tr></table></figure>



<h2 id="12-案例开发——日程管理第七期（终章）"><a href="#12-案例开发——日程管理第七期（终章）" class="headerlink" title="12. 案例开发——日程管理第七期（终章）"></a>12. 案例开发——日程管理第七期（终章）</h2><h3 id="12-1-前端搭建Pinia存储用户数据"><a href="#12-1-前端搭建Pinia存储用户数据" class="headerlink" title="12.1 前端搭建Pinia存储用户数据"></a>12.1 前端搭建Pinia存储用户数据</h3><h4 id="12-1-1-定义共享数据"><a href="#12-1-1-定义共享数据" class="headerlink" title="12.1.1 定义共享数据"></a>12.1.1 定义共享数据</h4><p>创建Pinia依赖，导入main.js略</p>
<p>定义用户共享数据：在<strong>src&#x2F;store&#x2F;userStore.js</strong> 存储用户信息</p>
<ul>
<li>包含uid和username信息，我们后续需要通过username的信息进行页面相关特定数据的展示</li>
</ul>
<figure class="highlight js"><table><tr><td class="code"><pre><span class="line"><span class="comment">/*</span></span><br><span class="line"><span class="comment">    用于存储用户状态信息的pinia</span></span><br><span class="line"><span class="comment">*/</span></span><br><span class="line"><span class="keyword">import</span> &#123; defineStore &#125; <span class="keyword">from</span> <span class="string">&#x27;pinia&#x27;</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">export</span> <span class="keyword">const</span> defineUser = <span class="title function_">defineStore</span>(</span><br><span class="line">    <span class="string">&quot;loginUser&quot;</span>,</span><br><span class="line">    &#123;</span><br><span class="line">        <span class="attr">state</span>: <span class="function">() =&gt;</span> &#123;</span><br><span class="line">            <span class="keyword">return</span> &#123;</span><br><span class="line">                <span class="attr">uid</span>: <span class="number">0</span>,</span><br><span class="line">                <span class="attr">username</span>: <span class="string">&quot;&quot;</span>,</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;,</span><br><span class="line">        <span class="attr">getters</span>: &#123;&#125;,</span><br><span class="line">        <span class="attr">actions</span>: &#123;&#125;,</span><br><span class="line">    &#125;</span><br><span class="line">);</span><br></pre></td></tr></table></figure>

<p>定义日程共享数据：在<strong>src&#x2F;store&#x2F;scheduleStore.js 存储用户的日程信息</strong></p>
<ul>
<li>给出日程列表，可以给出固定数据进行测试</li>
</ul>
<figure class="highlight js"><table><tr><td class="code"><pre><span class="line"><span class="comment">/*</span></span><br><span class="line"><span class="comment">    专门用于存储日志信息的pinia</span></span><br><span class="line"><span class="comment">*/</span></span><br><span class="line"><span class="keyword">import</span> &#123; defineStore &#125; <span class="keyword">from</span> <span class="string">&#x27;pinia&#x27;</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">export</span> <span class="keyword">const</span> defineSchedle = <span class="title function_">defineStore</span>(</span><br><span class="line">    <span class="string">&quot;scheduleList&quot;</span>,</span><br><span class="line">    &#123;</span><br><span class="line">        <span class="attr">state</span>: <span class="function">() =&gt;</span> &#123;</span><br><span class="line">            <span class="keyword">return</span> &#123;</span><br><span class="line">                <span class="attr">itemList</span>: [</span><br><span class="line">                    &#123;</span><br><span class="line">                        <span class="attr">sid</span>: <span class="number">1</span>,</span><br><span class="line">                        <span class="attr">uid</span>: <span class="number">1</span>,</span><br><span class="line">                        <span class="attr">title</span>: <span class="string">&#x27;学习php&#x27;</span>,</span><br><span class="line">                        <span class="attr">completed</span>: <span class="number">1</span>,</span><br><span class="line">                    &#125;,</span><br><span class="line">                    &#123;</span><br><span class="line">                        <span class="attr">sid</span>: <span class="number">2</span>,</span><br><span class="line">                        <span class="attr">uid</span>: <span class="number">1</span>,</span><br><span class="line">                        <span class="attr">title</span>: <span class="string">&#x27;学习python&#x27;</span>,</span><br><span class="line">                        <span class="attr">completed</span>: <span class="number">0</span>,</span><br><span class="line">                    &#125;,</span><br><span class="line">                    &#123;</span><br><span class="line">                        <span class="attr">sid</span>: <span class="number">3</span>,</span><br><span class="line">                        <span class="attr">uid</span>: <span class="number">1</span>,</span><br><span class="line">                        <span class="attr">title</span>: <span class="string">&#x27;学习java&#x27;</span>,</span><br><span class="line">                        <span class="attr">completed</span>: <span class="number">0</span>,</span><br><span class="line">                    &#125;,</span><br><span class="line">                ]</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;,</span><br><span class="line">        <span class="attr">getters</span>: &#123;&#125;,</span><br><span class="line">        <span class="attr">actions</span>: &#123;&#125;,</span><br><span class="line">    &#125;</span><br><span class="line">);</span><br></pre></td></tr></table></figure>

<h4 id="12-1-2-Header组件依赖共享数据展示"><a href="#12-1-2-Header组件依赖共享数据展示" class="headerlink" title="12.1.2 Header组件依赖共享数据展示"></a>12.1.2 Header组件依赖共享数据展示</h4><p>头部组件根据数据动态更新：<code>Header.vue</code>中，通过pinia的数据，使用<code>v-if</code>判断展示何种视图</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">&lt;script setup&gt;</span><br><span class="line">  /* 导入pinia数据 */</span><br><span class="line">  import &#123; defineUser &#125; from &#x27;../store/userStore&#x27;;</span><br><span class="line">  import &#123; defineSchedle &#125; from &#x27;../store/scheduleStore&#x27;;</span><br><span class="line">  import &#123; useRouter &#125; from &#x27;vue-router&#x27;;</span><br><span class="line"></span><br><span class="line">  let sysUser = defineUser();</span><br><span class="line">  let schedule = defineSchedle();</span><br><span class="line">  let router = useRouter();</span><br><span class="line"></span><br><span class="line">  function logout() &#123;</span><br><span class="line">    // 清除所有pinia数据</span><br><span class="line">    sysUser.$reset();</span><br><span class="line">    schedule.$reset();</span><br><span class="line"></span><br><span class="line">    // 跳转到登录页面</span><br><span class="line">    router.push(&#x27;/login&#x27;);</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">&lt;/script&gt;</span><br><span class="line"></span><br><span class="line">&lt;template&gt;</span><br><span class="line">  &lt;div&gt;</span><br><span class="line">    &lt;h1 class=&quot;ht&quot;&gt;欢迎使用日程管理系统&lt;/h1&gt;</span><br><span class="line">    &lt;div&gt;</span><br><span class="line">      &lt;div  class=&quot;optionDiv&quot; v-if=&quot;sysUser.username === &#x27;&#x27; &quot;&gt;</span><br><span class="line">        &lt;router-link to=&quot;/login&quot;&gt;</span><br><span class="line">          &lt;button class=&quot;b1s&quot;&gt;登录&lt;/button&gt;</span><br><span class="line">        &lt;/router-link&gt;   </span><br><span class="line">        &lt;router-link to=&quot;/regist&quot;&gt;</span><br><span class="line">          &lt;button class=&quot;b1s&quot;&gt;注册&lt;/button&gt;</span><br><span class="line">        &lt;/router-link&gt;</span><br><span class="line">      &lt;/div&gt;</span><br><span class="line"></span><br><span class="line">      &lt;div   class=&quot;optionDiv&quot; v-else&gt;</span><br><span class="line">        欢迎&#123;&#123; sysUser.username &#125;&#125;   </span><br><span class="line">        &lt;button class=&quot;b1b&quot; @click=&quot;logout()&quot;&gt;退出登录&lt;/button&gt; </span><br><span class="line">        &lt;router-link to=&quot;/showSchedule&quot;&gt;</span><br><span class="line">          &lt;button class=&quot;b1b&quot;&gt;查看我的日程&lt;/button&gt;</span><br><span class="line">        &lt;/router-link&gt;</span><br><span class="line">      &lt;/div&gt;</span><br><span class="line"></span><br><span class="line">      &lt;br&gt;</span><br><span class="line">    &lt;/div&gt;</span><br><span class="line">  &lt;/div&gt;</span><br><span class="line">&lt;/template&gt;</span><br><span class="line"></span><br><span class="line">&lt;style scoped&gt;</span><br><span class="line">	/* 略 */</span><br><span class="line">&lt;/style&gt;</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<h4 id="12-1-3-Login组件更新共享数据"><a href="#12-1-3-Login组件更新共享数据" class="headerlink" title="12.1.3 Login组件更新共享数据"></a>12.1.3 Login组件更新共享数据</h4><p>用户登录重构：Login.vue中，登录成功后，需要更新服务端传来的用户id和用户名</p>
<ul>
<li>注意resp包json数据的包含关系：第一层data是服务端的json数据中的data属性，第二层data表示服务端返回的Map数据，第三层是Map中的用户数据<ul>
<li>（服务端的写法在第六期已经完成了）</li>
</ul>
</li>
</ul>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">&lt;script setup&gt;</span><br><span class="line">import &#123; ref, reactive &#125; from &quot;vue&quot;;</span><br><span class="line">import request from &quot;../utils/request&quot;;</span><br><span class="line">import &#123; useRouter &#125; from &quot;vue-router&quot;;</span><br><span class="line">import &#123; defineUser &#125; from &quot;../store/userStore&quot;;</span><br><span class="line"></span><br><span class="line">const router = useRouter();</span><br><span class="line">let sysUser = defineUser();</span><br><span class="line"></span><br><span class="line">const loginUser = reactive(&#123;</span><br><span class="line">  username: &quot;&quot;,</span><br><span class="line">  userPwd: &quot;&quot;,</span><br><span class="line">&#125;);</span><br><span class="line"></span><br><span class="line">let usernameMsg = ref(&quot;&quot;);</span><br><span class="line">let userPwdMsg = ref(&quot;&quot;);</span><br><span class="line"></span><br><span class="line">function checkUsername() &#123; /* 略 */ &#125;</span><br><span class="line"></span><br><span class="line">function checkUserPwd() &#123; /* 略 */ &#125;</span><br><span class="line"></span><br><span class="line">async function login() &#123;</span><br><span class="line">  // 校验表单格式</span><br><span class="line">  let flag1 = checkUsername();</span><br><span class="line">  let flag2 = checkUserPwd();</span><br><span class="line">  if (!(flag1 &amp;&amp; flag2)) &#123;</span><br><span class="line">    alert(&quot;请检查输入格式!&quot;);</span><br><span class="line">    return;</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  let &#123; data &#125; = await request.post(&quot;/user/login&quot;, loginUser);</span><br><span class="line">  if (data.code === 200) &#123;</span><br><span class="line">    alert(&quot;登录成功!&quot;);</span><br><span class="line"></span><br><span class="line">    console.log(data);</span><br><span class="line">    // 从服务端返回的用户数据data，更新到pinia（sysUser）中</span><br><span class="line">    // 注：第一层data是服务端的json数据中的data属性，第二层data表示服务端返回的Map数据，第三层是Map中的用户数据</span><br><span class="line">    sysUser.uid = data.data.loginUser.uid;</span><br><span class="line">    sysUser.username = data.data.loginUser.username;</span><br><span class="line"></span><br><span class="line">    router.push(&quot;/showSchedule&quot;);</span><br><span class="line">  &#125; else if (data.code === 501) &#123;</span><br><span class="line">    alert(&quot;用户名错误!&quot;);</span><br><span class="line">  &#125; else if (data.code === 503) &#123;</span><br><span class="line">    alert(&quot;密码错误!&quot;);</span><br><span class="line">  &#125; else &#123;</span><br><span class="line">    alert(&quot;未知错误!&quot;);</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line">&lt;/script&gt;</span><br><span class="line"></span><br><span class="line">&lt;template&gt;</span><br><span class="line">  &lt;div&gt;</span><br><span class="line">    &lt;h3 class=&quot;ht&quot;&gt;请登录&lt;/h3&gt;</span><br><span class="line">    &lt;table class=&quot;tab&quot; cellspacing=&quot;0px&quot;&gt;</span><br><span class="line">      &lt;tr class=&quot;ltr&quot;&gt;</span><br><span class="line">        &lt;td&gt;请输入账号&lt;/td&gt;</span><br><span class="line">        &lt;td&gt;</span><br><span class="line">          &lt;input</span><br><span class="line">            class=&quot;ipt&quot;</span><br><span class="line">            type=&quot;text&quot;</span><br><span class="line">            v-model=&quot;loginUser.username&quot;</span><br><span class="line">            @blur=&quot;checkUsername()&quot;</span><br><span class="line">          /&gt;</span><br><span class="line">          &lt;span id=&quot;usernameMsg&quot; v-text=&quot;usernameMsg&quot;&gt;&lt;/span&gt;</span><br><span class="line">        &lt;/td&gt;</span><br><span class="line">      &lt;/tr&gt;</span><br><span class="line">      &lt;tr class=&quot;ltr&quot;&gt;</span><br><span class="line">        &lt;td&gt;请输入密码&lt;/td&gt;</span><br><span class="line">        &lt;td&gt;</span><br><span class="line">          &lt;input</span><br><span class="line">            class=&quot;ipt&quot;</span><br><span class="line">            type=&quot;password&quot;</span><br><span class="line">            v-model=&quot;loginUser.userPwd&quot;</span><br><span class="line">            @blur=&quot;checkUserPwd()&quot;</span><br><span class="line">          /&gt;</span><br><span class="line">          &lt;span id=&quot;userPwdMsg&quot; v-text=&quot;userPwdMsg&quot;&gt;&lt;/span&gt;</span><br><span class="line">        &lt;/td&gt;</span><br><span class="line">      &lt;/tr&gt;</span><br><span class="line">      &lt;tr class=&quot;ltr&quot;&gt;</span><br><span class="line">        &lt;td colspan=&quot;2&quot; class=&quot;buttonContainer&quot;&gt;</span><br><span class="line">          &lt;input class=&quot;btn1&quot; type=&quot;button&quot; @click=&quot;login()&quot; value=&quot;登录&quot; /&gt;</span><br><span class="line">          &lt;input class=&quot;btn1&quot; type=&quot;button&quot; value=&quot;重置&quot; /&gt;</span><br><span class="line">          &lt;router-link to=&quot;/regist&quot;&gt;</span><br><span class="line">            &lt;button class=&quot;btn1&quot;&gt;去注册&lt;/button&gt;</span><br><span class="line">          &lt;/router-link&gt;</span><br><span class="line">        &lt;/td&gt;</span><br><span class="line">      &lt;/tr&gt;</span><br><span class="line">    &lt;/table&gt;</span><br><span class="line">  &lt;/div&gt;</span><br><span class="line">&lt;/template&gt;</span><br><span class="line"></span><br><span class="line">&lt;style scoped&gt;</span><br><span class="line">	/* 略 */</span><br><span class="line">&lt;/style&gt;</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<h4 id="12-1-4-登录访问控制"><a href="#12-1-4-登录访问控制" class="headerlink" title="12.1.4 登录访问控制"></a>12.1.4 登录访问控制</h4><p>登录权限控制：接下来要控制用户只有在登录状态下才能进去showSchedule.vue界面，通过路由守卫实现，路由中定义：</p>
<figure class="highlight js"><table><tr><td class="code"><pre><span class="line"><span class="keyword">import</span> &#123; createRouter, createWebHistory &#125; <span class="keyword">from</span> <span class="string">&#x27;vue-router&#x27;</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> <span class="title class_">Header</span> <span class="keyword">from</span> <span class="string">&#x27;../components/Header.vue&#x27;</span>;</span><br><span class="line"><span class="keyword">import</span> <span class="title class_">Regist</span> <span class="keyword">from</span> <span class="string">&#x27;../components/Regist.vue&#x27;</span>;</span><br><span class="line"><span class="keyword">import</span> <span class="title class_">Login</span> <span class="keyword">from</span> <span class="string">&#x27;../components/Login.vue&#x27;</span>;</span><br><span class="line"><span class="keyword">import</span> <span class="title class_">ShowSchedule</span> <span class="keyword">from</span> <span class="string">&#x27;../components/ShowSchedule.vue&#x27;</span>;</span><br><span class="line"></span><br><span class="line"><span class="comment">// router中导入pinia的时候，需要在defineUser中加入pinia对象</span></span><br><span class="line"><span class="keyword">import</span> pinia <span class="keyword">from</span> <span class="string">&#x27;../pinia.js&#x27;</span>;</span><br><span class="line"><span class="keyword">import</span> &#123; defineUser &#125; <span class="keyword">from</span> <span class="string">&#x27;../store/userStore.js&#x27;</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">let</span> sysUser = <span class="title function_">defineUser</span>(pinia);</span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> router = <span class="title function_">createRouter</span>( <span class="comment">/* 略 */</span> );</span><br><span class="line"></span><br><span class="line"><span class="comment">// 加入路由全局前置守卫判断能否访问showSchedule页面</span></span><br><span class="line"><span class="comment">// 注意还有默认情况下如果要跳转showSchedule页面，可以用重定向来解决</span></span><br><span class="line">router.<span class="title function_">beforeEach</span>(<span class="function">(<span class="params">to, <span class="keyword">from</span>, next</span>) =&gt;</span> &#123;</span><br><span class="line">    <span class="keyword">if</span> (to.<span class="property">path</span> === <span class="string">&#x27;/showSchedule&#x27;</span>) &#123;</span><br><span class="line">        <span class="comment">// 登录就放行，没登录就回到登录页</span></span><br><span class="line">        <span class="keyword">if</span> (sysUser.<span class="property">username</span> === <span class="string">&#x27;&#x27;</span>) &#123;</span><br><span class="line">            <span class="title function_">next</span>(<span class="string">&#x27;/login&#x27;</span>);</span><br><span class="line">        &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">            <span class="title function_">next</span>();</span><br><span class="line">        &#125;</span><br><span class="line">    &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">        <span class="title function_">next</span>();</span><br><span class="line">    &#125;</span><br><span class="line">&#125;);</span><br><span class="line"></span><br><span class="line"><span class="keyword">export</span> <span class="keyword">default</span> router;</span><br></pre></td></tr></table></figure>



<h3 id="12-2-实现显示日程数据"><a href="#12-2-实现显示日程数据" class="headerlink" title="12.2 实现显示日程数据"></a>12.2 实现显示日程数据</h3><p><img src="/img/loading.gif" data-original="https://yuezi-1308313119.cos.ap-guangzhou.myqcloud.com/typora-user-images%2Fimage-20241003212750574.png" alt="image-20241003212750574">	</p>
<h4 id="12-2-1-前端"><a href="#12-2-1-前端" class="headerlink" title="12.2.1 前端"></a>12.2.1 前端</h4><p>前端页面showSchedule.vue</p>
<ul>
<li>js部分，主要是定义增addItem、删removeItem、改updateItem、查showSchedule的操作，并向相关后端api发起请求<ul>
<li>参数的主键sid传参：调用Pinia的共享数据，通过前端传来的index下标得到日程对象，进而得到sid</li>
</ul>
</li>
<li>html部分就是负责将js接收到的数据渲染上去，使用v-for遍历数组即可</li>
</ul>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">&lt;script setup&gt;</span><br><span class="line">    /* 导入pinia数据 */</span><br><span class="line">    import &#123; defineUser &#125; from &#x27;../store/userStore&#x27;;</span><br><span class="line">    import &#123; defineSchedle &#125; from &#x27;../store/scheduleStore&#x27;;</span><br><span class="line">    import &#123; onMounted, onUpdated, ref, reactive &#125; from &#x27;vue&#x27;;</span><br><span class="line">    import request from &#x27;../utils/request&#x27;;</span><br><span class="line"></span><br><span class="line">    let sysUser = defineUser();</span><br><span class="line">    let sysSchedule = defineSchedle();</span><br><span class="line"></span><br><span class="line">    // 挂载完毕后 应当立刻查询当前用户所有日程信息，赋值给pinia</span><br><span class="line">    onMounted(() =&gt; &#123;</span><br><span class="line">        // 发送异步请求，获得当前用户所有的日程记录，可以把该功能封装成一个方法，后续可能会反复复用</span><br><span class="line">        showSchedule();</span><br><span class="line">        </span><br><span class="line">    &#125;);</span><br><span class="line"></span><br><span class="line">    async function showSchedule() &#123;</span><br><span class="line">        // 发送异步请求，获取所有日程记录</span><br><span class="line">        let &#123;data&#125; = await request.get(&#x27;schedule/findAllSchedule&#x27;, &#123;params: &#123;&quot;uid&quot;: sysUser.uid&#125;&#125;);</span><br><span class="line">        sysSchedule.itemList = data.data.itemList;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    // 为当前用户增加默认日程记录</span><br><span class="line">    async function addItem() &#123;</span><br><span class="line">        let &#123;data&#125; = await request.get(&#x27;schedule/addDefaultSchedule&#x27;, &#123;params: &#123;&quot;uid&quot;: sysUser.uid&#125;&#125;);</span><br><span class="line">        if (data.code === 200) &#123;</span><br><span class="line">            // 增加成功 刷新页面数据</span><br><span class="line">            showSchedule();</span><br><span class="line">        &#125; else &#123;</span><br><span class="line">            // 增加失败，alert提示</span><br><span class="line">            alert(&quot;增加失败&quot;);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    async function updateItem(index) &#123;</span><br><span class="line">        // 找到要修改的日程记录，发送给服务端，更新进入数据库即可</span><br><span class="line">        let &#123;data&#125; = await request.post(&#x27;schedule/updateSchedule&#x27;, sysSchedule.itemList[index]);</span><br><span class="line">        if (data.code === 200) &#123;</span><br><span class="line">            showSchedule();</span><br><span class="line">            alert(&quot;更新成功&quot;);</span><br><span class="line">        &#125; else &#123;</span><br><span class="line">            alert(&quot;更新失败&quot;);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    async function removeItem(index) &#123;</span><br><span class="line">        let sid = sysSchedule.itemList[index].sid;</span><br><span class="line">        let &#123;data&#125; = await request.get(`schedule/removeSchedule`, &#123;params: &#123;&quot;sid&quot;: sid&#125;&#125;);</span><br><span class="line">        if (data.code === 200) &#123;</span><br><span class="line">            showSchedule();</span><br><span class="line">            alert(&quot;删除成功&quot;);</span><br><span class="line">        &#125; else &#123;</span><br><span class="line">            alert(&quot;删除失败&quot;);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">&lt;/script&gt;</span><br><span class="line"></span><br><span class="line">&lt;template&gt;</span><br><span class="line">  &lt;div&gt;</span><br><span class="line">    &lt;h3 class=&quot;ht&quot;&gt;您的日程如下&lt;/h3&gt;</span><br><span class="line">&lt;table class=&quot;tab&quot; cellspacing=&quot;0px&quot;&gt;</span><br><span class="line">    &lt;tr class=&quot;ltr&quot;&gt;</span><br><span class="line">        &lt;th&gt;编号&lt;/th&gt;</span><br><span class="line">        &lt;th&gt;内容&lt;/th&gt;</span><br><span class="line">        &lt;th&gt;进度&lt;/th&gt;</span><br><span class="line">        &lt;th&gt;操作&lt;/th&gt;</span><br><span class="line">    &lt;/tr&gt;</span><br><span class="line">    &lt;tr class=&quot;ltr&quot; v-for=&quot;(item, index) in sysSchedule.itemList&quot; :key=&quot;index&quot;&gt;</span><br><span class="line">        &lt;td v-text=&quot;index+1&quot;&gt;&lt;/td&gt;</span><br><span class="line">        &lt;td&gt;</span><br><span class="line">            &lt;input type=&quot;text&quot; v-model=&quot;item.title&quot;&gt;</span><br><span class="line">        &lt;/td&gt;</span><br><span class="line">        &lt;td&gt;</span><br><span class="line">            &lt;input type=&quot;radio&quot; value=&quot;1&quot; v-model=&quot;item.completed&quot;&gt;已完成</span><br><span class="line">            &lt;input type=&quot;radio&quot; value=&quot;0&quot; v-model=&quot;item.completed&quot;&gt;未完成</span><br><span class="line">        &lt;/td&gt;</span><br><span class="line">        &lt;td class=&quot;buttonContainer&quot;&gt;</span><br><span class="line">            &lt;button class=&quot;btn1&quot; @click=&quot;updateItem(index)&quot;&gt;保存&lt;/button&gt;</span><br><span class="line">            &lt;button class=&quot;btn1&quot; @click=&quot;removeItem(index)&quot;&gt;删除&lt;/button&gt;</span><br><span class="line">        &lt;/td&gt;</span><br><span class="line">    &lt;/tr&gt;</span><br><span class="line">    &lt;tr class=&quot;ltr buttonContainer&quot; &gt;</span><br><span class="line">        &lt;td colspan=&quot;4&quot;&gt;</span><br><span class="line">            &lt;button class=&quot;btn1&quot; @click=&quot;addItem()&quot;&gt;新增日程&lt;/button&gt;</span><br><span class="line">        &lt;/td&gt;</span><br><span class="line"></span><br><span class="line">    &lt;/tr&gt;</span><br><span class="line">&lt;/table&gt;</span><br><span class="line">  &lt;/div&gt;</span><br><span class="line">&lt;/template&gt;</span><br><span class="line"></span><br><span class="line">&lt;style scoped&gt;</span><br><span class="line"> /* 略 */</span><br><span class="line">&lt;/style&gt;</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<h4 id="12-2-2-后端"><a href="#12-2-2-后端" class="headerlink" title="12.2.2 后端"></a>12.2.2 后端</h4><p>接下来是后端，主要的调用关系：Controller - service(impl) - dao(impl) - baseDao</p>
<h5 id="Controller层"><a href="#Controller层" class="headerlink" title="Controller层"></a>Controller层</h5><p>SysScheduleController中查询数据并响应json</p>
<ul>
<li>注意一点：查到的所有日程列表，我们习惯在外面套一层<code>map对象</code>传给客户端，便于后续拓展</li>
</ul>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="keyword">package</span> com.atguigu.schedule.controller;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> com.atguigu.schedule.common.Result;</span><br><span class="line"><span class="keyword">import</span> com.atguigu.schedule.pojo.SysSchedule;</span><br><span class="line"><span class="keyword">import</span> com.atguigu.schedule.service.SysScheduleService;</span><br><span class="line"><span class="keyword">import</span> com.atguigu.schedule.service.impl.SysScheduleServiceImpl;</span><br><span class="line"><span class="keyword">import</span> com.atguigu.schedule.util.WebUtil;</span><br><span class="line"><span class="keyword">import</span> jakarta.servlet.ServletException;</span><br><span class="line"><span class="keyword">import</span> jakarta.servlet.annotation.WebServlet;</span><br><span class="line"><span class="keyword">import</span> jakarta.servlet.http.HttpServlet;</span><br><span class="line"><span class="keyword">import</span> jakarta.servlet.http.HttpServletRequest;</span><br><span class="line"><span class="keyword">import</span> jakarta.servlet.http.HttpServletResponse;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> java.io.IOException;</span><br><span class="line"><span class="keyword">import</span> java.lang.reflect.Method;</span><br><span class="line"><span class="keyword">import</span> java.util.HashMap;</span><br><span class="line"><span class="keyword">import</span> java.util.List;</span><br><span class="line"><span class="keyword">import</span> java.util.Map;</span><br><span class="line"></span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * 增加日程的请求 /schedule/add</span></span><br><span class="line"><span class="comment"> * 查询日程的请求 /schedule/find</span></span><br><span class="line"><span class="comment"> * 修改日程的请求 /schedule/update</span></span><br><span class="line"><span class="comment"> * 删除日程的请求 /schedule/remove</span></span><br><span class="line"><span class="comment"> *</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@author</span> yuezi2048</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@version</span> 1.0</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="meta">@WebServlet(&quot;/schedule/*&quot;)</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">SysScheduleController</span> <span class="keyword">extends</span> <span class="title class_">BaseController</span> &#123;</span><br><span class="line">    <span class="keyword">private</span> <span class="type">SysScheduleService</span> <span class="variable">scheduleService</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">SysScheduleServiceImpl</span>();</span><br><span class="line"></span><br><span class="line">    <span class="keyword">protected</span> <span class="keyword">void</span> <span class="title function_">removeSchedule</span><span class="params">(HttpServletRequest req, HttpServletResponse resp)</span> <span class="keyword">throws</span> ServletException, IOException &#123;</span><br><span class="line">        <span class="type">int</span> <span class="variable">sid</span> <span class="operator">=</span> Integer.parseInt(req.getParameter(<span class="string">&quot;sid&quot;</span>));</span><br><span class="line">        <span class="comment">// 调用service方法， 删除数据</span></span><br><span class="line">        scheduleService.removeSchedule(sid);</span><br><span class="line"></span><br><span class="line">        <span class="comment">// 响应数据，因为响应回去不管成没成功，都会刷新页面，由用户判定即可</span></span><br><span class="line">        WebUtil.writeJson(resp, Result.ok(<span class="literal">null</span>));</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">protected</span> <span class="keyword">void</span> <span class="title function_">updateSchedule</span><span class="params">(HttpServletRequest req, HttpServletResponse resp)</span> <span class="keyword">throws</span> ServletException, IOException &#123;</span><br><span class="line">        <span class="comment">// 接收请求体的JSON串，转换成SysSchedule对象</span></span><br><span class="line">        <span class="type">SysSchedule</span> <span class="variable">schedule</span> <span class="operator">=</span> WebUtil.readJson(req, SysSchedule.class);</span><br><span class="line">        <span class="comment">// 更新到数据库</span></span><br><span class="line">        scheduleService.updateSchedule(schedule);</span><br><span class="line"></span><br><span class="line">        <span class="comment">// 更新完后响应成功</span></span><br><span class="line">        WebUtil.writeJson(resp, Result.ok(<span class="literal">null</span>));</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">protected</span> <span class="keyword">void</span> <span class="title function_">addDefaultSchedule</span><span class="params">(HttpServletRequest req, HttpServletResponse resp)</span> <span class="keyword">throws</span> ServletException, IOException &#123;</span><br><span class="line">        <span class="comment">// 接收请求中的uid参数</span></span><br><span class="line">        <span class="type">int</span> <span class="variable">uid</span> <span class="operator">=</span> Integer.parseInt(req.getParameter(<span class="string">&quot;uid&quot;</span>));</span><br><span class="line"></span><br><span class="line">        <span class="comment">// 调用服务层方法，向数据库增加一条空记录</span></span><br><span class="line">        scheduleService.addDefault(uid);</span><br><span class="line"></span><br><span class="line">        <span class="comment">// 响应结果</span></span><br><span class="line">        WebUtil.writeJson(resp, Result.ok(<span class="literal">null</span>));</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">protected</span> <span class="keyword">void</span> <span class="title function_">findAllSchedule</span><span class="params">(HttpServletRequest req, HttpServletResponse resp)</span> <span class="keyword">throws</span> ServletException, IOException &#123;</span><br><span class="line">        <span class="comment">// 接收请求中的uid参数</span></span><br><span class="line">        <span class="type">int</span> <span class="variable">uid</span> <span class="operator">=</span> Integer.parseInt(req.getParameter(<span class="string">&quot;uid&quot;</span>));</span><br><span class="line"></span><br><span class="line">        <span class="comment">// 查询用户的所有日程</span></span><br><span class="line">        List&lt;SysSchedule&gt; itemList = scheduleService.findItemListByUid(uid);</span><br><span class="line"></span><br><span class="line">        <span class="comment">// 将用户的所有日程放入res对象(为了以后拓展，习惯是发出去map)</span></span><br><span class="line">        Map&lt;String, Object&gt; data = <span class="keyword">new</span> <span class="title class_">HashMap</span>&lt;&gt;();</span><br><span class="line">        data.put(<span class="string">&quot;itemList&quot;</span>, itemList);</span><br><span class="line">        Result&lt;Map&lt;String, Object&gt;&gt; result = Result.ok(data);</span><br><span class="line"></span><br><span class="line">        <span class="comment">// res对象转换为JSON响应给客户端</span></span><br><span class="line">        WebUtil.writeJson(resp, result);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<h5 id="Service层"><a href="#Service层" class="headerlink" title="Service层"></a>Service层</h5><p>接下来定义SysScheduleService接口</p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="keyword">interface</span> <span class="title class_">SysScheduleService</span> &#123;</span><br><span class="line">    List&lt;SysSchedule&gt; <span class="title function_">findItemListByUid</span><span class="params">(<span class="type">int</span> uid)</span>;</span><br><span class="line"></span><br><span class="line">    Integer <span class="title function_">addDefault</span><span class="params">(<span class="type">int</span> uid)</span>;</span><br><span class="line"></span><br><span class="line">    Integer <span class="title function_">updateSchedule</span><span class="params">(SysSchedule schedule)</span>;</span><br><span class="line"></span><br><span class="line">    Integer <span class="title function_">removeSchedule</span><span class="params">(<span class="type">int</span> sid)</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<p>service实现类：没有具体的业务，只有查询工作，交给Dao层实现</p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">SysScheduleServiceImpl</span> <span class="keyword">implements</span> <span class="title class_">SysScheduleService</span> &#123;</span><br><span class="line">    <span class="keyword">private</span> <span class="type">SysScheduleDao</span> <span class="variable">sysScheduleDao</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">SysScheduleDaoImpl</span>();</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="keyword">public</span> List&lt;SysSchedule&gt; <span class="title function_">findItemListByUid</span><span class="params">(<span class="type">int</span> uid)</span> &#123;</span><br><span class="line">        <span class="keyword">return</span> sysScheduleDao.findItemListByUid(uid);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="keyword">public</span> Integer <span class="title function_">addDefault</span><span class="params">(<span class="type">int</span> uid)</span> &#123;</span><br><span class="line">        <span class="keyword">return</span> sysScheduleDao.addDefault(uid);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="keyword">public</span> Integer <span class="title function_">updateSchedule</span><span class="params">(SysSchedule schedule)</span> &#123;</span><br><span class="line">        <span class="keyword">return</span> sysScheduleDao.updateSchedule(schedule);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="keyword">public</span> Integer <span class="title function_">removeSchedule</span><span class="params">(<span class="type">int</span> sid)</span> &#123;</span><br><span class="line">        <span class="keyword">return</span> sysScheduleDao.removeSchedule(sid);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<h5 id="Dao层"><a href="#Dao层" class="headerlink" title="Dao层"></a>Dao层</h5><p>最后追到数据库操作的Dao层</p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="keyword">interface</span> <span class="title class_">SysScheduleDao</span> &#123;</span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * 该方法用于向数据库中增加一条日程记录</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@param</span> schedule 日程数据以SysSchedule实体类对象形式入参</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@return</span> 增加成功返回影响数据库记录的行数，行数为0说明增加失败，行数&gt;0说明增加成功</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="type">int</span> <span class="title function_">addSchedule</span><span class="params">(SysSchedule schedule)</span>;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * 查询所有用户的所有日程</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@return</span> 将所有日程放入List集合中</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    List&lt;SysSchedule&gt; <span class="title function_">findAll</span><span class="params">()</span>;</span><br><span class="line"></span><br><span class="line">    List&lt;SysSchedule&gt; <span class="title function_">findItemListByUid</span><span class="params">(<span class="type">int</span> uid)</span>;</span><br><span class="line"></span><br><span class="line">    Integer <span class="title function_">addDefault</span><span class="params">(<span class="type">int</span> uid)</span>;</span><br><span class="line"></span><br><span class="line">    Integer <span class="title function_">updateSchedule</span><span class="params">(SysSchedule schedule)</span>;</span><br><span class="line"></span><br><span class="line">    Integer <span class="title function_">removeSchedule</span><span class="params">(<span class="type">int</span> sid)</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<p>Dao层实现类：又回归到数据库的crud上了</p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="keyword">package</span> com.atguigu.schedule.dao.impl;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> com.atguigu.schedule.dao.BaseDao;</span><br><span class="line"><span class="keyword">import</span> com.atguigu.schedule.dao.SysScheduleDao;</span><br><span class="line"><span class="keyword">import</span> com.atguigu.schedule.pojo.SysSchedule;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> java.util.List;</span><br><span class="line"></span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * 介绍一下当前类</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@author</span> yuezi2048</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@version</span> 1.0</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">SysScheduleDaoImpl</span> <span class="keyword">extends</span> <span class="title class_">BaseDao</span> <span class="keyword">implements</span> <span class="title class_">SysScheduleDao</span> &#123;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="keyword">public</span> <span class="type">int</span> <span class="title function_">addSchedule</span><span class="params">(SysSchedule schedule)</span> &#123;</span><br><span class="line">        <span class="type">String</span> <span class="variable">sql</span> <span class="operator">=</span> <span class="string">&quot;insert into sys_schedule(sid, uid, title, completed) values(?,?,?,?)&quot;</span>;</span><br><span class="line">        <span class="type">int</span> <span class="variable">rows</span> <span class="operator">=</span> baseUpdate(sql, schedule.getSid(), schedule.getUid(), schedule.getTitle(), schedule.getCompleted());</span><br><span class="line">        <span class="keyword">return</span> rows;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="keyword">public</span> List&lt;SysSchedule&gt; <span class="title function_">findAll</span><span class="params">()</span> &#123;</span><br><span class="line">        <span class="type">String</span> <span class="variable">sql</span> <span class="operator">=</span> <span class="string">&quot;select sid, uid, title, completed from sys_schedule&quot;</span>;</span><br><span class="line">        List&lt;SysSchedule&gt; sysSchedules = baseQuery(SysSchedule.class, sql);</span><br><span class="line">        <span class="keyword">return</span> sysSchedules;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="keyword">public</span> List&lt;SysSchedule&gt; <span class="title function_">findItemListByUid</span><span class="params">(<span class="type">int</span> uid)</span> &#123;</span><br><span class="line">        <span class="type">String</span> <span class="variable">sql</span> <span class="operator">=</span> <span class="string">&quot;select sid, uid, title, completed from sys_schedule where uid = ?&quot;</span>;</span><br><span class="line">        List&lt;SysSchedule&gt; itemList = baseQuery(SysSchedule.class, sql, uid);</span><br><span class="line">        <span class="keyword">return</span> itemList;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="keyword">public</span> Integer <span class="title function_">addDefault</span><span class="params">(<span class="type">int</span> uid)</span> &#123;</span><br><span class="line">        <span class="type">String</span> <span class="variable">sql</span> <span class="operator">=</span> <span class="string">&quot;insert into sys_schedule values (DEFAULT, ?, &#x27;请输入日程&#x27;, 0)&quot;</span>;</span><br><span class="line">        <span class="keyword">return</span> baseUpdate(sql, uid);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="keyword">public</span> Integer <span class="title function_">updateSchedule</span><span class="params">(SysSchedule schedule)</span> &#123;</span><br><span class="line">        <span class="type">String</span> <span class="variable">sql</span> <span class="operator">=</span> <span class="string">&quot;update sys_schedule set title = ?, completed = ? where sid = ?&quot;</span>;</span><br><span class="line">        <span class="keyword">return</span> baseUpdate(sql, schedule.getTitle(), schedule.getCompleted(), schedule.getSid());</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="keyword">public</span> Integer <span class="title function_">removeSchedule</span><span class="params">(<span class="type">int</span> sid)</span> &#123;</span><br><span class="line">        <span class="type">String</span> <span class="variable">sql</span> <span class="operator">=</span> <span class="string">&quot;delete from sys_schedule where sid = ?&quot;</span>;</span><br><span class="line">        <span class="keyword">return</span> baseUpdate(sql, sid);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h2 id="13-Elements-plus组件库"><a href="#13-Elements-plus组件库" class="headerlink" title="13. Elements-plus组件库"></a>13. Elements-plus组件库</h2><blockquote>
<p>Element Plus 是一套基于 Vue 3 的开源 UI 组件库，是由饿了么前端团队开发的升级版本 Element UI。Element Plus 提供了丰富的 UI 组件、易于使用的 API 接口和灵活的主题定制功能，可以帮助开发者快速构建高质量的 Web 应用程序。</p>
</blockquote>
<ul>
<li><p>Element Plus 支持按需加载，且不依赖于任何第三方 CSS 库，它可以轻松地集成到任何 Vue.js 项目中。Element Plus 的文档十分清晰，提供了各种组件的使用方法和示例代码，方便开发者快速上手。</p>
</li>
<li><p>Element Plus 目前已经推出了大量的常用 UI 组件，如按钮、表单、表格、对话框、选项卡等，此外还提供了一些高级组件，如日期选择器、时间选择器、级联选择器、滑块、颜色选择器等。这些组件具有一致的设计和可靠的代码质量，可以为开发者提供稳定的使用体验。</p>
</li>
<li><p>与 Element UI 相比，Element Plus 采用了现代化的技术架构和更加先进的设计理念，同时具备更好的性能和更好的兼容性。Element Plus 的更新迭代也更加频繁，可以为开发者提供更好的使用体验和更多的功能特性。</p>
</li>
<li><p>Element Plus 可以在支持 <a target="_blank" rel="noopener" href="https://caniuse.com/?feats=mdn-javascript_builtins_regexp_dotall,mdn-javascript_builtins_regexp_lookbehind_assertion,mdn-javascript_builtins_regexp_named_capture_groups,mdn-javascript_builtins_regexp_property_escapes,mdn-javascript_builtins_symbol_asynciterator,mdn-javascript_functions_method_definitions_async_generator_methods,mdn-javascript_grammar_template_literals_template_literal_revision,mdn-javascript_operators_destructuring_rest_in_objects,mdn-javascript_operators_spread_spread_in_destructuring,promise-finally" title="ES2018">ES2018</a> 和 <a target="_blank" rel="noopener" href="https://caniuse.com/resizeobserver" title="ResizeObserver">ResizeObserver</a> 的浏览器上运行。 如果您确实需要支持旧版本的浏览器，请自行添加 <a target="_blank" rel="noopener" href="https://babeljs.io/" title="Babel">Babel</a> 和相应的 Polyfill </p>
</li>
<li><p>官网<a target="_blank" rel="noopener" href="https://element-plus.org/zh-CN/component/overview.html">https://element-plus.org/zh-CN/component/overview.html</a></p>
</li>
<li><p>由于 Vue 3 不再支持 IE11，Element Plus 也不再支持 IE 浏览器。</p>
</li>
</ul>
<p><img src="/img/loading.gif" data-original="https://yuezi-1308313119.cos.ap-guangzhou.myqcloud.com/typora-user-images%2Fimage-20241003214853370.png" alt="image-20241003214853370">	</p>
<p>安装Elements-plus</p>
<figure class="highlight shell"><table><tr><td class="code"><pre><span class="line">npm install element-plus</span><br></pre></td></tr></table></figure>

<p>在<code>main.ts</code>导入（需基于typeScript开发）</p>
<figure class="highlight js"><table><tr><td class="code"><pre><span class="line"><span class="keyword">import</span> &#123; createApp &#125; <span class="keyword">from</span> <span class="string">&#x27;vue&#x27;</span></span><br><span class="line"><span class="comment">//导入element-plus相关内容</span></span><br><span class="line"><span class="keyword">import</span> <span class="title class_">ElementPlus</span> <span class="keyword">from</span> <span class="string">&#x27;element-plus&#x27;</span></span><br><span class="line"><span class="keyword">import</span> <span class="string">&#x27;element-plus/dist/index.css&#x27;</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> <span class="title class_">App</span> <span class="keyword">from</span> <span class="string">&#x27;./App.vue&#x27;</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> app = <span class="title function_">createApp</span>(<span class="title class_">App</span>)</span><br><span class="line"></span><br><span class="line">app.<span class="title function_">use</span>(<span class="title class_">ElementPlus</span>)</span><br><span class="line">app.<span class="title function_">mount</span>(<span class="string">&#x27;#app&#x27;</span>)</span><br></pre></td></tr></table></figure>

<p>入门案例</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">&lt;script lang=&quot;ts&quot; setup&gt;</span><br><span class="line">import &#123;</span><br><span class="line">  Check,</span><br><span class="line">  Delete,</span><br><span class="line">  Edit,</span><br><span class="line">  Message,</span><br><span class="line">  Search,</span><br><span class="line">  Star,</span><br><span class="line">&#125; from &quot;@element-plus/icons-vue&quot;;</span><br><span class="line"></span><br><span class="line">interface User &#123;</span><br><span class="line">  date: string</span><br><span class="line">  name: string</span><br><span class="line">  address: string</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">const tableRowClassName = (&#123;</span><br><span class="line">  row,</span><br><span class="line">  rowIndex,</span><br><span class="line">&#125;: &#123;</span><br><span class="line">  row: User</span><br><span class="line">  rowIndex: number</span><br><span class="line">&#125;) =&gt; &#123;</span><br><span class="line">  if (rowIndex === 1) &#123;</span><br><span class="line">    return &#x27;warning-row&#x27;</span><br><span class="line">  &#125; else if (rowIndex === 3) &#123;</span><br><span class="line">    return &#x27;success-row&#x27;</span><br><span class="line">  &#125;</span><br><span class="line">  return &#x27;&#x27;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">const tableData: User[] = [</span><br><span class="line">  &#123;</span><br><span class="line">    date: &#x27;2016-05-03&#x27;,</span><br><span class="line">    name: &#x27;Tom&#x27;,</span><br><span class="line">    address: &#x27;No. 189, Grove St, Los Angeles&#x27;,</span><br><span class="line">  &#125;,</span><br><span class="line">  &#123;</span><br><span class="line">    date: &#x27;2016-05-02&#x27;,</span><br><span class="line">    name: &#x27;Tom&#x27;,</span><br><span class="line">    address: &#x27;No. 189, Grove St, Los Angeles&#x27;,</span><br><span class="line">  &#125;,</span><br><span class="line">  &#123;</span><br><span class="line">    date: &#x27;2016-05-04&#x27;,</span><br><span class="line">    name: &#x27;Tom&#x27;,</span><br><span class="line">    address: &#x27;No. 189, Grove St, Los Angeles&#x27;,</span><br><span class="line">  &#125;,</span><br><span class="line">  &#123;</span><br><span class="line">    date: &#x27;2016-05-01&#x27;,</span><br><span class="line">    name: &#x27;Tom&#x27;,</span><br><span class="line">    address: &#x27;No. 189, Grove St, Los Angeles&#x27;,</span><br><span class="line">  &#125;,</span><br><span class="line">]</span><br><span class="line">&lt;/script&gt;</span><br><span class="line"></span><br><span class="line">&lt;template&gt;</span><br><span class="line">  &lt;div&gt;</span><br><span class="line">    &lt;div class=&quot;mb-4&quot;&gt;</span><br><span class="line">      &lt;el-button&gt;Default&lt;/el-button&gt;</span><br><span class="line">      &lt;el-button type=&quot;primary&quot;&gt;Primary&lt;/el-button&gt;</span><br><span class="line">      &lt;el-button type=&quot;success&quot;&gt;Success&lt;/el-button&gt;</span><br><span class="line">      &lt;el-button type=&quot;info&quot;&gt;Info&lt;/el-button&gt;</span><br><span class="line">      &lt;el-button type=&quot;warning&quot;&gt;Warning&lt;/el-button&gt;</span><br><span class="line">      &lt;el-button type=&quot;danger&quot;&gt;Danger&lt;/el-button&gt;</span><br><span class="line">    &lt;/div&gt;</span><br><span class="line"></span><br><span class="line">    &lt;div class=&quot;mb-4&quot;&gt;</span><br><span class="line">      &lt;el-button plain&gt;Plain&lt;/el-button&gt;</span><br><span class="line">      &lt;el-button type=&quot;primary&quot; plain&gt;Primary&lt;/el-button&gt;</span><br><span class="line">      &lt;el-button type=&quot;success&quot; plain&gt;Success&lt;/el-button&gt;</span><br><span class="line">      &lt;el-button type=&quot;info&quot; plain&gt;Info&lt;/el-button&gt;</span><br><span class="line">      &lt;el-button type=&quot;warning&quot; plain&gt;Warning&lt;/el-button&gt;</span><br><span class="line">      &lt;el-button type=&quot;danger&quot; plain&gt;Danger&lt;/el-button&gt;</span><br><span class="line">    &lt;/div&gt;</span><br><span class="line"></span><br><span class="line">    &lt;div class=&quot;mb-4&quot;&gt;</span><br><span class="line">      &lt;el-button round&gt;Round&lt;/el-button&gt;</span><br><span class="line">      &lt;el-button type=&quot;primary&quot; round&gt;Primary&lt;/el-button&gt;</span><br><span class="line">      &lt;el-button type=&quot;success&quot; round&gt;Success&lt;/el-button&gt;</span><br><span class="line">      &lt;el-button type=&quot;info&quot; round&gt;Info&lt;/el-button&gt;</span><br><span class="line">      &lt;el-button type=&quot;warning&quot; round&gt;Warning&lt;/el-button&gt;</span><br><span class="line">      &lt;el-button type=&quot;danger&quot; round&gt;Danger&lt;/el-button&gt;</span><br><span class="line">    &lt;/div&gt;</span><br><span class="line"></span><br><span class="line">    &lt;div&gt;</span><br><span class="line">      &lt;el-button :icon=&quot;Search&quot; circle /&gt;</span><br><span class="line">      &lt;el-button type=&quot;primary&quot; :icon=&quot;Edit&quot; circle /&gt;</span><br><span class="line">      &lt;el-button type=&quot;success&quot; :icon=&quot;Check&quot; circle /&gt;</span><br><span class="line">      &lt;el-button type=&quot;info&quot; :icon=&quot;Message&quot; circle /&gt;</span><br><span class="line">      &lt;el-button type=&quot;warning&quot; :icon=&quot;Star&quot; circle /&gt;</span><br><span class="line">      &lt;el-button type=&quot;danger&quot; :icon=&quot;Delete&quot; circle /&gt;</span><br><span class="line">    &lt;/div&gt;</span><br><span class="line"></span><br><span class="line">    &lt;hr&gt;</span><br><span class="line"></span><br><span class="line">    &lt;el-table</span><br><span class="line">      :data=&quot;tableData&quot;</span><br><span class="line">      style=&quot;width: 100%&quot;</span><br><span class="line">      :row-class-name=&quot;tableRowClassName&quot;</span><br><span class="line">    &gt;</span><br><span class="line">      &lt;el-table-column prop=&quot;date&quot; label=&quot;Date&quot; width=&quot;180&quot; /&gt;</span><br><span class="line">      &lt;el-table-column prop=&quot;name&quot; label=&quot;Name&quot; width=&quot;180&quot; /&gt;</span><br><span class="line">      &lt;el-table-column prop=&quot;address&quot; label=&quot;Address&quot; /&gt;</span><br><span class="line">    &lt;/el-table&gt;</span><br><span class="line"></span><br><span class="line">  &lt;el-pagination background layout=&quot;prev, pager, next&quot; :total=&quot;1000&quot; /&gt;</span><br><span class="line">  &lt;/div&gt;</span><br><span class="line">&lt;/template&gt;</span><br><span class="line"></span><br><span class="line">&lt;style scoped&gt;</span><br><span class="line">.el-table .warning-row &#123;</span><br><span class="line">  --el-table-tr-bg-color: var(--el-color-warning-light-9);</span><br><span class="line">&#125;</span><br><span class="line">.el-table .success-row &#123;</span><br><span class="line">  --el-table-tr-bg-color: var(--el-color-success-light-9);</span><br><span class="line">&#125;</span><br><span class="line">&lt;/style&gt;</span><br></pre></td></tr></table></figure>



<p>实现效果</p>
<img src="/img/loading.gif" data-original="https://yuezi-1308313119.cos.ap-guangzhou.myqcloud.com/typora-user-images%2Fimage-20241003214654774.png" alt="image-20241003214654774" style="zoom:80%;" /></article><div class="post-copyright"><div class="post-copyright__author"><span class="post-copyright-meta"><i class="fas fa-circle-user fa-fw"></i>文章作者: </span><span class="post-copyright-info"><a href="https://yuezi2048.github.io">yuezi</a></span></div><div class="post-copyright__type"><span class="post-copyright-meta"><i class="fas fa-square-arrow-up-right fa-fw"></i>文章链接: </span><span class="post-copyright-info"><a href="https://yuezi2048.github.io/2024/10/03/2.Areas%F0%9F%8C%90/back-end-java/4.JavaWeb/9.%E5%89%8D%E7%AB%AF%E5%B7%A5%E7%A8%8B%E5%8C%96%E4%B8%8B%E7%AF%87_%E6%95%B0%E6%8D%AE%E8%AF%B7%E6%B1%82_%E7%8A%B6%E6%80%81%E7%AE%A1%E7%90%86/">https://yuezi2048.github.io/2024/10/03/2.Areas🌐/back-end-java/4.JavaWeb/9.前端工程化下篇_数据请求_状态管理/</a></span></div><div class="post-copyright__notice"><span class="post-copyright-meta"><i class="fas fa-circle-exclamation fa-fw"></i>版权声明: </span><span class="post-copyright-info">本博客所有文章除特别声明外，均采用 <a href="https://creativecommons.org/licenses/by-nc-sa/4.0/" target="_blank">CC BY-NC-SA 4.0</a> 许可协议。转载请注明来源 <a href="https://yuezi2048.github.io" target="_blank">yuezi</a>！</span></div></div><div class="tag_share"><div class="post-meta__tag-list"><a class="post-meta__tags" href="/tags/4-JavaWeb/">4.JavaWeb</a></div><div class="post-share"><div class="social-share" data-image="/img/touxiang.jpg" data-sites="qq,wechat"></div><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/butterfly-extsrc/sharejs/dist/css/share.min.css" media="print" onload="this.media='all'"><script src="https://cdn.jsdelivr.net/npm/butterfly-extsrc/sharejs/dist/js/social-share.min.js" defer></script></div></div><nav class="pagination-post" id="pagination"><a class="pagination-related" href="/2024/10/02/2.Areas%F0%9F%8C%90/back-end-java/4.JavaWeb/5.%20Servlet/" title="5. Servlet"><div class="cover" style="background: var(--default-bg-color)"></div><div class="info"><div class="info-1"><div class="info-item-1">上一篇</div><div class="info-item-2">5. Servlet</div></div><div class="info-2"><div class="info-item-1">第五章 Servlet1. Servlet简介首先明确动态资源和静态资源的概念（买蛋糕的例子，现有和现做的区别） 静态资源：无需通过代码运行生成的资源，即在运行前就写好的资源，包括前端三大件、img等多媒体文件 动态资源：需要通过代码运行生成的资源，即程序运行前无法确定的数据，需要运行时动态生成，包括Servlet、Thymeleaf  注：动态资源是强调运行时动态生成数据，而不是视图上的动画效果或者是简单的人机交互效果  接下来引出我们的动态资源——Servlet  Servlet（Server...</div></div></div></a><a class="pagination-related" href="/2024/10/03/2.Areas%F0%9F%8C%90/back-end-java/4.JavaWeb/8.%E5%89%8D%E7%AB%AF%E5%B7%A5%E7%A8%8B%E5%8C%96%E4%B8%AD%E7%AF%87_Vue3%E6%A0%B8%E5%BF%83%E6%8A%80%E6%9C%AF/" title="8.前端工程化中篇_Vue3核心技术"><div class="cover" style="background: var(--default-bg-color)"></div><div class="info text-right"><div class="info-1"><div class="info-item-1">下一篇</div><div class="info-item-2">8.前端工程化中篇_Vue3核心技术</div></div><div class="info-2"><div class="info-item-1">6. Vue3视图渲染技术6.1 html——模板语法 Vue 使用一种基于 HTML 的模板语法，使我们能够声明式地将其组件实例的数据绑定到呈现的 DOM 上。 所有的 Vue 模板都是语法层面合法的 HTML，可以被符合规范的浏览器和 HTML 解析器解析。 在底层机制中，Vue 会将模板编译成高度优化的 JavaScript 代码。 结合响应式系统，当应用状态变更时，Vue 能够智能地推导出需要重新渲染的组件的最少数量，并应用最少的 DOM 操作。  6.1.1 插值表达式 插值表达式:最基本的数据绑定形式是文本插值，它使用的是“Mustache”语法 ,即双大括号   插值表达式不依赖绝对标签，位置自由 插值表达式支持的语法 支持javascript的运算表达式 支持函数的调用    &lt;script setup&gt;  /*    插值表达式, 语法：&#123;&#123; 数据名称 / 函数 / API &#125;&#125;    插值表达式不依赖于标签  */  // 定义一些常见的数据  let msg = &quot;Hello&quot;; ...</div></div></div></a></nav><div class="relatedPosts"><div class="headline"><i class="fas fa-thumbs-up fa-fw"></i><span>相关推荐</span></div><div class="relatedPosts-list"><a class="pagination-related" href="/2024/09/01/2.Areas%F0%9F%8C%90/back-end-java/4.JavaWeb/1.%20JavaWeb%E6%A6%82%E8%BF%B0/" title="1. JavaWeb概述"><div class="cover" style="background: var(--default-bg-color)"></div><div class="info text-center"><div class="info-1"><div class="info-item-1"><i class="far fa-calendar-alt fa-fw"></i> 2024-09-01</div><div class="info-item-2">1. JavaWeb概述</div></div><div class="info-2"><div class="info-item-1">第一章 Web概述1.1 JavaWeb是什么 通过Java技术解决Web互联网领域的技术栈（使用JavaEE技术开发企业级互联网项目，项目规模和架构模式和JavaSE有很大区别） 客户-服务器模式 客户端：与用户交互，接收用户的输入，向服务器发送数据并返回服务器输出的数据 服务器：从硬件和软件两个方面描述(广义和狭义) 硬件上，是比普通计算机运行更快 负载更高 价格更贵，一般是网络中的大型客户机提供计算服务 软件上，是安装在计算机上的某个进程，根据不同的作用可以分为不同的服务器，如DNS redis ftp服务器等     应用 APP 微信小程序 PC端程序 PC浏览器 外设（小米音箱 电话手表 POS机等）    1.2 JavaWeb技术栈前端 HTML CSS JS ES6 Nodejs npm vite vue3 router pinia axios element-plus… 后端 HTTP xml Tomcat Servlet Request Response Cookie Session Filter Listener MySQL JDBC Druid...</div></div></div></a><a class="pagination-related" href="/2024/09/26/2.Areas%F0%9F%8C%90/back-end-java/4.JavaWeb/2.%20HTML_CSS/" title="2. HTML_CSS"><div class="cover" style="background: var(--default-bg-color)"></div><div class="info text-center"><div class="info-1"><div class="info-item-1"><i class="far fa-calendar-alt fa-fw"></i> 2024-09-26</div><div class="info-item-2">2. HTML_CSS</div></div><div class="info-2"><div class="info-item-1">第二章 HTML-CSS1. HTML入门1.1 HTML_CSS_JS作用 HTML用于搭建网站主体 CSS用于对页面元素美化 JS用于对页面元素动态处理  1.2 HTML概念HTML  HTML(Hyper Test Markup Language 超文本标记语言)，搭建网站结构，显示相关元素 HTML5   HTML5 技术结合了 HTML4.01 的相关标准并革新，符合现代网络发展要求，在 2008 年正式发布。HTML5 由不同的技术构成，其在互联网中得到了非常广泛的应用，提供更多增强网络应用的标准机。 与传统的技术相比，HTML5 的语法特征更加明显，并且结合了 SVG 的内容。这些内容在网页中使用可以更加便捷地处理多媒体内容，而且 HTML5中还结合了其他元素，对原有的功能进行调整和修改，进行标准化工作。 HTML5 在 2012...</div></div></div></a><a class="pagination-related" href="/2024/10/02/2.Areas%F0%9F%8C%90/back-end-java/4.JavaWeb/3.%20JavaScript/" title="3. JavaScript"><div class="cover" style="background: var(--default-bg-color)"></div><div class="info text-center"><div class="info-1"><div class="info-item-1"><i class="far fa-calendar-alt fa-fw"></i> 2024-10-02</div><div class="info-item-2">3. JavaScript</div></div><div class="info-2"><div class="info-item-1">第三章 JavaScript1. JS简介1.1 JS起源和特点 JavaScript：由Netscape(网景)的LiveScript发展而来的基于对象的动态类型区分大小写的客户端脚本语言，最初目的是为了解决服务端语言，为用户提供流畅的访问速度，而当时服务端对数据验证慢，Netscape公司的浏览器Navigator提供了数据验证的基本功能 ECMA-262是正式JavaScript标准，基于 JavaScript (Netscape) 和JScript (Microsoft)，在1996年开始，1997.7采纳了首个版本 JavaScript正式名称为ECMAScript JS包括ECMAScript、DOM、BOM  	 JS是一种运行于浏览器端上的小脚本语句,可以实现网页如文本内容动,数据动态变化和动画特效等， 特点如下  脚本语言  解释型脚本语言，不同于C&#x2F;C++ Java...</div></div></div></a><a class="pagination-related" href="/2024/09/15/2.Areas%F0%9F%8C%90/back-end-java/4.JavaWeb/4.%20XML_Tomcat_HTTP/" title="4. XML_Tomcat_HTTP"><div class="cover" style="background: var(--default-bg-color)"></div><div class="info text-center"><div class="info-1"><div class="info-item-1"><i class="far fa-calendar-alt fa-fw"></i> 2024-09-15</div><div class="info-item-2">4. XML_Tomcat_HTTP</div></div><div class="info-2"><div class="info-item-1">第四章 XML_Tomcat10_HTTP1. XML XML（EXtensible Markup Lanauage 可扩展标记语言），同和HTML一样，基本语法是标签	 可扩展：含义是XML允许自定义格式 在XML语法规范基础上，第三方应用程序、框架都会通过XML约束来规定配置文件中可以写什么以及怎么写 我们只需在第三方APP或框架上定义好的配置文件基础上，根据需求加以修改即可    	 1.1...</div></div></div></a><a class="pagination-related" href="/2024/10/13/2.Areas%F0%9F%8C%90/back-end-java/4.JavaWeb/10.%E9%98%B6%E6%AE%B5%E9%A1%B9%E7%9B%AE%E2%80%94%E2%80%94%E5%BE%AE%E5%A4%B4%E6%9D%A1/" title="10.阶段项目——微头条"><div class="cover" style="background: var(--default-bg-color)"></div><div class="info text-center"><div class="info-1"><div class="info-item-1"><i class="far fa-calendar-alt fa-fw"></i> 2024-10-13</div><div class="info-item-2">10.阶段项目——微头条</div></div><div class="info-2"><div class="info-item-1">10. 阶段项目——微头条1....</div></div></div></a><a class="pagination-related" href="/2024/10/02/2.Areas%F0%9F%8C%90/back-end-java/4.JavaWeb/5.%20Servlet/" title="5. Servlet"><div class="cover" style="background: var(--default-bg-color)"></div><div class="info text-center"><div class="info-1"><div class="info-item-1"><i class="far fa-calendar-alt fa-fw"></i> 2024-10-02</div><div class="info-item-2">5. Servlet</div></div><div class="info-2"><div class="info-item-1">第五章 Servlet1. Servlet简介首先明确动态资源和静态资源的概念（买蛋糕的例子，现有和现做的区别） 静态资源：无需通过代码运行生成的资源，即在运行前就写好的资源，包括前端三大件、img等多媒体文件 动态资源：需要通过代码运行生成的资源，即程序运行前无法确定的数据，需要运行时动态生成，包括Servlet、Thymeleaf  注：动态资源是强调运行时动态生成数据，而不是视图上的动画效果或者是简单的人机交互效果  接下来引出我们的动态资源——Servlet  Servlet（Server...</div></div></div></a></div></div></div><div class="aside-content" id="aside-content"><div class="card-widget card-info text-center"><div class="avatar-img"><img src="/img/loading.gif" data-original="/img/touxiang.jpg" onerror="this.onerror=null;this.src='/img/friend_404.gif'" alt="avatar"/></div><div class="author-info-name">yuezi</div><div class="author-info-description">积微者速成</div><div class="site-data"><a href="/archives/"><div class="headline">文章</div><div class="length-num">603</div></a><a href="/tags/"><div class="headline">标签</div><div class="length-num">61</div></a><a href="/categories/"><div class="headline">分类</div><div class="length-num">85</div></a></div><a id="card-info-btn" target="_blank" rel="noopener" href="https://github.com/yuezi2048"><i class="fab fa-github"></i><span>Follow Me</span></a><div class="card-info-social-icons"><a class="social-icon" href="https://githubfast.com/yuezi2048" target="_blank" title="Github"><i class="fab fa-github"></i></a><a class="social-icon" href="https://blog.csdn.net/qq_46345703" target="_blank" title="CSDN"><i class="fa fa-book-open"></i></a><a class="social-icon" href="https://qm.qq.com/cgi-bin/qm/qr?k=dD62GIPTf5-iS4UdSfJRy7NHwsrCh3-j" target="_blank" title="QQ"><i class="fab fa-qq"></i></a><a class="social-icon" href="mailto:joyLing@stumail.nwu.edu.cn" target="_blank" title="Email"><i class="fas fa-envelope-open-text"></i></a></div></div><div class="card-widget card-announcement"><div class="item-headline"><i class="fas fa-bullhorn fa-shake"></i><span>公告</span></div><div class="announcement_content">积微者速成</div></div><div class="sticky_layout"><div class="card-widget" id="card-toc"><div class="item-headline"><i class="fas fa-stream"></i><span>目录</span><span class="toc-percentage"></span></div><div class="toc-content"><ol class="toc"><li class="toc-item toc-level-2"><a class="toc-link" href="#9-Vue3%E6%95%B0%E6%8D%AE%E4%BA%A4%E4%BA%92axios"><span class="toc-text">9. Vue3数据交互axios</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#9-0-%E5%89%8D%E7%BD%AE%E7%9F%A5%E8%AF%86%E2%80%94%E2%80%94promise"><span class="toc-text">9.0 前置知识——promise</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#9-0-1-%E5%9B%9E%E8%B0%83%E5%87%BD%E6%95%B0"><span class="toc-text">9.0.1 回调函数</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#9-0-2-Promise%E7%AE%80%E4%BB%8B"><span class="toc-text">9.0.2 Promise简介</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#9-0-3-Promise%E7%94%A8%E6%B3%95"><span class="toc-text">9.0.3 Promise用法</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#9-0-4-%E4%BC%98%E5%8C%96%E2%80%94%E2%80%94async%E5%92%8Cawait%E4%BD%BF%E7%94%A8"><span class="toc-text">9.0.4 优化——async和await使用</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#9-1-Axios%E7%AE%80%E4%BB%8B"><span class="toc-text">9.1 Axios简介</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#9-2-Axios%E6%A1%88%E4%BE%8B"><span class="toc-text">9.2 Axios案例</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#9-2-1-Axios%E5%8F%91%E9%80%81get-post%E8%AF%B7%E6%B1%82"><span class="toc-text">9.2.1 Axios发送get post请求</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#9-2-2-Axios%E6%8B%A6%E6%88%AA%E5%99%A8"><span class="toc-text">9.2.2 Axios拦截器</span></a></li></ol></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#10-%E6%A1%88%E4%BE%8B%E5%BC%80%E5%8F%91%E2%80%94%E2%80%94%E6%97%A5%E7%A8%8B%E7%AE%A1%E7%90%86%E7%AC%AC%E5%85%AD%E6%9C%9F"><span class="toc-text">10. 案例开发——日程管理第六期</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#10-1-%E5%89%8D%E7%AB%AF%E5%90%91%E5%90%8E%E7%AB%AF%E5%8F%91%E9%80%81%E8%AF%B7%E6%B1%82"><span class="toc-text">10.1 前端向后端发送请求</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#10-1-1-%E5%B0%81%E8%A3%85%E5%B7%A5%E5%85%B7%E7%B1%BBsrc-utils-request-js"><span class="toc-text">10.1.1 封装工具类src&#x2F;utils&#x2F;request.js</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#10-1-2-%E6%B3%A8%E5%86%8C%E7%99%BB%E5%BD%95%E8%AF%B7%E6%B1%82%E5%AE%9E%E7%8E%B0"><span class="toc-text">10.1.2 注册登录请求实现</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#10-2-%E5%90%8E%E7%AB%AF%E5%A4%84%E7%90%86%E8%AF%B7%E6%B1%82"><span class="toc-text">10.2 后端处理请求</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#10-2-1-%E8%B7%A8%E5%9F%9F%E5%A4%84%E7%90%86%E5%99%A8"><span class="toc-text">10.2.1 跨域处理器</span></a><ol class="toc-child"><li class="toc-item toc-level-5"><a class="toc-link" href="#%E4%BB%80%E4%B9%88%E6%98%AF%E8%B7%A8%E5%9F%9F-%E4%B8%BA%E4%BB%80%E4%B9%88%E6%9C%89%E8%B7%A8%E5%9F%9F"><span class="toc-text">什么是跨域 为什么有跨域</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#%E8%A7%A3%E5%86%B3%E8%B7%A8%E5%9F%9F%E9%97%AE%E9%A2%98"><span class="toc-text">解决跨域问题</span></a></li></ol></li><li class="toc-item toc-level-4"><a class="toc-link" href="#10-2-2-UserController%E9%87%8D%E6%9E%84"><span class="toc-text">10.2.2 UserController重构</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#10-2-3-%E7%99%BB%E5%BD%95%E6%A0%A1%E9%AA%8C%E5%99%A8%E6%9A%82%E6%97%B6%E5%88%A0%E9%99%A4"><span class="toc-text">10.2.3 登录校验器暂时删除</span></a></li></ol></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#11-Vue3%E7%8A%B6%E6%80%81%E7%AE%A1%E7%90%86Pinia"><span class="toc-text">11. Vue3状态管理Pinia</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#11-1-Pinia%E4%BB%8B%E7%BB%8D"><span class="toc-text">11.1 Pinia介绍</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#11-2-Pinia%E5%BF%AB%E9%80%9F%E5%85%A5%E9%97%A8"><span class="toc-text">11.2 Pinia快速入门</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#11-3-Pinia%E7%BB%86%E8%8A%82"><span class="toc-text">11.3 Pinia细节</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#12-%E6%A1%88%E4%BE%8B%E5%BC%80%E5%8F%91%E2%80%94%E2%80%94%E6%97%A5%E7%A8%8B%E7%AE%A1%E7%90%86%E7%AC%AC%E4%B8%83%E6%9C%9F%EF%BC%88%E7%BB%88%E7%AB%A0%EF%BC%89"><span class="toc-text">12. 案例开发——日程管理第七期（终章）</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#12-1-%E5%89%8D%E7%AB%AF%E6%90%AD%E5%BB%BAPinia%E5%AD%98%E5%82%A8%E7%94%A8%E6%88%B7%E6%95%B0%E6%8D%AE"><span class="toc-text">12.1 前端搭建Pinia存储用户数据</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#12-1-1-%E5%AE%9A%E4%B9%89%E5%85%B1%E4%BA%AB%E6%95%B0%E6%8D%AE"><span class="toc-text">12.1.1 定义共享数据</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#12-1-2-Header%E7%BB%84%E4%BB%B6%E4%BE%9D%E8%B5%96%E5%85%B1%E4%BA%AB%E6%95%B0%E6%8D%AE%E5%B1%95%E7%A4%BA"><span class="toc-text">12.1.2 Header组件依赖共享数据展示</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#12-1-3-Login%E7%BB%84%E4%BB%B6%E6%9B%B4%E6%96%B0%E5%85%B1%E4%BA%AB%E6%95%B0%E6%8D%AE"><span class="toc-text">12.1.3 Login组件更新共享数据</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#12-1-4-%E7%99%BB%E5%BD%95%E8%AE%BF%E9%97%AE%E6%8E%A7%E5%88%B6"><span class="toc-text">12.1.4 登录访问控制</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#12-2-%E5%AE%9E%E7%8E%B0%E6%98%BE%E7%A4%BA%E6%97%A5%E7%A8%8B%E6%95%B0%E6%8D%AE"><span class="toc-text">12.2 实现显示日程数据</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#12-2-1-%E5%89%8D%E7%AB%AF"><span class="toc-text">12.2.1 前端</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#12-2-2-%E5%90%8E%E7%AB%AF"><span class="toc-text">12.2.2 后端</span></a><ol class="toc-child"><li class="toc-item toc-level-5"><a class="toc-link" href="#Controller%E5%B1%82"><span class="toc-text">Controller层</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#Service%E5%B1%82"><span class="toc-text">Service层</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#Dao%E5%B1%82"><span class="toc-text">Dao层</span></a></li></ol></li></ol></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#13-Elements-plus%E7%BB%84%E4%BB%B6%E5%BA%93"><span class="toc-text">13. Elements-plus组件库</span></a></li></ol></div></div><div class="card-widget card-recent-post"><div class="item-headline"><i class="fas fa-history"></i><span>最新文章</span></div><div class="aside-list"><div class="aside-list-item no-cover"><div class="content"><a class="title" href="/2025/10/31/Excalidraw/Drawing%202024-11-01%2015.37.37.excalidraw/" title="Drawing 2024-11-01 15.37.37.excalidraw">Drawing 2024-11-01 15.37.37.excalidraw</a><time datetime="2025-10-31T04:19:26.621Z" title="发表于 2025-10-31 12:19:26">2025-10-31</time></div></div><div class="aside-list-item no-cover"><div class="content"><a class="title" href="/2025/10/31/2.Areas%F0%9F%8C%90/01.project/condefather/yupao/back-end/7.%E4%BC%98%E5%8C%96%E4%B8%BB%E9%A1%B5%E6%80%A7%E8%83%BD-%E4%BC%98%E5%8C%96%E6%89%B9%E9%87%8F%E5%AF%BC%E5%85%A5%E6%95%B0%E6%8D%AE/" title="7.优化主页性能-优化批量导入数据">7.优化主页性能-优化批量导入数据</a><time datetime="2025-10-31T04:19:26.102Z" title="发表于 2025-10-31 12:19:26">2025-10-31</time></div></div><div class="aside-list-item no-cover"><div class="content"><a class="title" href="/2025/10/31/2.Areas%F0%9F%8C%90/02.%E9%9D%A2%E7%BB%8F%E8%AE%B0%E5%BD%95/MySQL/81.%E4%BB%80%E4%B9%88%E6%98%AF%E6%B8%B8%E6%A0%87Cursor%E5%88%86%E9%A1%B5_%E5%AF%B9%E6%AF%94%E4%BC%A0%E7%BB%9FLIMIT_OFFSET%E5%88%86%E9%A1%B5%E7%9A%84%E4%BC%98%E5%8A%BF%E6%98%AF%E4%BB%80%E4%B9%88/" title="81.什么是游标Cursor分页_对比传统LIMIT_OFFSET分页的优势是什么">81.什么是游标Cursor分页_对比传统LIMIT_OFFSET分页的优势是什么</a><time datetime="2025-10-31T04:14:27.000Z" title="发表于 2025-10-31 12:14:27">2025-10-31</time></div></div><div class="aside-list-item no-cover"><div class="content"><a class="title" href="/2025/10/31/2.Areas%F0%9F%8C%90/02.%E9%9D%A2%E7%BB%8F%E8%AE%B0%E5%BD%95/MySQL/80.%E5%85%A8%E9%87%8F%E5%90%8C%E6%AD%A5%E5%92%8C%E5%A2%9E%E9%87%8F%E5%90%8C%E6%AD%A5%E5%90%84%E8%87%AA%E4%BC%98%E7%BC%BA%E7%82%B9/" title="80.全量同步和增量同步各自优缺点">80.全量同步和增量同步各自优缺点</a><time datetime="2025-10-31T04:13:32.000Z" title="发表于 2025-10-31 12:13:32">2025-10-31</time></div></div><div class="aside-list-item no-cover"><div class="content"><a class="title" href="/2025/10/31/2.Areas%F0%9F%8C%90/02.%E9%9D%A2%E7%BB%8F%E8%AE%B0%E5%BD%95/MySQL/79.%E4%BB%80%E4%B9%88%E6%98%AF%E6%89%B9%E9%87%8F%E6%95%B0%E6%8D%AE%E5%85%A5%E5%BA%93_%E7%9B%B8%E6%AF%94%E5%8D%95%E6%9D%A1%E6%8F%92%E5%85%A5%E4%BC%98%E5%8A%BF/" title="79.什么是批量数据入库_相比单条插入优势">79.什么是批量数据入库_相比单条插入优势</a><time datetime="2025-10-31T04:03:26.000Z" title="发表于 2025-10-31 12:03:26">2025-10-31</time></div></div></div></div></div></div></main><footer id="footer" style="background-image: url(/img/default.png);"><div id="footer-wrap"><div class="copyright">&copy;2019 - 2025 By yuezi</div><div class="framework-info"><span>框架 </span><a target="_blank" rel="noopener" href="https://hexo.io">Hexo 8.0.0</a><span class="footer-separator">|</span><span>主题 </span><a target="_blank" rel="noopener" href="https://github.com/jerryc127/hexo-theme-butterfly">Butterfly 5.3.5</a></div></div></footer></div><div id="rightside"><div id="rightside-config-hide"><button id="readmode" type="button" title="阅读模式"><i class="fas fa-book-open"></i></button><button id="darkmode" type="button" title="日间和夜间模式切换"><i class="fas fa-adjust"></i></button><button id="hide-aside-btn" type="button" title="单栏和双栏切换"><i class="fas fa-arrows-alt-h"></i></button></div><div id="rightside-config-show"><button id="rightside-config" type="button" title="设置"><i class="fas fa-cog fa-spin"></i></button><button class="close" id="mobile-toc-button" type="button" title="目录"><i class="fas fa-list-ul"></i></button><button id="go-up" type="button" title="回到顶部"><span class="scroll-percent"></span><i class="fas fa-arrow-up"></i></button></div></div><div><script src="/js/utils.js"></script><script src="/js/main.js"></script><div class="js-pjax"></div><script id="canvas_nest" defer="defer" color="0,0,255" opacity="0.7" zIndex="-1" count="99" mobile="false" src="https://cdn.jsdelivr.net/npm/butterfly-extsrc/dist/canvas-nest.min.js"></script><script async data-pjax src="//busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js"></script><div id="algolia-search"><div class="search-dialog"><nav class="search-nav"><span class="search-dialog-title">搜索</span><button class="search-close-button"><i class="fas fa-times"></i></button></nav><div class="search-wrap"><div id="algolia-search-input"></div><hr/><div id="algolia-search-results"><div id="algolia-hits"></div><div id="algolia-pagination"></div><div id="algolia-info"><div class="algolia-stats"></div><div class="algolia-poweredBy"></div></div></div></div></div><div id="search-mask"></div><script src="https://cdn.jsdelivr.net/npm/algoliasearch/dist/lite/builds/browser.umd.min.js"></script><script src="https://cdn.jsdelivr.net/npm/instantsearch.js/dist/instantsearch.production.min.js"></script><script src="/js/search/algolia.js"></script></div></div>
        <style>
            [bg-lazy] {
                background-image: none !important;
                background-color: #eee !important;
            }
        </style>
        <script>
            window.imageLazyLoadSetting = {
                isSPA: false,
                preloadRatio: 1,
                processImages: null,
            };
        </script><script>window.addEventListener("load",function(){var t=/\.(gif|jpg|jpeg|tiff|png)$/i,r=/^data:image\/[a-z\d\-\.\+]+;base64,/;Array.prototype.slice.call(document.querySelectorAll("img[data-original]")).forEach(function(a){var e=a.parentNode;"A"===e.tagName&&(t.test(e.href)||r.test(e.href))&&(e.href=a.dataset.original)})});</script><script>(r=>{r.imageLazyLoadSetting.processImages=t;var a=r.imageLazyLoadSetting.isSPA,o=r.imageLazyLoadSetting.preloadRatio||1,d=i();function i(){var t=Array.prototype.slice.call(document.querySelectorAll("img[data-original]")),e=Array.prototype.slice.call(document.querySelectorAll("[bg-lazy]"));return t.concat(e)}function t(t){(a||t)&&(d=i());for(var e,n=0;n<d.length;n++)0<=(e=(e=d[n]).getBoundingClientRect()).bottom&&0<=e.left&&e.top<=(r.innerHeight*o||document.documentElement.clientHeight*o)&&(()=>{var t,e,a,o,i=d[n];e=function(){d=d.filter(function(t){return i!==t}),r.imageLazyLoadSetting.onImageLoaded&&r.imageLazyLoadSetting.onImageLoaded(i)},(t=i).dataset.loaded||(t.hasAttribute("bg-lazy")?(t.removeAttribute("bg-lazy"),e&&e()):(a=new Image,o=t.getAttribute("data-original"),a.onload=function(){t.src=o,t.removeAttribute("data-original"),t.setAttribute("data-loaded",!0),e&&e()},a.onerror=function(){t.removeAttribute("data-original"),t.setAttribute("data-loaded",!1),t.src=o},t.src!==o&&(a.src=o)))})()}function e(){clearTimeout(t.tId),t.tId=setTimeout(t,500)}t(),document.addEventListener("scroll",e),r.addEventListener("resize",e),r.addEventListener("orientationchange",e)})(this);</script></body></html>