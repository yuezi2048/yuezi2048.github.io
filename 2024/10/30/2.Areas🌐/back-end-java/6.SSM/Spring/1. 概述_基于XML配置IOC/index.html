<!DOCTYPE html><html lang="zh-CN" data-theme="light"><head><meta charset="UTF-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1.0,viewport-fit=cover"><title>1. 概述_基于XML配置IOC | yuezi</title><meta name="author" content="yuezi"><meta name="copyright" content="yuezi"><meta name="format-detection" content="telephone=no"><meta name="theme-color" content="#ffffff"><meta name="description" content="一、概述_基于XML配置IOC1.1 Spring的基本概述1.1.1 Spring是什么 Spring 是分层的 Java SE&#x2F;EE 应用 full-stack轻量级开源框架 以 IoC(Inverse Of Control：控制反转)和AOP(Aspect Oriented Programming：面向切面编程)为内核提供了展现层 SpringMVC 和持久层   Spring J">
<meta property="og:type" content="article">
<meta property="og:title" content="1. 概述_基于XML配置IOC">
<meta property="og:url" content="https://yuezi2048.github.io/2024/10/30/2.Areas%F0%9F%8C%90/back-end-java/6.SSM/Spring/1.%20%E6%A6%82%E8%BF%B0_%E5%9F%BA%E4%BA%8EXML%E9%85%8D%E7%BD%AEIOC/index.html">
<meta property="og:site_name" content="yuezi">
<meta property="og:description" content="一、概述_基于XML配置IOC1.1 Spring的基本概述1.1.1 Spring是什么 Spring 是分层的 Java SE&#x2F;EE 应用 full-stack轻量级开源框架 以 IoC(Inverse Of Control：控制反转)和AOP(Aspect Oriented Programming：面向切面编程)为内核提供了展现层 SpringMVC 和持久层   Spring J">
<meta property="og:locale" content="zh_CN">
<meta property="og:image" content="https://yuezi2048.github.io/img/touxiang.jpg">
<meta property="article:published_time" content="2024-10-30T11:23:23.000Z">
<meta property="article:modified_time" content="2024-10-30T11:23:23.000Z">
<meta property="article:author" content="yuezi">
<meta property="article:tag" content="Spring">
<meta name="twitter:card" content="summary">
<meta name="twitter:image" content="https://yuezi2048.github.io/img/touxiang.jpg"><script type="application/ld+json">{
  "@context": "https://schema.org",
  "@type": "BlogPosting",
  "headline": "1. 概述_基于XML配置IOC",
  "url": "https://yuezi2048.github.io/2024/10/30/2.Areas%F0%9F%8C%90/back-end-java/6.SSM/Spring/1.%20%E6%A6%82%E8%BF%B0_%E5%9F%BA%E4%BA%8EXML%E9%85%8D%E7%BD%AEIOC/",
  "image": "https://yuezi2048.github.io/img/touxiang.jpg",
  "datePublished": "2024-10-30T11:23:23.000Z",
  "dateModified": "2024-10-30T11:23:23.000Z",
  "author": [
    {
      "@type": "Person",
      "name": "yuezi",
      "url": "https://yuezi2048.github.io/"
    }
  ]
}</script><link rel="shortcut icon" href="/img/favicon.png"><link rel="canonical" href="https://yuezi2048.github.io/2024/10/30/2.Areas%F0%9F%8C%90/back-end-java/6.SSM/Spring/1.%20%E6%A6%82%E8%BF%B0_%E5%9F%BA%E4%BA%8EXML%E9%85%8D%E7%BD%AEIOC/index.html"><link rel="preconnect" href="//cdn.jsdelivr.net"/><link rel="preconnect" href="//hm.baidu.com"/><link rel="preconnect" href="//busuanzi.ibruce.info"/><link rel="stylesheet" href="/css/index.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fortawesome/fontawesome-free/css/all.min.css"><script>
    (() => {
      
    const saveToLocal = {
      set: (key, value, ttl) => {
        if (!ttl) return
        const expiry = Date.now() + ttl * 86400000
        localStorage.setItem(key, JSON.stringify({ value, expiry }))
      },
      get: key => {
        const itemStr = localStorage.getItem(key)
        if (!itemStr) return undefined
        const { value, expiry } = JSON.parse(itemStr)
        if (Date.now() > expiry) {
          localStorage.removeItem(key)
          return undefined
        }
        return value
      }
    }

    window.btf = {
      saveToLocal,
      getScript: (url, attr = {}) => new Promise((resolve, reject) => {
        const script = document.createElement('script')
        script.src = url
        script.async = true
        Object.entries(attr).forEach(([key, val]) => script.setAttribute(key, val))
        script.onload = script.onreadystatechange = () => {
          if (!script.readyState || /loaded|complete/.test(script.readyState)) resolve()
        }
        script.onerror = reject
        document.head.appendChild(script)
      }),
      getCSS: (url, id) => new Promise((resolve, reject) => {
        const link = document.createElement('link')
        link.rel = 'stylesheet'
        link.href = url
        if (id) link.id = id
        link.onload = link.onreadystatechange = () => {
          if (!link.readyState || /loaded|complete/.test(link.readyState)) resolve()
        }
        link.onerror = reject
        document.head.appendChild(link)
      }),
      addGlobalFn: (key, fn, name = false, parent = window) => {
        if (!false && key.startsWith('pjax')) return
        const globalFn = parent.globalFn || {}
        globalFn[key] = globalFn[key] || {}
        globalFn[key][name || Object.keys(globalFn[key]).length] = fn
        parent.globalFn = globalFn
      }
    }
  
      
      const activateDarkMode = () => {
        document.documentElement.setAttribute('data-theme', 'dark')
        if (document.querySelector('meta[name="theme-color"]') !== null) {
          document.querySelector('meta[name="theme-color"]').setAttribute('content', '#0d0d0d')
        }
      }
      const activateLightMode = () => {
        document.documentElement.setAttribute('data-theme', 'light')
        if (document.querySelector('meta[name="theme-color"]') !== null) {
          document.querySelector('meta[name="theme-color"]').setAttribute('content', '#ffffff')
        }
      }

      btf.activateDarkMode = activateDarkMode
      btf.activateLightMode = activateLightMode

      const theme = saveToLocal.get('theme')
    
          theme === 'dark' ? activateDarkMode() : theme === 'light' ? activateLightMode() : null
        
      
      const asideStatus = saveToLocal.get('aside-status')
      if (asideStatus !== undefined) {
        document.documentElement.classList.toggle('hide-aside', asideStatus === 'hide')
      }
    
      
    const detectApple = () => {
      if (/iPad|iPhone|iPod|Macintosh/.test(navigator.userAgent)) {
        document.documentElement.classList.add('apple')
      }
    }
    detectApple()
  
    })()
  </script><script>var _hmt = _hmt || [];
(function() {
  var hm = document.createElement("script");
  hm.src = "https://hm.baidu.com/hm.js?bfb48b678d82bea9f9cc9d59227767e4";
  var s = document.getElementsByTagName("script")[0];
  s.parentNode.insertBefore(hm, s);
})();
btf.addGlobalFn('pjaxComplete', () => {
  _hmt.push(['_trackPageview',window.location.pathname])
}, 'baidu_analytics')
</script><script>const GLOBAL_CONFIG = {
  root: '/',
  algolia: {"appId":"FPH6F2TOJL","apiKey":"06d9ea26c803ba912b4d8e13404ed34d","indexName":"blog","hitsPerPage":6,"languages":{"input_placeholder":"搜索","hits_empty":"未找到符合您查询的内容：${query}","hits_stats":"找到 ${hits} 条结果，耗时 ${time} 毫秒"}},
  localSearch: undefined,
  translate: undefined,
  highlight: {"plugin":"highlight.js","highlightCopy":true,"highlightLang":true,"highlightHeightLimit":350,"highlightFullpage":false,"highlightMacStyle":false},
  copy: {
    success: '复制成功',
    error: '复制失败',
    noSupport: '浏览器不支持'
  },
  relativeDate: {
    homepage: false,
    post: false
  },
  runtime: '天',
  dateSuffix: {
    just: '刚刚',
    min: '分钟前',
    hour: '小时前',
    day: '天前',
    month: '个月前'
  },
  copyright: undefined,
  lightbox: 'null',
  Snackbar: undefined,
  infinitegrid: {
    js: 'https://cdn.jsdelivr.net/npm/@egjs/infinitegrid/dist/infinitegrid.min.js',
    buttonText: '加载更多'
  },
  isPhotoFigcaption: false,
  islazyloadPlugin: false,
  isAnchor: false,
  percent: {
    toc: true,
    rightside: false,
  },
  autoDarkmode: false
}</script><script id="config-diff">var GLOBAL_CONFIG_SITE = {
  title: '1. 概述_基于XML配置IOC',
  isHighlightShrink: false,
  isToc: true,
  pageType: 'post'
}</script><link rel="stylesheet" href="/css/backgound.css"><meta name="generator" content="Hexo 8.0.0"></head><body><div id="sidebar"><div id="menu-mask"></div><div id="sidebar-menus"><div class="avatar-img text-center"><img src="/img/loading.gif" data-original="/img/touxiang.jpg" onerror="this.onerror=null;this.src='/img/friend_404.gif'" alt="avatar"/></div><div class="site-data text-center"><a href="/archives/"><div class="headline">文章</div><div class="length-num">603</div></a><a href="/tags/"><div class="headline">标签</div><div class="length-num">61</div></a><a href="/categories/"><div class="headline">分类</div><div class="length-num">85</div></a></div><div class="menus_items"><div class="menus_item"><a class="site-page" href="/"><i class="fa-fw fas fa-home"></i><span> 主页</span></a></div><div class="menus_item"><span class="site-page group"><i class="fa-fw fa fa-graduation-cap"></i><span> 博文</span><i class="fas fa-chevron-down"></i></span><ul class="menus_item_child"><li><a class="site-page child" href="/categories/"><i class="fa-fw fa fa-archive"></i><span> 分类</span></a></li><li><a class="site-page child" href="/tags/"><i class="fa-fw fa fa-tags"></i><span> 标签</span></a></li><li><a class="site-page child" href="/archives/"><i class="fa-fw fa fa-folder-open"></i><span> 归档</span></a></li></ul></div><div class="menus_item"><a class="site-page" href="/about/"><i class="fa-fw fas fa-heart"></i><span> 关于笔者</span></a></div></div></div></div><div class="post" id="body-wrap"><header class="post-bg" id="page-header" style="background-image: url(/img/default.png);"><nav id="nav"><span id="blog-info"><a class="nav-site-title" href="/"><span class="site-name">yuezi</span></a><a class="nav-page-title" href="/"><span class="site-name">1. 概述_基于XML配置IOC</span></a></span><div id="menus"><div id="search-button"><span class="site-page social-icon search"><i class="fas fa-search fa-fw"></i><span> 搜索</span></span></div><div class="menus_items"><div class="menus_item"><a class="site-page" href="/"><i class="fa-fw fas fa-home"></i><span> 主页</span></a></div><div class="menus_item"><span class="site-page group"><i class="fa-fw fa fa-graduation-cap"></i><span> 博文</span><i class="fas fa-chevron-down"></i></span><ul class="menus_item_child"><li><a class="site-page child" href="/categories/"><i class="fa-fw fa fa-archive"></i><span> 分类</span></a></li><li><a class="site-page child" href="/tags/"><i class="fa-fw fa fa-tags"></i><span> 标签</span></a></li><li><a class="site-page child" href="/archives/"><i class="fa-fw fa fa-folder-open"></i><span> 归档</span></a></li></ul></div><div class="menus_item"><a class="site-page" href="/about/"><i class="fa-fw fas fa-heart"></i><span> 关于笔者</span></a></div></div><div id="toggle-menu"><span class="site-page"><i class="fas fa-bars fa-fw"></i></span></div></div></nav><div id="post-info"><h1 class="post-title">1. 概述_基于XML配置IOC</h1><div id="post-meta"><div class="meta-firstline"><span class="post-meta-date"><i class="far fa-calendar-alt fa-fw post-meta-icon"></i><span class="post-meta-label">发表于</span><time class="post-meta-date-created" datetime="2024-10-30T11:23:23.000Z" title="发表于 2024-10-30 19:23:23">2024-10-30</time><span class="post-meta-separator">|</span><i class="fas fa-history fa-fw post-meta-icon"></i><span class="post-meta-label">更新于</span><time class="post-meta-date-updated" datetime="2024-10-30T11:23:23.000Z" title="更新于 2024-10-30 19:23:23">2024-10-30</time></span><span class="post-meta-categories"><span class="post-meta-separator">|</span><i class="fas fa-inbox fa-fw post-meta-icon"></i><a class="post-meta-categories" href="/categories/2-Areas%F0%9F%8C%90/">2.Areas🌐</a><i class="fas fa-angle-right post-meta-separator"></i><i class="fas fa-inbox fa-fw post-meta-icon"></i><a class="post-meta-categories" href="/categories/2-Areas%F0%9F%8C%90/back-end-java/">back-end-java</a><i class="fas fa-angle-right post-meta-separator"></i><i class="fas fa-inbox fa-fw post-meta-icon"></i><a class="post-meta-categories" href="/categories/2-Areas%F0%9F%8C%90/back-end-java/6-SSM/">6.SSM</a><i class="fas fa-angle-right post-meta-separator"></i><i class="fas fa-inbox fa-fw post-meta-icon"></i><a class="post-meta-categories" href="/categories/2-Areas%F0%9F%8C%90/back-end-java/6-SSM/Spring/">Spring</a></span></div><div class="meta-secondline"><span class="post-meta-separator">|</span><span class="post-meta-wordcount"><i class="far fa-file-word fa-fw post-meta-icon"></i><span class="post-meta-label">总字数:</span><span class="word-count">8.8k</span><span class="post-meta-separator">|</span><i class="far fa-clock fa-fw post-meta-icon"></i><span class="post-meta-label">阅读时长:</span><span>38分钟</span></span><span class="post-meta-separator">|</span><span class="post-meta-pv-cv" id="" data-flag-title=""><i class="far fa-eye fa-fw post-meta-icon"></i><span class="post-meta-label">浏览量:</span><span id="busuanzi_value_page_pv"><i class="fa-solid fa-spinner fa-spin"></i></span></span></div></div></div></header><main class="layout" id="content-inner"><div id="post"><article class="container post-content" id="article-container"><h1 id="一、概述-基于XML配置IOC"><a href="#一、概述-基于XML配置IOC" class="headerlink" title="一、概述_基于XML配置IOC"></a>一、概述_基于XML配置IOC</h1><h2 id="1-1-Spring的基本概述"><a href="#1-1-Spring的基本概述" class="headerlink" title="1.1 Spring的基本概述"></a>1.1 Spring的基本概述</h2><h3 id="1-1-1-Spring是什么"><a href="#1-1-1-Spring是什么" class="headerlink" title="1.1.1 Spring是什么"></a>1.1.1 Spring是什么</h3><ul>
<li>Spring 是分层的 Java SE&#x2F;EE 应用 full-stack轻量级开源框架<ul>
<li>以<code> IoC(Inverse Of Control：控制反转)</code>和<code>AOP(Aspect Oriented Programming：面向切面编程)</code>为内核提供了<strong>展现层 SpringMVC 和持久层</strong></li>
</ul>
</li>
<li>Spring JDBC 以及业务层事务管理等众多的企业级应用技术，还能整合众多著名的第三方框架和类库，逐渐成为使用最多的 Java EE 企业应用开源框架</li>
</ul>
<p><strong>发展历程</strong></p>
<p>1997 年 IBM 提出了 EJB 的思想<br>1998 年，SUN 制定开发标准规范 EJB1.0<br>1999 年，EJB1.1 发布<br>2001 年，EJB2.0 发布<br>2003 年，EJB2.1 发布<br>2006 年，EJB3.0 发布<br>Rod Johnson（spring 之父）<br>Expert One-to-One J2EE Design and Development(2002)<br>阐述了 J2EE 使用 EJB 开发设计的优点及解决方案<br>Expert One-to-One J2EE Development without EJB(2004)<br>阐述了 J2EE 开发不使用 EJB 的解决方式（Spring 雏形）<br>2004年 Spring1.0版本发布,Spring框架迅速发展。<br>2006年10月Spring 2.0于发布<br>…<br>2017 年 9 月份发布了 spring 的最新版本 spring 5.0 通用版（GA）  </p>
<h3 id="1-1-2-Spring的优势"><a href="#1-1-2-Spring的优势" class="headerlink" title="1.1.2 Spring的优势"></a>1.1.2 Spring的优势</h3><ul>
<li>方便<code>解耦</code>，方便开发<ul>
<li>Spring提供了IOC容器，将对象间的依赖关系交由Spring进行控制，避免硬编码所造成程序耦合</li>
<li>同时开发者无需为单例模式类、属性文件解析等底层需求编写代码，更专注于上层应用</li>
</ul>
</li>
<li><code>AOP编程</code>支持<ul>
<li>AOP方便进行面向切面的编程，传统OOP不易实现的功能可以通过AOP实现</li>
</ul>
</li>
<li><code>声明式事务</code>支持<ul>
<li>通过声明式可以对事务进行灵活的管理，提高开发效率</li>
</ul>
</li>
<li>方便程序测试<ul>
<li>可以用非容器依赖的编程方式进行测试工作，实现随手可做</li>
</ul>
</li>
<li>方便集成各种优秀框架<ul>
<li>提供对各种优秀框架（ Struts、 Hibernate、 Hessian、Quartz等）的直接支持</li>
</ul>
</li>
<li>降低JavaEE API使用难度<ul>
<li>比如如 JDBC、 JavaMail、远程调用等 ，进行了封装层，使API使用难度降低</li>
</ul>
</li>
<li>Java源码经典学习范例<ul>
<li>Java设计模式的高深造诣</li>
</ul>
</li>
</ul>
<h3 id="1-1-3-Spring体系"><a href="#1-1-3-Spring体系" class="headerlink" title="1.1.3 Spring体系"></a>1.1.3 Spring体系</h3><p><img src="/img/loading.gif" data-original="https://yuezi-1308313119.cos.ap-guangzhou.myqcloud.com/typora-user-images%2Fimage-20241024083749089.png" alt="image-20241024083749089">	</p>
<h2 id="1-2-耦合与解耦"><a href="#1-2-耦合与解耦" class="headerlink" title="1.2 耦合与解耦"></a>1.2 耦合与解耦</h2><h3 id="1-2-1-反射解耦案例"><a href="#1-2-1-反射解耦案例" class="headerlink" title="1.2.1 反射解耦案例"></a>1.2.1 反射解耦案例</h3><p>我们以jdbc的案例解释什么是耦合</p>
<ul>
<li>预期：如果某个功能模块出了问题，至少保证编译通过</li>
<li>问题：编译不通过，是由于高耦合（类与类之间的关系过于紧密，实际上方法与方法之间的调用关系也称为耦合），我们只能尽量减少但不能避免</li>
<li>解决方案：可以基于反射的方式降低程序的耦合</li>
</ul>
<h4 id="1-2-1-1-基于JDBC的耦合案例搭建"><a href="#1-2-1-1-基于JDBC的耦合案例搭建" class="headerlink" title="1.2.1.1 基于JDBC的耦合案例搭建"></a>1.2.1.1 基于JDBC的耦合案例搭建</h4><p>具体实验步骤如下：</p>
<p>首先导入依赖</p>
<figure class="highlight xml"><table><tr><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">dependencies</span>&gt;</span></span><br><span class="line">    <span class="comment">&lt;!--</span></span><br><span class="line"><span class="comment">	&lt;dependency&gt;</span></span><br><span class="line"><span class="comment">    &lt;groupId&gt;mysql&lt;/groupId&gt;</span></span><br><span class="line"><span class="comment">    &lt;artifactId&gt;mysql-connector-java&lt;/artifactId&gt;</span></span><br><span class="line"><span class="comment">    &lt;version&gt;5.1.6&lt;/version&gt;</span></span><br><span class="line"><span class="comment">    &lt;/dependency&gt;</span></span><br><span class="line"><span class="comment"> 	--&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">dependencies</span>&gt;</span></span><br></pre></td></tr></table></figure>

<p>编写测试类</p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">TestJdbc</span> &#123;</span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title function_">main</span><span class="params">(String[] args)</span> <span class="keyword">throws</span> Exception &#123;</span><br><span class="line">        <span class="comment">// 注册驱动</span></span><br><span class="line">        DriverManager.registerDriver(<span class="keyword">new</span> <span class="title class_">com</span>.mysql.jdbc.Driver()); <span class="comment">// 该行代码耦合度太高</span></span><br><span class="line">        </span><br><span class="line">        <span class="comment">// 准备连接数据库用到的用户名 密码 url 13306是mysql5.6的端口号</span></span><br><span class="line">        <span class="type">String</span> <span class="variable">username</span> <span class="operator">=</span> <span class="string">&quot;root&quot;</span>;</span><br><span class="line">        <span class="type">String</span> <span class="variable">password</span> <span class="operator">=</span> <span class="string">&quot;root&quot;</span>;</span><br><span class="line">        <span class="type">String</span> <span class="variable">url</span> <span class="operator">=</span> <span class="string">&quot;jdbc:mysql://localhost:13306/spring&quot;</span>;</span><br><span class="line"></span><br><span class="line">        <span class="comment">// 创建连接对象</span></span><br><span class="line">        <span class="type">Connection</span> <span class="variable">connection</span> <span class="operator">=</span> DriverManager.getConnection(url, username, password);</span><br><span class="line"></span><br><span class="line">        <span class="comment">// 创建PreparedStatement预编译SQL语句</span></span><br><span class="line">        <span class="type">String</span> <span class="variable">sql</span> <span class="operator">=</span> <span class="string">&quot;select * from account&quot;</span>;</span><br><span class="line">        <span class="type">PreparedStatement</span> <span class="variable">preparedStatement</span> <span class="operator">=</span> connection.prepareStatement(sql);</span><br><span class="line">        <span class="type">ResultSet</span> <span class="variable">resultSet</span> <span class="operator">=</span> preparedStatement.executeQuery();</span><br><span class="line">        <span class="keyword">while</span> (resultSet.next()) &#123;</span><br><span class="line">            <span class="type">Integer</span> <span class="variable">id</span> <span class="operator">=</span> resultSet.getInt(<span class="string">&quot;id&quot;</span>);</span><br><span class="line">            <span class="type">String</span> <span class="variable">name</span> <span class="operator">=</span> resultSet.getString(<span class="string">&quot;name&quot;</span>);</span><br><span class="line">            <span class="type">Double</span> <span class="variable">money</span> <span class="operator">=</span> resultSet.getDouble(<span class="string">&quot;money&quot;</span>);</span><br><span class="line">            <span class="type">Account</span> <span class="variable">account</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">Account</span>();</span><br><span class="line">            account.setId(id);</span><br><span class="line">            account.setName(name);</span><br><span class="line">            account.setMoney(money);</span><br><span class="line">            System.out.println(account);</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        <span class="comment">// 关闭资源</span></span><br><span class="line">        resultSet.close();</span><br><span class="line">        preparedStatement.close();</span><br><span class="line">        connection.close();</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>代码没问题，但是如果我们注释掉依赖后，程序编译不通过</p>
<figure class="highlight xml"><table><tr><td class="code"><pre><span class="line">   <span class="comment">&lt;!--</span></span><br><span class="line"><span class="comment">&lt;dependency&gt;</span></span><br><span class="line"><span class="comment">   &lt;groupId&gt;mysql&lt;/groupId&gt;</span></span><br><span class="line"><span class="comment">   &lt;artifactId&gt;mysql-connector-java&lt;/artifactId&gt;</span></span><br><span class="line"><span class="comment">   &lt;version&gt;5.1.6&lt;/version&gt;</span></span><br><span class="line"><span class="comment">   &lt;/dependency&gt;</span></span><br><span class="line"><span class="comment">	--&gt;</span></span><br></pre></td></tr></table></figure>



<h4 id="1-2-1-2-耦合分析与解耦方案"><a href="#1-2-1-2-耦合分析与解耦方案" class="headerlink" title="1.2.1.2 耦合分析与解耦方案"></a>1.2.1.2 耦合分析与解耦方案</h4><ul>
<li><code>耦合</code>：表示程序间的依赖关系（包含类和方法的依赖关系）</li>
<li><code>解耦</code>：降低程序间的依赖关系（只能降低不能消除）<ul>
<li>实际开发中， 我们应做到在编译期不依赖，而在运行期减少依赖</li>
</ul>
</li>
<li>解决方案：使用反射的方式减少依赖,解决编译器依赖问题</li>
</ul>
<p><img src="/img/loading.gif" data-original="https://yuezi-1308313119.cos.ap-guangzhou.myqcloud.com/typora-user-images%2Fimage-20241024085124191.png" alt="image-20241024085124191">	</p>
<ul>
<li>实验结果：注释后，编译时不报错，而只在运行时报错</li>
</ul>
<p><img src="/img/loading.gif" data-original="https://yuezi-1308313119.cos.ap-guangzhou.myqcloud.com/typora-user-images%2Fimage-20241024085420517.png" alt="image-20241024085420517">	</p>
<ul>
<li>提出新问题：如果未来将mysql驱动替换为Oracle驱动，那么该代码需修改源代码，违反了项目的开闭原则<ul>
<li>解决方案：进一步将驱动信息定义在配置文件中，然后相关代码读取配置文件的全限定名信息即可</li>
</ul>
</li>
</ul>
<p>解耦总结：<br>1、使用<strong>反射</strong>的机制，避免使用new关键字。<br>2、通过读取<strong>配置文件</strong>的方式来获取资源的全限定名  </p>
<h3 id="1-2-2-工厂解耦案例"><a href="#1-2-2-工厂解耦案例" class="headerlink" title="1.2.2 工厂解耦案例"></a>1.2.2 工厂解耦案例</h3><h4 id="1-2-2-1-基于MVC的耦合案例搭建"><a href="#1-2-2-1-基于MVC的耦合案例搭建" class="headerlink" title="1.2.2.1 基于MVC的耦合案例搭建"></a>1.2.2.1 基于MVC的耦合案例搭建</h4><p>我们引入一个MVC框架的案例</p>
<p><img src="/img/loading.gif" data-original="https://yuezi-1308313119.cos.ap-guangzhou.myqcloud.com/typora-user-images%2Fimage-20241024141019713.png" alt="image-20241024141019713">	</p>
<p><strong>DAO层</strong></p>
<p>AccountDao.java</p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="keyword">interface</span> <span class="title class_">AccountDao</span> &#123;</span><br><span class="line"></span><br><span class="line">    <span class="comment">// 新增账户的方法</span></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">addAccount</span><span class="params">()</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>AccountDaoImpl.java</p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">AccountDaoImpl</span> <span class="keyword">implements</span> <span class="title class_">AccountDao</span> &#123;</span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">addAccount</span><span class="params">()</span> &#123;</span><br><span class="line">        System.out.println(<span class="string">&quot;基于jdbc技术 新增了一条account...&quot;</span>);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>MybatisDaoImpl.java（后续由于项目升级，JDBC升级为Mybatis实现）</p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">MybatisAccountDaoImpl</span> <span class="keyword">implements</span> <span class="title class_">AccountDao</span> &#123;</span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">addAccount</span><span class="params">()</span> &#123;</span><br><span class="line">        System.out.println(<span class="string">&quot;基于mybatis技术 增加了一条account...&quot;</span>);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>



<p><strong>Service层</strong></p>
<p>AccountService.java</p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="keyword">interface</span> <span class="title class_">AccountService</span> &#123;</span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">addAccount</span><span class="params">()</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>AccountServiceImpl.java（过时的方法已注释或说明，后面同理）</p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * 目前代码存在的问题：项目如果出现新的需求，需要重新修改源代码才能实现</span></span><br><span class="line"><span class="comment"> * 明确几个概念：</span></span><br><span class="line"><span class="comment"> *      1. Bean     组件          在java中指的是dao层 service层的接口实现</span></span><br><span class="line"><span class="comment"> *      2. JavaBean 实体类        不完全等同于实体类，因为实体类只是组件中的一部分</span></span><br><span class="line"><span class="comment"> *      3. factory  创建javaBean  创建dao层 service层实现的对象</span></span><br><span class="line"><span class="comment"> * 解决方案：</span></span><br><span class="line"><span class="comment"> *      1. 通过配置文件管理我们的dao接口实现类和service接口实现类</span></span><br><span class="line"><span class="comment"> *          使用properties配置文件 k=v 唯一标识=全限定名</span></span><br><span class="line"><span class="comment"> *      2. 通过读取配置文件中的内容，获取v，基于反射技术创建对象</span></span><br><span class="line"><span class="comment"> *  后续创建对象就无需修改源代码，只需要修改javaBean的名称即可</span></span><br><span class="line"><span class="comment"> *</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@author</span> yuezi2048</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@version</span> 1.0</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">AccountServiceImpl</span> <span class="keyword">implements</span> <span class="title class_">AccountService</span> &#123;</span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">addAccount</span><span class="params">()</span> &#123;</span><br><span class="line"><span class="comment">//        AccountDao accountDao = new AccountDaoImpl();</span></span><br><span class="line"><span class="comment">//        AccountDao accountDao = new MybatisAccountDaoImpl();</span></span><br><span class="line"></span><br><span class="line"><span class="comment">//        AccountDao accountDao = (AccountDao) BeanFactory.getBean(&quot;accountDao&quot;);</span></span><br><span class="line">        <span class="type">AccountDao</span> <span class="variable">accountDao</span> <span class="operator">=</span> (AccountDao) BeanFactory.getBean(<span class="string">&quot;mybatisAccountDao&quot;</span>);</span><br><span class="line">        System.out.println(accountDao);</span><br><span class="line">        accountDao.addAccount();</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>



<h4 id="1-2-2-2-耦合分析与解耦方案"><a href="#1-2-2-2-耦合分析与解耦方案" class="headerlink" title="1.2.2.2 耦合分析与解耦方案"></a>1.2.2.2 耦合分析与解耦方案</h4><p>耦合问题分析：</p>
<ul>
<li>我们如果直接通过new主动创建，那么就会出现之前提到的耦合性问题（删除impl文件后会导致编译报错）</li>
</ul>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="type">AccountDao</span> <span class="variable">accountDao</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">AccountDaoImpl</span>();</span><br></pre></td></tr></table></figure>



<p>为了解决上述耦合问题，首先引入相关概念：</p>
<ul>
<li><code>Bean</code>：可重用组件（比如对持久层 业务层的接口和重用）</li>
<li><code>JavaBean</code>：在java领域中的可重用组件（类比于实体类，但实体类是JavaBean的一部分）</li>
<li><code>Factory</code>：用于创建我们的JavaBean（service和Dao对象）</li>
</ul>
<p>解决方案：</p>
<ul>
<li>首先通过配置文件配置JavaBean（这里的Dao和Service）<ul>
<li>配置内容k-v：唯一标识&#x3D;全限定类名</li>
<li>配置文件的形式可以是：<code>xml</code>（后期Spring使用），<code>properties</code>（实现简单，本章节演示）</li>
</ul>
</li>
<li>而后通过配置文件的内容，<code>反射</code>创建对象</li>
</ul>
<figure class="highlight properties"><table><tr><td class="code"><pre><span class="line"><span class="comment"># k=v k:JavaBean v: classPath</span></span><br><span class="line"><span class="attr">accountDao</span>=<span class="string">com.xq.dao.impl.AccountDaoImpl</span></span><br><span class="line"><span class="attr">mybatisAccountDao</span>=<span class="string">com.xq.dao.impl.MybatisAccountDaoImpl</span></span><br><span class="line"><span class="attr">accountService</span>=<span class="string">com.xq.service.impl.AccountServiceImpl</span></span><br></pre></td></tr></table></figure>



<p>接下来需要创建工厂BeanFactory</p>
<ul>
<li>工厂思路：通过类加载器先读取配置信息，然后获取对象的时候读取全限定类名，然后反射创建对象。</li>
</ul>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">BeanFactory</span> &#123;</span><br><span class="line">    <span class="keyword">static</span> Properties properties;</span><br><span class="line"></span><br><span class="line">    <span class="comment">// 读取properties里面的配置信息</span></span><br><span class="line">    <span class="keyword">static</span> &#123;</span><br><span class="line">        <span class="comment">// 类加载器加载类路径下的配置文件</span></span><br><span class="line">        <span class="keyword">try</span> &#123;</span><br><span class="line">            <span class="type">InputStream</span> <span class="variable">inputStream</span> <span class="operator">=</span> BeanFactory.class.getClassLoader().getResourceAsStream(<span class="string">&quot;bean.properties&quot;</span>);</span><br><span class="line">            properties =<span class="keyword">new</span> <span class="title class_">Properties</span>();</span><br><span class="line">            properties.load(inputStream);</span><br><span class="line">        &#125; <span class="keyword">catch</span> (Exception e) &#123;</span><br><span class="line">            <span class="keyword">throw</span> <span class="keyword">new</span> <span class="title class_">RuntimeException</span>(e);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">// 获取bean的方法</span></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> Object <span class="title function_">getBean</span><span class="params">(String beanName)</span> &#123;</span><br><span class="line">        <span class="comment">// 根据key获取value值</span></span><br><span class="line">        <span class="keyword">try</span> &#123;</span><br><span class="line">            <span class="type">String</span> <span class="variable">value</span> <span class="operator">=</span> properties.getProperty(beanName);</span><br><span class="line">            </span><br><span class="line">            <span class="comment">// 基于反射技术获取对象</span></span><br><span class="line">            <span class="comment">/*</span></span><br><span class="line"><span class="comment">             * 问题：目前创建的对象不是单例的，而是多例的，如果100个用户来调用每次都要创建一次对象，比较耗时，耗费性能。</span></span><br><span class="line"><span class="comment">             * 分析：基于反射的对象没有持久化保存，每次用完后，会被垃圾回收器回收</span></span><br><span class="line"><span class="comment">             * 优化方案：引入map存储 初始化的时候加载所有javaBean对应的对象，后续调用哪个就从map中获取哪个对象即可</span></span><br><span class="line"><span class="comment">             */</span></span><br><span class="line">            <span class="type">Object</span> <span class="variable">o</span> <span class="operator">=</span> Class.forName(value).newInstance();</span><br><span class="line">            <span class="keyword">return</span> o;</span><br><span class="line">        &#125; <span class="keyword">catch</span> (Exception e) &#123;</span><br><span class="line">            <span class="keyword">throw</span> <span class="keyword">new</span> <span class="title class_">RuntimeException</span>(e);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<p>测试类</p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title function_">main</span><span class="params">(String[] args)</span> &#123;</span><br><span class="line">    <span class="comment">// 此时发现是多例创建DaoImpl对象</span></span><br><span class="line">    <span class="keyword">for</span> (<span class="type">int</span> <span class="variable">i</span> <span class="operator">=</span> <span class="number">0</span>; i &lt; <span class="number">3</span>; i ++) &#123;</span><br><span class="line">        <span class="type">AccountService</span> <span class="variable">accountService</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">AccountServiceImpl</span>();</span><br><span class="line">        accountService.addAccount();</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>测试结果</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">com.xq.dao.impl.MybatisAccountDaoImpl@4554617c</span><br><span class="line">基于mybatis技术 增加了一条account...</span><br><span class="line">com.xq.dao.impl.MybatisAccountDaoImpl@74a14482</span><br><span class="line">基于mybatis技术 增加了一条account...</span><br><span class="line">com.xq.dao.impl.MybatisAccountDaoImpl@1540e19d</span><br><span class="line">基于mybatis技术 增加了一条account...</span><br></pre></td></tr></table></figure>



<h4 id="1-2-2-3-多例创建问题的解决方案"><a href="#1-2-2-3-多例创建问题的解决方案" class="headerlink" title="1.2.2.3 多例创建问题的解决方案"></a>1.2.2.3 多例创建问题的解决方案</h4><p>我们的”工厂类”之所以是多例模式，是因为下面这句代码：  </p>
<p><img src="/img/loading.gif" data-original="https://yuezi-1308313119.cos.ap-guangzhou.myqcloud.com/typora-user-images%2Fimage-20241024143450147.png" alt="image-20241024143450147">	</p>
<p>解决方案：将properties所有对应的JavaBean事先创建实例后装入map集合，然后直接返回map中value的javaBean对象</p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">BeanFactory</span> &#123;</span><br><span class="line">    <span class="keyword">static</span> Properties properties;</span><br><span class="line">    <span class="keyword">static</span> Map&lt;String, Object&gt; beans;</span><br><span class="line"></span><br><span class="line">    <span class="comment">// 读取properties里面的配置信息</span></span><br><span class="line">    <span class="keyword">static</span> &#123;</span><br><span class="line">        <span class="comment">// 类加载器加载类路径下的配置文件</span></span><br><span class="line">        <span class="keyword">try</span> &#123;</span><br><span class="line">            <span class="type">InputStream</span> <span class="variable">inputStream</span> <span class="operator">=</span> BeanFactory.class.getClassLoader().getResourceAsStream(<span class="string">&quot;bean.properties&quot;</span>);</span><br><span class="line">            properties =<span class="keyword">new</span> <span class="title class_">Properties</span>();</span><br><span class="line">            properties.load(inputStream);</span><br><span class="line">            beans = <span class="keyword">new</span> <span class="title class_">HashMap</span>&lt;&gt;();</span><br><span class="line"></span><br><span class="line">            Enumeration&lt;Object&gt; keys = properties.keys();</span><br><span class="line">       </span><br><span class="line">        &#125;<span class="keyword">while</span> (keys.hasMoreElements()) &#123;</span><br><span class="line">                <span class="type">String</span> <span class="variable">key</span> <span class="operator">=</span> keys.nextElement().toString();</span><br><span class="line">                <span class="comment">// 通过key获取value</span></span><br><span class="line">                <span class="type">String</span> <span class="variable">value</span> <span class="operator">=</span> properties.getProperty(key);</span><br><span class="line">                <span class="type">Object</span> <span class="variable">o</span> <span class="operator">=</span> Class.forName(value).newInstance();</span><br><span class="line">                beans.put(key,o);</span><br><span class="line">            &#125;</span><br><span class="line"></span><br><span class="line">        &#125; <span class="keyword">catch</span> (Exception e) &#123;</span><br><span class="line">            <span class="keyword">throw</span> <span class="keyword">new</span> <span class="title class_">RuntimeException</span>(e);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">// 改进后获取bean的方法</span></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> Object <span class="title function_">getBean</span><span class="params">(String key)</span> &#123;</span><br><span class="line">        <span class="keyword">return</span> beans.get(key);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>此时返回结果是同一个地址空间，是单例的，在一定的应用场景下可以减小重复创建实例的开销</p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line">com.xq.dao.impl.MybatisAccountDaoImpl@4554617c</span><br><span class="line">基于mybatis技术 增加了一条account...</span><br><span class="line">com.xq.dao.impl.MybatisAccountDaoImpl@4554617c</span><br><span class="line">基于mybatis技术 增加了一条account...</span><br><span class="line">com.xq.dao.impl.MybatisAccountDaoImpl@4554617c</span><br><span class="line">基于mybatis技术 增加了一条account...</span><br></pre></td></tr></table></figure>



<p><strong>总结：</strong></p>
<ul>
<li>第一种创建对象的方式是我们<strong>主动创建</strong>的，控制权在我们手里。但是程序的<strong>耦合性高</strong></li>
<li>第二种创建对象的方式是交给<strong>工厂</strong>帮我们创建的，控制权交给工厂了。这样<strong>降低了程序的耦合性</strong>。</li>
</ul>
<p>我们每次都自己通过工厂+配置的方式创建对象的过程过于繁琐，接下来看看Spring是如何帮我们做的 </p>
<h2 id="1-3-IOC概念和使用"><a href="#1-3-IOC概念和使用" class="headerlink" title="1.3 IOC概念和使用"></a>1.3 IOC概念和使用</h2><h3 id="1-3-1-Spring环境搭建快速入门"><a href="#1-3-1-Spring环境搭建快速入门" class="headerlink" title="1.3.1 Spring环境搭建快速入门"></a>1.3.1 Spring环境搭建快速入门</h3><ul>
<li>导入Spring核心依赖：spring-context</li>
</ul>
<figure class="highlight xml"><table><tr><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>org.springframework<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>spring-context<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">version</span>&gt;</span>5.2.0.RELEASE<span class="tag">&lt;/<span class="name">version</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br></pre></td></tr></table></figure>

<p><img src="/img/loading.gif" data-original="https://yuezi-1308313119.cos.ap-guangzhou.myqcloud.com/typora-user-images%2Fimage-20241024144338888.png" alt="image-20241024144338888">	</p>
<ul>
<li><p>定义dao, Service接口实现类</p>
<ul>
<li><strong>Dao接口实现类（接口略）</strong></li>
</ul>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">AccountDaoImpl</span> <span class="keyword">implements</span> <span class="title class_">AccountDao</span> &#123;</span><br><span class="line">    <span class="keyword">public</span> <span class="title function_">AccountDaoImpl</span><span class="params">()</span> &#123;</span><br><span class="line">        System.out.println(<span class="string">&quot;AccountDaoImpl 初始化完成&quot;</span>);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">addCount</span><span class="params">()</span> &#123;</span><br><span class="line">        System.out.println(<span class="string">&quot;新增用户...&quot;</span>);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<ul>
<li><strong>Service接口实现类</strong>（接口略）</li>
</ul>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">AccountServiceImpl</span> <span class="keyword">implements</span> <span class="title class_">AccountService</span> &#123;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="title function_">AccountServiceImpl</span><span class="params">()</span> &#123;</span><br><span class="line">        System.out.println(<span class="string">&quot;AccountServiceImpl 初始化完成&quot;</span>);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">addAccount</span><span class="params">()</span> &#123;</span><br><span class="line">        System.out.println(<span class="string">&quot;accountServiceImpl.addAccount&quot;</span>);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
</li>
<li><p>在resources目录下创建xml配置文件applicationContext，通过bean标签来管理</p>
<figure class="highlight xml"><table><tr><td class="code"><pre><span class="line"><span class="comment">&lt;!--</span></span><br><span class="line"><span class="comment">    在Spring环境中管理Bean, 快捷键复制类的路径ctrl+alt+shift+c (copy reference)</span></span><br><span class="line"><span class="comment">    bean标签： 帮助我们管理bean的标签，会将bean放入Spring的IOC容器里面</span></span><br><span class="line"><span class="comment">        id：     bean的名称  值任意，但必须唯一</span></span><br><span class="line"><span class="comment">        class:   bean所属类的全限定名</span></span><br><span class="line"><span class="comment">--&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">bean</span> <span class="attr">id</span>=<span class="string">&quot;accountDao&quot;</span> <span class="attr">class</span>=<span class="string">&quot;com.xq.dao.impl.AccountDaoImpl&quot;</span>&gt;</span><span class="tag">&lt;/<span class="name">bean</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">bean</span> <span class="attr">id</span>=<span class="string">&quot;accountService&quot;</span> <span class="attr">class</span>=<span class="string">&quot;com.xq.service.impl.AccountServiceImpl&quot;</span>&gt;</span><span class="tag">&lt;/<span class="name">bean</span>&gt;</span></span><br></pre></td></tr></table></figure>
</li>
<li><p>我们在测试文件中，获取bean</p>
<ul>
<li>初始化bean工厂（IOC容器）</li>
<li>调用工厂提供的getBean方法获取Bean</li>
</ul>
</li>
</ul>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="comment">/*</span></span><br><span class="line"><span class="comment">AccountDaoImpl 初始化完成</span></span><br><span class="line"><span class="comment">AccountServiceImpl 初始化完成</span></span><br><span class="line"><span class="comment">新增用户...</span></span><br><span class="line"><span class="comment">accountServiceImpl.addAccount</span></span><br><span class="line"><span class="comment">*/</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">TestAccount</span> &#123;</span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title function_">main</span><span class="params">(String[] args)</span> &#123;</span><br><span class="line">        <span class="comment">// 读取Spring配置文件，初始化IOC容器</span></span><br><span class="line">        <span class="comment">// applicationContext 一旦加载完成，容器中对应的对象就创建好了</span></span><br><span class="line">        <span class="type">ApplicationContext</span> <span class="variable">context</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">ClassPathXmlApplicationContext</span>(<span class="string">&quot;applicationContext.xml&quot;</span>);</span><br><span class="line"></span><br><span class="line">        <span class="comment">// 获取bean</span></span><br><span class="line">        <span class="type">AccountDao</span> <span class="variable">accountDao</span> <span class="operator">=</span> (AccountDao) context.getBean(<span class="string">&quot;accountDao&quot;</span>);</span><br><span class="line">        accountDao.addCount();</span><br><span class="line"></span><br><span class="line">        <span class="type">AccountService</span> <span class="variable">accountService</span> <span class="operator">=</span> (AccountService) context.getBean(<span class="string">&quot;accountService&quot;</span>);</span><br><span class="line">        accountService.addAccount();</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>



<h3 id="1-3-2-细节——ApplicationContext-BeanFactory"><a href="#1-3-2-细节——ApplicationContext-BeanFactory" class="headerlink" title="1.3.2 细节——ApplicationContext_BeanFactory"></a>1.3.2 细节——ApplicationContext_BeanFactory</h3><p><code>ApplicationContext</code>是工厂中重要的一个接口，从类继承图上可以发现他继承了BeanFactory顶级接口</p>
<p><img src="/img/loading.gif" data-original="https://yuezi-1308313119.cos.ap-guangzhou.myqcloud.com/typora-user-images%2Fimage-20241024145016544.png" alt="image-20241024145016544">		</p>
<p>接下来探究顶层接口<code>BeanFactory</code>的细节，思考：<code>ApplicationContext</code>与<code>BeanFactory</code>有什么不同？	</p>
<img src="/img/loading.gif" data-original="https://yuezi-1308313119.cos.ap-guangzhou.myqcloud.com/typora-user-images%2Fimage-20241024150045653.png" alt="image-20241024150045653" style="zoom: 80%;" />	

<ul>
<li><code>BeanFactory</code>：Bean工厂（IOC容器）的顶级接口，里面定义了Bean工厂的约束和规范<ul>
<li>getBean()：从容器中获取bean方法</li>
</ul>
</li>
<li><code>ApplicationContext</code>: 间接地继承了BeanFactory，对BeanFactory的方法进行了扩展</li>
<li>BeanFactory和ApplicationContext之间的区别：<strong>bean的加载时机不一样</strong><ul>
<li>ApplicationContext：一旦加载完毕，立即加载所有的bean</li>
<li>BeanFactory：懒加载所需要的bean，bean的创建并不会随着bean工厂的创建而创建而是被调用getBean方法的时候才会初始化bean</li>
</ul>
</li>
</ul>
<p>下面给出BeanFactory测试实验</p>
<p>测试结果说明：确实只有用到的AccountDaoImpl这一个JavaBean被初始化到</p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="comment">/*</span></span><br><span class="line"><span class="comment">AccountDaoImpl 初始化完成</span></span><br><span class="line"><span class="comment">新增用户...</span></span><br><span class="line"><span class="comment">*/</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">TestAccount</span> &#123;</span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title function_">main</span><span class="params">(String[] args)</span> &#123;</span><br><span class="line">        <span class="comment">// 读取Spring配置文件，初始化IOC容器</span></span><br><span class="line">        <span class="comment">// applicationContext 一旦加载完成，容器中对应的对象就创建好了</span></span><br><span class="line"><span class="comment">//        ApplicationContext context = new ClassPathXmlApplicationContext(&quot;applicationContext.xml&quot;);</span></span><br><span class="line"></span><br><span class="line">        <span class="comment">// 通过beanFactory来创建对象</span></span><br><span class="line">        <span class="comment">// 采取的是懒加载，使用到了才创建对象</span></span><br><span class="line">        <span class="type">Resource</span> <span class="variable">resource</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">ClassPathResource</span>(<span class="string">&quot;applicationContext.xml&quot;</span>);</span><br><span class="line">        <span class="type">BeanFactory</span> <span class="variable">beanFactory</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">XmlBeanFactory</span>(resource);</span><br><span class="line">        <span class="type">AccountDao</span> <span class="variable">accountDao</span> <span class="operator">=</span> (AccountDao) beanFactory.getBean(<span class="string">&quot;accountDao&quot;</span>);</span><br><span class="line">        accountDao.addCount();</span><br><span class="line">    &#125;</span><br></pre></td></tr></table></figure>

<ul>
<li>debug调试说明（在读取xml文件后，并没有进行初始化）</li>
</ul>
<p><img src="/img/loading.gif" data-original="https://yuezi-1308313119.cos.ap-guangzhou.myqcloud.com/typora-user-images%2Fimage-20241024151207977.png" alt="image-20241024151207977">	</p>
<p><strong>ApplicationContext实现类</strong></p>
<p><img src="/img/loading.gif" data-original="https://yuezi-1308313119.cos.ap-guangzhou.myqcloud.com/typora-user-images%2Fimage-20241024150306670.png" alt="image-20241024150306670">	</p>
<ul>
<li><code>ClassPathXmlApplicationContext</code>：加载类路径下的spring配置文件（常用）</li>
<li><code>FileSystemXmlApplicationContext</code>：加载磁盘绝对路径下的Spring配置文件（用的较少）</li>
</ul>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="type">ApplicationContext</span> <span class="variable">context</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">FileSystemXmlApplicationContext</span>(<span class="string">&quot;D:\\applicationContext.xml&quot;</span>);</span><br></pre></td></tr></table></figure>

<ul>
<li><code>AnnotationConfigApplicationContext</code>：用于注解环境下，创建容器的（后续再介绍）</li>
</ul>
<h2 id="1-4-Sprng对Bean的管理方式"><a href="#1-4-Sprng对Bean的管理方式" class="headerlink" title="1.4 Sprng对Bean的管理方式&lt;bean&gt;"></a>1.4 Sprng对Bean的管理方式&lt;bean&gt;</h2><p><strong>Spring 对 Bean的三种管理方式（面试常问）</strong></p>
<ul>
<li>基于无参构造函数 工厂管理bean（默认）</li>
<li>基于实例化 工厂管理bean</li>
<li>基于静态实例化 工厂管理bean</li>
</ul>
<p><img src="/img/loading.gif" data-original="https://yuezi-1308313119.cos.ap-guangzhou.myqcloud.com/typora-user-images%2Fimage-20241024153330623.png" alt="image-20241024153330623">	</p>
<p>配置文件<code>applicationContext.xml</code>总览</p>
<figure class="highlight xml"><table><tr><td class="code"><pre><span class="line"><span class="meta">&lt;?xml version=<span class="string">&quot;1.0&quot;</span> encoding=<span class="string">&quot;UTF-8&quot;</span>?&gt;</span>  </span><br><span class="line"><span class="tag">&lt;<span class="name">beans</span> <span class="attr">xmlns</span>=<span class="string">&quot;http://www.springframework.org/schema/beans&quot;</span>  </span></span><br><span class="line"><span class="tag">       <span class="attr">xmlns:xsi</span>=<span class="string">&quot;http://www.w3.org/2001/XMLSchema-instance&quot;</span>  </span></span><br><span class="line"><span class="tag">       <span class="attr">xsi:schemaLocation</span>=<span class="string">&quot;http://www.springframework.org/schema/beans http://www.springframework.org/schema/beans/spring-beans.xsd&quot;</span>&gt;</span>  </span><br><span class="line">  </span><br><span class="line">    <span class="comment">&lt;!--  </span></span><br><span class="line"><span class="comment">        Spring管理bean的第一种方式：基于无参构造函数管理bean  </span></span><br><span class="line"><span class="comment">            scope：描述bean的作用域  </span></span><br><span class="line"><span class="comment">                singleton:  单例bean  每次从容器中获取的bean都为同一个bean  </span></span><br><span class="line"><span class="comment">                prototype:  多例bean  每次从容器中获取的bean都不是同一个bean  </span></span><br><span class="line"><span class="comment">            init-method: 描述bean生命周期中初始化bean的方法  </span></span><br><span class="line"><span class="comment">            destroy-method: 描述bean生命周期中销毁bean的方法  </span></span><br><span class="line"><span class="comment">    --&gt;</span>  </span><br><span class="line">    <span class="tag">&lt;<span class="name">bean</span> <span class="attr">id</span>=<span class="string">&quot;userDao&quot;</span> <span class="attr">class</span>=<span class="string">&quot;com.xq.dao.impl.UserDaoImpl&quot;</span> <span class="attr">scope</span>=<span class="string">&quot;prototype&quot;</span> <span class="attr">init-method</span>=<span class="string">&quot;init&quot;</span> <span class="attr">destroy-method</span>=<span class="string">&quot;destroy&quot;</span>&gt;</span><span class="tag">&lt;/<span class="name">bean</span>&gt;</span>  </span><br><span class="line">  </span><br><span class="line">    <span class="comment">&lt;!--  </span></span><br><span class="line"><span class="comment">        Spring管理bean的第二种方式：基于实例化工厂管理bean  </span></span><br><span class="line"><span class="comment">            factory-Bean: 引用的是工厂bean的Id  </span></span><br><span class="line"><span class="comment">            factory-method: 引用的是工厂bean中获取bean方法的名称  </span></span><br><span class="line"><span class="comment">    --&gt;</span>  </span><br><span class="line">    <span class="tag">&lt;<span class="name">bean</span> <span class="attr">id</span>=<span class="string">&quot;personFactory&quot;</span> <span class="attr">class</span>=<span class="string">&quot;com.xq.factory.PersonFactory&quot;</span>&gt;</span><span class="tag">&lt;/<span class="name">bean</span>&gt;</span>  </span><br><span class="line">    <span class="tag">&lt;<span class="name">bean</span> <span class="attr">id</span>=<span class="string">&quot;personDao&quot;</span> <span class="attr">class</span>=<span class="string">&quot;com.xq.dao.impl.PersonDaoImpl&quot;</span> <span class="attr">factory-bean</span>=<span class="string">&quot;personFactory&quot;</span> <span class="attr">factory-method</span>=<span class="string">&quot;getPerson&quot;</span>&gt;</span><span class="tag">&lt;/<span class="name">bean</span>&gt;</span>  </span><br><span class="line">  </span><br><span class="line">    <span class="comment">&lt;!--  </span></span><br><span class="line"><span class="comment">        Spring管理bean的第三种方式：基于静态实例化工厂管理bean  </span></span><br><span class="line"><span class="comment">            由于是静态，无需引用工厂bean的id  </span></span><br><span class="line"><span class="comment">            factory-method: 引用的是工厂bean中获取bean方法的名称  </span></span><br><span class="line"><span class="comment">    --&gt;</span>  </span><br><span class="line">    <span class="tag">&lt;<span class="name">bean</span> <span class="attr">id</span>=<span class="string">&quot;orderDaoFactory&quot;</span> <span class="attr">class</span>=<span class="string">&quot;com.xq.factory.OrderDaoFactory&quot;</span> <span class="attr">factory-method</span>=<span class="string">&quot;getOrder&quot;</span>&gt;</span><span class="tag">&lt;/<span class="name">bean</span>&gt;</span>  </span><br><span class="line"><span class="tag">&lt;/<span class="name">beans</span>&gt;</span></span><br></pre></td></tr></table></figure>



<h3 id="1-4-1-基于无参构造函数实例化（默认）"><a href="#1-4-1-基于无参构造函数实例化（默认）" class="headerlink" title="1.4.1 基于无参构造函数实例化（默认）"></a>1.4.1 基于无参构造函数实例化（默认）</h3><p>以UserDao为例</p>
<p><strong>UserDaoImpl.java</strong></p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">UserDaoImpl</span> <span class="keyword">implements</span> <span class="title class_">UserDao</span> &#123;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="title function_">UserDaoImpl</span><span class="params">()</span> &#123;</span><br><span class="line">        System.out.println(<span class="string">&quot;UserDao的无参数构造函数&quot;</span>);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">addUser</span><span class="params">()</span> &#123;</span><br><span class="line">        System.out.println(<span class="string">&quot;新增用户的方法实现了...&quot;</span>);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">// 描述bean初始化执行的方法</span></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">init</span><span class="params">()</span> &#123;</span><br><span class="line">        System.out.println(<span class="string">&quot;init方法被执行...&quot;</span>);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">// 描述bean销毁执行的方法</span></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">destroy</span><span class="params">()</span> &#123;</span><br><span class="line">        System.out.println(<span class="string">&quot;destroy方法被执行&quot;</span>);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>对应的bean配置如下，其他的交给Spring实现</p>
<figure class="highlight xml"><table><tr><td class="code"><pre><span class="line"><span class="comment">&lt;!--</span></span><br><span class="line"><span class="comment">    Spring管理bean的第一种方式：基于无参构造函数管理bean</span></span><br><span class="line"><span class="comment">        scope：描述bean的作用域</span></span><br><span class="line"><span class="comment">            singleton:  单例bean  每次从容器中获取的bean都为同一个bean</span></span><br><span class="line"><span class="comment">            prototype:  多例bean  每次从容器中获取的bean都不是同一个bean</span></span><br><span class="line"><span class="comment">        init-method: 描述bean生命周期中初始化bean的方法</span></span><br><span class="line"><span class="comment">        destroy-method: 描述bean生命周期中销毁bean的方法</span></span><br><span class="line"><span class="comment">--&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">bean</span> <span class="attr">id</span>=<span class="string">&quot;userDao&quot;</span> <span class="attr">class</span>=<span class="string">&quot;com.xq.dao.impl.UserDaoImpl&quot;</span> <span class="attr">scope</span>=<span class="string">&quot;singleton&quot;</span> <span class="attr">init-method</span>=<span class="string">&quot;init&quot;</span> <span class="attr">destroy-method</span>=<span class="string">&quot;destroy&quot;</span>&gt;</span><span class="tag">&lt;/<span class="name">bean</span>&gt;</span></span><br></pre></td></tr></table></figure>

<p>测试类，结果分析如下：</p>
<ul>
<li>发现创建UserDao的Bean对象后，创建对象时使用<code>无参构造函数</code></li>
<li>作用域：<code>单例</code></li>
<li>可以定义初始化和销毁的<code>生命周期</code></li>
</ul>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="comment">/*</span></span><br><span class="line"><span class="comment">UserDao的无参数构造函数</span></span><br><span class="line"><span class="comment">init方法被执行...</span></span><br><span class="line"><span class="comment">true</span></span><br><span class="line"><span class="comment">destroy方法被执行</span></span><br><span class="line"><span class="comment">*/</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">TestUser</span> &#123;</span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title function_">main</span><span class="params">(String[] args)</span> &#123;</span><br><span class="line"></span><br><span class="line">        <span class="type">ApplicationContext</span> <span class="variable">context</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">ClassPathXmlApplicationContext</span>(<span class="string">&quot;applicationContext.xml&quot;</span>);</span><br><span class="line">        </span><br><span class="line">        <span class="type">UserDao</span> <span class="variable">userDao1</span> <span class="operator">=</span> (UserDao) context.getBean(<span class="string">&quot;userDao&quot;</span>);</span><br><span class="line">        <span class="type">UserDao</span> <span class="variable">userDao2</span> <span class="operator">=</span> (UserDao) context.getBean(<span class="string">&quot;userDao&quot;</span>);</span><br><span class="line">        System.out.println(userDao1 == userDao2);</span><br><span class="line">        </span><br><span class="line">        <span class="comment">// 销毁容器的方法</span></span><br><span class="line">        ((ClassPathXmlApplicationContext) context).close();</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h3 id="1-4-2-使用工厂普通方法实例化对象"><a href="#1-4-2-使用工厂普通方法实例化对象" class="headerlink" title="1.4.2 使用工厂普通方法实例化对象"></a>1.4.2 使用工厂普通方法实例化对象</h3><ul>
<li>给出一个实际场景：我们要使用别人写好的代码（jar包封装）</li>
<li>问题：如何获得jar包中字节码文件的对象？（此时无法通过修改源码的方式提供默认构造方法）</li>
<li>解决方案：通常jar包会暴露工厂类，供给调用者创建对象</li>
</ul>
<p>我们以Person为例</p>
<p><strong>PersonDaoImpl</strong>（接口略）</p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">PersonDaoImpl</span> <span class="keyword">implements</span> <span class="title class_">PersonDao</span> &#123;</span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">addUser</span><span class="params">()</span> &#123;</span><br><span class="line">        System.out.println(<span class="string">&quot;新增Person的方法被实现了...&quot;</span>);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>工厂方法<code>PersonFactory.java</code>，来借助该方法创建bean对象，这里就简单的通过new对象主动创建了</p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">PersonFactory</span> &#123;</span><br><span class="line"></span><br><span class="line">    <span class="comment">// 定义一个方法 方法的返回值就是需要被管理的bean类型</span></span><br><span class="line">    <span class="keyword">public</span> PersonDao <span class="title function_">getPerson</span><span class="params">()</span> &#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="keyword">new</span> <span class="title class_">PersonDaoImpl</span>();</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>对应的bean配置如下</p>
<ul>
<li>定义了factory的bean对象</li>
<li>在待创建bean对象的基础上，加入了工厂的全限定名和创建bean对象的方法名</li>
</ul>
<figure class="highlight xml"><table><tr><td class="code"><pre><span class="line"><span class="comment">&lt;!--</span></span><br><span class="line"><span class="comment">    Spring管理bean的第二种方式：基于实例化工厂管理bean</span></span><br><span class="line"><span class="comment">        factoryBean: 引用的是工厂bean的Id</span></span><br><span class="line"><span class="comment">        factory-method: 引用的是工厂bean中获取bean方法的命长</span></span><br><span class="line"><span class="comment">--&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">bean</span> <span class="attr">id</span>=<span class="string">&quot;personFactory&quot;</span> <span class="attr">class</span>=<span class="string">&quot;com.xq.factory.PersonFactory&quot;</span>&gt;</span><span class="tag">&lt;/<span class="name">bean</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">bean</span> <span class="attr">id</span>=<span class="string">&quot;personDao&quot;</span> <span class="attr">class</span>=<span class="string">&quot;com.xq.dao.impl.PersonDaoImpl&quot;</span> <span class="attr">factory-bean</span>=<span class="string">&quot;personFactory&quot;</span> <span class="attr">factory-method</span>=<span class="string">&quot;getPerson&quot;</span>&gt;</span><span class="tag">&lt;/<span class="name">bean</span>&gt;</span></span><br></pre></td></tr></table></figure>

<p>测试函数</p>
<ul>
<li>结论：顺利创建Dao对象，并调用成功对应的addUser方法</li>
</ul>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="comment">/*</span></span><br><span class="line"><span class="comment">UserDao的无参数构造函数</span></span><br><span class="line"><span class="comment">init方法被执行...</span></span><br><span class="line"><span class="comment">新增Person的方法被实现了...</span></span><br><span class="line"><span class="comment">*/</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">TestUser</span> &#123;</span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title function_">main</span><span class="params">(String[] args)</span> &#123;</span><br><span class="line">        <span class="type">ApplicationContext</span> <span class="variable">context</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">ClassPathXmlApplicationContext</span>(<span class="string">&quot;applicationContext.xml&quot;</span>);</span><br><span class="line"><span class="comment">//        UserDao userDao1 = (UserDao) context.getBean(&quot;userDao&quot;);</span></span><br><span class="line"><span class="comment">//        UserDao userDao2 = (UserDao) context.getBean(&quot;userDao&quot;);</span></span><br><span class="line"><span class="comment">//        System.out.println(userDao1 == userDao2);</span></span><br><span class="line"><span class="comment">//        // 销毁容器的方法</span></span><br><span class="line"><span class="comment">//        ((ClassPathXmlApplicationContext) context).close();</span></span><br><span class="line">        </span><br><span class="line">        <span class="type">PersonDao</span> <span class="variable">personDao</span> <span class="operator">=</span> (PersonDao) context.getBean(<span class="string">&quot;personDao&quot;</span>);</span><br><span class="line">        personDao.addUser();</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>



<h3 id="1-4-3-使用工厂静态方法实例化对象"><a href="#1-4-3-使用工厂静态方法实例化对象" class="headerlink" title="1.4.3 使用工厂静态方法实例化对象"></a>1.4.3 使用工厂静态方法实例化对象</h3><p>这里使用Order的案例示意</p>
<p>OrderDaoImpl</p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">OrderDaoImpl</span> <span class="keyword">implements</span> <span class="title class_">OrderDao</span> &#123;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">addOrder</span><span class="params">()</span> &#123;</span><br><span class="line">        System.out.println(<span class="string">&quot;新增订单的方法被实现了&quot;</span>);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>这里需要通过静态的工厂方法帮助我们实例化对象</p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">OrderDaoFactory</span> &#123;</span><br><span class="line"></span><br><span class="line">    <span class="comment">// 创建静态方法 管理bean</span></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> OrderDao <span class="title function_">getOrder</span><span class="params">()</span> &#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="keyword">new</span> <span class="title class_">OrderDaoImpl</span>();</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>对应配置</p>
<ul>
<li>无需定义factory全限定名</li>
</ul>
<figure class="highlight xml"><table><tr><td class="code"><pre><span class="line"><span class="comment">&lt;!--</span></span><br><span class="line"><span class="comment">    Spring管理bean的第三种方式：基于静态实例化工厂管理bean</span></span><br><span class="line"><span class="comment">        factory-method: 引用的是工厂bean中获取bean方法的命长</span></span><br><span class="line"><span class="comment">--&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">bean</span> <span class="attr">id</span>=<span class="string">&quot;orderDaoFactory&quot;</span> <span class="attr">class</span>=<span class="string">&quot;com.xq.factory.OrderDaoFactory&quot;</span> <span class="attr">factory-method</span>=<span class="string">&quot;getOrder&quot;</span>&gt;</span><span class="tag">&lt;/<span class="name">bean</span>&gt;</span></span><br></pre></td></tr></table></figure>

<p>实验测试：</p>
<ul>
<li>结论：顺利创建Dao对象，并调用成功对应的addOrder方法</li>
</ul>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="comment">/*</span></span><br><span class="line"><span class="comment">init方法被执行...</span></span><br><span class="line"><span class="comment">新增订单的方法被实现了</span></span><br><span class="line"><span class="comment">*/</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">TestUser</span> &#123;</span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title function_">main</span><span class="params">(String[] args)</span> &#123;</span><br><span class="line"></span><br><span class="line">        <span class="type">ApplicationContext</span> <span class="variable">context</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">ClassPathXmlApplicationContext</span>(<span class="string">&quot;applicationContext.xml&quot;</span>);</span><br><span class="line"><span class="comment">//        UserDao userDao1 = (UserDao) context.getBean(&quot;userDao&quot;);</span></span><br><span class="line"><span class="comment">//        UserDao userDao2 = (UserDao) context.getBean(&quot;userDao&quot;);</span></span><br><span class="line"><span class="comment">//        System.out.println(userDao1 == userDao2);</span></span><br><span class="line"><span class="comment">//        // 销毁容器的方法</span></span><br><span class="line"><span class="comment">//        ((ClassPathXmlApplicationContext) context).close();</span></span><br><span class="line"></span><br><span class="line"><span class="comment">//        PersonDao personDao = (PersonDao) context.getBean(&quot;personDao&quot;);</span></span><br><span class="line"><span class="comment">//        personDao.addUser();</span></span><br><span class="line"></span><br><span class="line">        <span class="type">OrderDao</span> <span class="variable">orderDaoFactory</span> <span class="operator">=</span> (OrderDao) context.getBean(<span class="string">&quot;orderDaoFactory&quot;</span>);</span><br><span class="line">        orderDaoFactory.addOrder();</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>



<h3 id="1-4-4-细节——Bean对象的属性"><a href="#1-4-4-细节——Bean对象的属性" class="headerlink" title="1.4.4 细节——Bean对象的属性"></a>1.4.4 细节——Bean对象的属性</h3><h4 id="1-4-4-1-Bean的作用域-scope"><a href="#1-4-4-1-Bean的作用域-scope" class="headerlink" title="1.4.4.1 Bean的作用域 scope"></a>1.4.4.1 Bean的作用域 scope</h4><ul>
<li>bean的作用域（scope属性描述）<ul>
<li>singleton  单例bean（默认）</li>
<li>prototype 多例bean</li>
<li>request：作用于web应用的请求范围  </li>
<li>session：作用于web应用的会话范围</li>
<li>global-session：作用于集群环境的会话范围（全局会话范围），当不是集群环境时，它就是session。</li>
</ul>
</li>
<li>怎么修改？ –&gt; bean标签的<code>scope属性</code></li>
</ul>
<p>测试：我们将UserDaoImpl对象的Scope属性修改为prototype</p>
<p><img src="/img/loading.gif" data-original="https://yuezi-1308313119.cos.ap-guangzhou.myqcloud.com/typora-user-images%2Fimage-20241024214514229.png" alt="image-20241024214514229">	</p>
<p>测试结果：创建出两个不同的实例对象</p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="comment">/*</span></span><br><span class="line"><span class="comment">init方法被执行...</span></span><br><span class="line"><span class="comment">init方法被执行...</span></span><br><span class="line"><span class="comment">false</span></span><br><span class="line"><span class="comment">*/</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">TestUser</span> &#123;</span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title function_">main</span><span class="params">(String[] args)</span> &#123;</span><br><span class="line"></span><br><span class="line">        <span class="type">ApplicationContext</span> <span class="variable">context</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">ClassPathXmlApplicationContext</span>(<span class="string">&quot;applicationContext.xml&quot;</span>);</span><br><span class="line">        <span class="type">UserDao</span> <span class="variable">userDao1</span> <span class="operator">=</span> (UserDao) context.getBean(<span class="string">&quot;userDao&quot;</span>);</span><br><span class="line">        <span class="type">UserDao</span> <span class="variable">userDao2</span> <span class="operator">=</span> (UserDao) context.getBean(<span class="string">&quot;userDao&quot;</span>);</span><br><span class="line">        System.out.println(userDao1 == userDao2);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>



<h4 id="1-4-4-2-Bean的生命周期-init-destroy"><a href="#1-4-4-2-Bean的生命周期-init-destroy" class="headerlink" title="1.4.4.2 Bean的生命周期 init&#x2F;destroy"></a>1.4.4.2 Bean的生命周期 init&#x2F;destroy</h4><p>单例对象：随容器的生命周期共生死，即：</p>
<ul>
<li>容器创建时，对象实例化完毕</li>
<li>容器存在时，对象将一直存在</li>
<li>容器销毁时，对象销毁</li>
</ul>
<p>对应到的bean配置</p>
<ul>
<li>init-method: 描述初始化bean时执行的方法</li>
<li>destroy-method: 描述销毁bean时执行的方法</li>
</ul>
<p>测试结果见1.4.1无参构造函数实例化部分。</p>
<p>多例对象：</p>
<ul>
<li>出生：使用对象时通过IOC容器为我们创建</li>
<li>存活：只要是在使用过程中就活着</li>
<li>死亡：对象长时间不用，且没有其他引用时，由java垃圾回收器自动回收</li>
</ul>
<p><img src="/img/loading.gif" data-original="https://yuezi-1308313119.cos.ap-guangzhou.myqcloud.com/typora-user-images%2Fimage-20241024214823606.png" alt="image-20241024214823606">	</p>
<p>销毁方法没有被执行，这是为什么呢？</p>
<ul>
<li>因为spring交给了Java的垃圾回收器进行回收，回收与否不能干涉</li>
<li>具体参考: <a target="_blank" rel="noopener" href="https://www.cnblogs.com/javazhiyin/p/10905294.html">https://www.cnblogs.com/javazhiyin/p/10905294.html</a></li>
</ul>
<h2 id="1-6-依赖注入DI"><a href="#1-6-依赖注入DI" class="headerlink" title="1.6 依赖注入DI"></a>1.6 依赖注入DI</h2><ul>
<li><p><code>DI</code>（Dependency Injection）: 依赖关系交由Spring维护</p>
<ul>
<li>IOC的作用：降低程序间的耦合（依赖关系）</li>
<li>DI的作用：是对依赖关系的管理，我们只需在配置文件中声明即可交由Spring维护依赖关系</li>
</ul>
</li>
<li><p>依赖注入的类型</p>
<ul>
<li>基本数据类型依赖 int String</li>
<li>对象数据类型依赖 （配置文件中配置的例如AccountDao这些Bean类型）</li>
<li>复杂数据类型依赖 List&lt;Integer&gt; l</li>
</ul>
</li>
<li><p>注入的方式</p>
<ul>
<li><code>set方法</code>（默认）</li>
<li><code>构造函数注入</code></li>
<li>复杂类型注入（了解）</li>
<li>注解方式注入（下一章节讲解）</li>
</ul>
</li>
</ul>
<p><img src="/img/loading.gif" data-original="https://yuezi-1308313119.cos.ap-guangzhou.myqcloud.com/typora-user-images%2Fimage-20241025081648843.png" alt="image-20241025081648843">	</p>
<p>xml配置文件一览</p>
<figure class="highlight xml"><table><tr><td class="code"><pre><span class="line"><span class="meta">&lt;?xml version=<span class="string">&quot;1.0&quot;</span> encoding=<span class="string">&quot;UTF-8&quot;</span>?&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">beans</span> <span class="attr">xmlns</span>=<span class="string">&quot;http://www.springframework.org/schema/beans&quot;</span></span></span><br><span class="line"><span class="tag">       <span class="attr">xmlns:xsi</span>=<span class="string">&quot;http://www.w3.org/2001/XMLSchema-instance&quot;</span></span></span><br><span class="line"><span class="tag">       <span class="attr">xsi:schemaLocation</span>=<span class="string">&quot;http://www.springframework.org/schema/beans http://www.springframework.org/schema/beans/spring-beans.xsd&quot;</span>&gt;</span></span><br><span class="line"></span><br><span class="line">    <span class="comment">&lt;!--</span></span><br><span class="line"><span class="comment">        第一种：默认的使用set方法进行注入，前提：被管理的bean所属类必须提供set方法</span></span><br><span class="line"><span class="comment">            properties标签：完成bean的属性注入（依赖注入大白话就是对容器的bean完成属性的赋值）</span></span><br><span class="line"><span class="comment">                name: 表示bean的属性名称</span></span><br><span class="line"><span class="comment">                value: 描述bean的属性值(基本数据类型和字符串的值)</span></span><br><span class="line"><span class="comment">                ref: 注入的是引用数据类型的值，引用的是另外一个bean的id</span></span><br><span class="line"><span class="comment">    --&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">bean</span> <span class="attr">id</span>=<span class="string">&quot;car&quot;</span> <span class="attr">class</span>=<span class="string">&quot;com.xq.pojo.Car&quot;</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">&quot;brand&quot;</span> <span class="attr">value</span>=<span class="string">&quot;宝马&quot;</span>&gt;</span><span class="tag">&lt;/<span class="name">property</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">&quot;type&quot;</span> <span class="attr">value</span>=<span class="string">&quot;bmw540&quot;</span>&gt;</span><span class="tag">&lt;/<span class="name">property</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">bean</span>&gt;</span></span><br><span class="line"></span><br><span class="line">    <span class="tag">&lt;<span class="name">bean</span> <span class="attr">id</span>=<span class="string">&quot;user&quot;</span> <span class="attr">class</span>=<span class="string">&quot;com.xq.pojo.User&quot;</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">&quot;username&quot;</span> <span class="attr">value</span>=<span class="string">&quot;hsp&quot;</span>&gt;</span><span class="tag">&lt;/<span class="name">property</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">&quot;age&quot;</span> <span class="attr">value</span>=<span class="string">&quot;38&quot;</span>&gt;</span><span class="tag">&lt;/<span class="name">property</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">&quot;address&quot;</span> <span class="attr">value</span>=<span class="string">&quot;China&quot;</span>&gt;</span><span class="tag">&lt;/<span class="name">property</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">&quot;car&quot;</span> <span class="attr">ref</span>=<span class="string">&quot;car&quot;</span>&gt;</span><span class="tag">&lt;/<span class="name">property</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">bean</span>&gt;</span></span><br><span class="line"></span><br><span class="line">    <span class="comment">&lt;!--</span></span><br><span class="line"><span class="comment">        第二种：使用构造函数方法进行注入，前提：被管理的bean所属类必须提供带参数构造函数方法</span></span><br><span class="line"><span class="comment">            constructor-arg标签：完成bean的属性注入  使用的是带参数的构造函数完成</span></span><br><span class="line"><span class="comment">                name: 表示bean的属性名称</span></span><br><span class="line"><span class="comment">                value: 描述bean的属性值(基本数据类型和字符串的值)</span></span><br><span class="line"><span class="comment">                ref: 注入的是引用数据类型的值，引用的是另外一个bean的id</span></span><br><span class="line"><span class="comment">    --&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">bean</span> <span class="attr">id</span>=<span class="string">&quot;department&quot;</span> <span class="attr">class</span>=<span class="string">&quot;com.xq.pojo.Department&quot;</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">constructor-arg</span> <span class="attr">name</span>=<span class="string">&quot;id&quot;</span> <span class="attr">value</span>=<span class="string">&quot;1&quot;</span>&gt;</span><span class="tag">&lt;/<span class="name">constructor-arg</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">constructor-arg</span> <span class="attr">name</span>=<span class="string">&quot;name&quot;</span> <span class="attr">value</span>=<span class="string">&quot;技术部&quot;</span>&gt;</span><span class="tag">&lt;/<span class="name">constructor-arg</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">constructor-arg</span> <span class="attr">name</span>=<span class="string">&quot;location&quot;</span> <span class="attr">value</span>=<span class="string">&quot;纽约&quot;</span>&gt;</span><span class="tag">&lt;/<span class="name">constructor-arg</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">bean</span>&gt;</span></span><br><span class="line"></span><br><span class="line">    <span class="tag">&lt;<span class="name">bean</span> <span class="attr">id</span>=<span class="string">&quot;emp&quot;</span> <span class="attr">class</span>=<span class="string">&quot;com.xq.pojo.Emp&quot;</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">constructor-arg</span> <span class="attr">name</span>=<span class="string">&quot;id&quot;</span> <span class="attr">value</span>=<span class="string">&quot;1&quot;</span>&gt;</span><span class="tag">&lt;/<span class="name">constructor-arg</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">constructor-arg</span> <span class="attr">name</span>=<span class="string">&quot;name&quot;</span> <span class="attr">value</span>=<span class="string">&quot;hsp&quot;</span>&gt;</span><span class="tag">&lt;/<span class="name">constructor-arg</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">constructor-arg</span> <span class="attr">name</span>=<span class="string">&quot;age&quot;</span> <span class="attr">value</span>=<span class="string">&quot;38&quot;</span>&gt;</span><span class="tag">&lt;/<span class="name">constructor-arg</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">constructor-arg</span> <span class="attr">name</span>=<span class="string">&quot;dept&quot;</span> <span class="attr">ref</span>=<span class="string">&quot;department&quot;</span>&gt;</span><span class="tag">&lt;/<span class="name">constructor-arg</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">bean</span>&gt;</span></span><br><span class="line"></span><br><span class="line">    <span class="comment">&lt;!--</span></span><br><span class="line"><span class="comment">        第三种：进行复杂数据类型注入（因为是硬编码 所以用的少，了解）</span></span><br><span class="line"><span class="comment">    --&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">bean</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">beans</span>&gt;</span></span><br></pre></td></tr></table></figure>



<h3 id="1-6-1-使用Set方法注入"><a href="#1-6-1-使用Set方法注入" class="headerlink" title="1.6.1 使用Set方法注入&lt;properties&gt;"></a>1.6.1 使用Set方法注入&lt;properties&gt;</h3><p>创建User类，并提供set方法，以及car类，提供brand和type属性（pojo.Car.java代码略）</p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">User</span> &#123;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">private</span> String username;</span><br><span class="line">    <span class="keyword">private</span> Integer age;</span><br><span class="line">    <span class="keyword">private</span> String address;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">private</span> Car car;</span><br><span class="line"></span><br><span class="line">    <span class="comment">// get set toString方法略</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<p>对应的xml文件配置说明</p>
<ul>
<li>properties标签：用于对bean属性注入<ul>
<li>name：属性名</li>
<li>value：属性值</li>
<li>ref：引用数据类型，值为对应javaBean的id</li>
</ul>
</li>
</ul>
<p><img src="/img/loading.gif" data-original="https://yuezi-1308313119.cos.ap-guangzhou.myqcloud.com/typora-user-images%2Fimage-20241025081838335.png" alt="image-20241025081838335">	</p>
<p>功能测试</p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="comment">/*</span></span><br><span class="line"><span class="comment">User&#123;username=&#x27;hsp&#x27;, age=38, address=&#x27;China&#x27;, car=Car&#123;brand=&#x27;宝马&#x27;, type=&#x27;bmw540&#x27;&#125;&#125;</span></span><br><span class="line"><span class="comment">*/</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">TestUser</span> &#123;</span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title function_">main</span><span class="params">(String[] args)</span> &#123;</span><br><span class="line">        <span class="type">ApplicationContext</span> <span class="variable">context</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">ClassPathXmlApplicationContext</span>(<span class="string">&quot;applicationContext.xml&quot;</span>);</span><br><span class="line">        <span class="type">User</span> <span class="variable">user</span> <span class="operator">=</span> (User) context.getBean(<span class="string">&quot;user&quot;</span>);</span><br><span class="line">        System.out.println(user);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<ul>
<li>结果说明：User的javaBean对象顺利通过Set方法和另外一个bean对象Car完成依赖注入</li>
</ul>
<h3 id="1-6-2-构造函数注入"><a href="#1-6-2-构造函数注入" class="headerlink" title="1.6.2 构造函数注入&lt;constructor-args&gt;"></a>1.6.2 构造函数注入&lt;constructor-args&gt;</h3><p>我们创建Emp类，提供构造函数，编写Department类，提供id name location属性（pojo.Department.java配置略）</p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">Emp</span> &#123;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">private</span> Integer id;</span><br><span class="line">    <span class="keyword">private</span> String name;</span><br><span class="line">    <span class="keyword">private</span> Integer age;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">private</span> Department dept;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="title function_">Emp</span><span class="params">()</span> &#123;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="title function_">Emp</span><span class="params">(Integer id, String name, Integer age, Department dept)</span> &#123;</span><br><span class="line">        <span class="built_in">this</span>.id = id;</span><br><span class="line">        <span class="built_in">this</span>.name = name;</span><br><span class="line">        <span class="built_in">this</span>.age = age;</span><br><span class="line">        <span class="built_in">this</span>.dept = dept;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">// toString方法略</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<p>配置文件说明：</p>
<ul>
<li>与set相比，将properties标签修改为constructor-arg标签即可，具体标签个数需要依赖构造函数的参数个数</li>
</ul>
<blockquote>
<p>注：xml只能输入字符串，可以自动转成Integer，但如果转成Date等类型，本质上也就是引用外部Bean，因此定义Date的bean对象并通过ref引用即可</p>
<img src="/img/loading.gif" data-original="https://yuezi-1308313119.cos.ap-guangzhou.myqcloud.com/typora-user-images%2Fimage-20241025083913011.png" alt="image-20241025083913011" style="zoom: 80%;" />	</blockquote>
<p><img src="/img/loading.gif" data-original="https://yuezi-1308313119.cos.ap-guangzhou.myqcloud.com/typora-user-images%2Fimage-20241025083512991.png" alt="image-20241025083512991">	</p>
<p>测试结果：通过构造函数顺利完成DI操作</p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="comment">/*</span></span><br><span class="line"><span class="comment">Emp&#123;id=1, name=&#x27;hsp&#x27;, age=38, dept=Department&#123;id=1, name=&#x27;技术部&#x27;, location=&#x27;纽约&#x27;&#125;&#125;</span></span><br><span class="line"><span class="comment">*/</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">TestUser</span> &#123;</span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title function_">main</span><span class="params">(String[] args)</span> &#123;</span><br><span class="line">        <span class="type">ApplicationContext</span> <span class="variable">context</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">ClassPathXmlApplicationContext</span>(<span class="string">&quot;applicationContext.xml&quot;</span>);</span><br><span class="line"></span><br><span class="line">        <span class="type">Emp</span> <span class="variable">emp</span> <span class="operator">=</span> (Emp) context.getBean(<span class="string">&quot;emp&quot;</span>);</span><br><span class="line">        System.out.println(emp);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p><strong>评价</strong></p>
<ul>
<li>优势：在获取bean对象时，注入数据是必须的操作，否则对象无法创建成功（因为没有默认空参构造）</li>
<li>弊端：改变了bean对象的实例化方式，使我们在创建对象时，如果用不到这些数据，也必须提供</li>
</ul>
<h3 id="1-6-3-复杂类型数据注入"><a href="#1-6-3-复杂类型数据注入" class="headerlink" title="1.6.3 复杂类型数据注入"></a>1.6.3 复杂类型数据注入</h3><p>提供Animal类，包含Map List 数组等复杂属性</p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">Animal</span> &#123;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">private</span> String[] strs;</span><br><span class="line">    <span class="keyword">private</span> List&lt;String&gt; list;</span><br><span class="line">    <span class="keyword">private</span> Set&lt;String&gt; set;</span><br><span class="line">    <span class="keyword">private</span> Map&lt;String,String&gt; map;</span><br><span class="line">    <span class="keyword">private</span> Properties pros;</span><br><span class="line"></span><br><span class="line">    <span class="comment">// get set toString方法略</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<p>配置文件说明</p>
<ul>
<li>数组类型使用properties-array-value注入</li>
<li>set类型使用properties-set-value注入 </li>
<li>map类型使用properties-map-entry(k-v)注入(含ref属性)</li>
<li>properties类型使用properties-props-prop(key)</li>
</ul>
<blockquote>
<p>注：该方式是硬编码，实际开发使用少，了解即可</p>
</blockquote>
<figure class="highlight xml"><table><tr><td class="code"><pre><span class="line"><span class="comment">&lt;!--</span></span><br><span class="line"><span class="comment">    第三种：进行复杂数据类型注入（因为是硬编码 所以用的少，了解）</span></span><br><span class="line"><span class="comment">--&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">bean</span> <span class="attr">id</span>=<span class="string">&quot;animal&quot;</span> <span class="attr">class</span>=<span class="string">&quot;com.xq.pojo.Animal&quot;</span>&gt;</span></span><br><span class="line">    <span class="comment">&lt;!-- 数组类型使用properties-array-value注入 --&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">&quot;strs&quot;</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">array</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">value</span>&gt;</span>str1<span class="tag">&lt;/<span class="name">value</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">value</span>&gt;</span>str2<span class="tag">&lt;/<span class="name">value</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">value</span>&gt;</span>str3<span class="tag">&lt;/<span class="name">value</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;/<span class="name">array</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">property</span>&gt;</span></span><br><span class="line"></span><br><span class="line">    <span class="comment">&lt;!-- list类型使用properties-list-value注入 --&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">&quot;list&quot;</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">list</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">value</span>&gt;</span>list1<span class="tag">&lt;/<span class="name">value</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">value</span>&gt;</span>list2<span class="tag">&lt;/<span class="name">value</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">value</span>&gt;</span>list3<span class="tag">&lt;/<span class="name">value</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;/<span class="name">list</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">property</span>&gt;</span></span><br><span class="line"></span><br><span class="line">    <span class="comment">&lt;!-- set类型使用properties-set-value注入 --&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">&quot;set&quot;</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">set</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">value</span>&gt;</span>s1<span class="tag">&lt;/<span class="name">value</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">value</span>&gt;</span>s2<span class="tag">&lt;/<span class="name">value</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">value</span>&gt;</span>s3<span class="tag">&lt;/<span class="name">value</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;/<span class="name">set</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">property</span>&gt;</span></span><br><span class="line"></span><br><span class="line">    <span class="comment">&lt;!-- map类型使用properties-map-entry(k-v)注入(含ref属性) --&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">&quot;map&quot;</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">map</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">entry</span> <span class="attr">key</span>=<span class="string">&quot;k1&quot;</span> <span class="attr">value</span>=<span class="string">&quot;v1&quot;</span>&gt;</span><span class="tag">&lt;/<span class="name">entry</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">entry</span> <span class="attr">key</span>=<span class="string">&quot;k2&quot;</span> <span class="attr">value</span>=<span class="string">&quot;v2&quot;</span>&gt;</span><span class="tag">&lt;/<span class="name">entry</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">entry</span> <span class="attr">key</span>=<span class="string">&quot;k3&quot;</span> <span class="attr">value</span>=<span class="string">&quot;v3&quot;</span>&gt;</span><span class="tag">&lt;/<span class="name">entry</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;/<span class="name">map</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">property</span>&gt;</span></span><br><span class="line"></span><br><span class="line">    <span class="comment">&lt;!-- properties类型使用properties-props-prop(key) --&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">&quot;pros&quot;</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">props</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">prop</span> <span class="attr">key</span>=<span class="string">&quot;p1&quot;</span>&gt;</span>v1<span class="tag">&lt;/<span class="name">prop</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">prop</span> <span class="attr">key</span>=<span class="string">&quot;p2&quot;</span>&gt;</span>v2<span class="tag">&lt;/<span class="name">prop</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">prop</span> <span class="attr">key</span>=<span class="string">&quot;p3&quot;</span>&gt;</span>v3<span class="tag">&lt;/<span class="name">prop</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;/<span class="name">props</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">property</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">bean</span>&gt;</span></span><br></pre></td></tr></table></figure>

<p>测试结果：通过复杂类型配置，我们顺利给Animal的bean对象进行了DI操作</p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="comment">/*</span></span><br><span class="line"><span class="comment">Animal&#123;strs=[str1, str2, str3], list=[list1, list2, list3], set=[s1, s2, s3], map=&#123;k1=v1, k2=v2, k3=v3&#125;, pros=&#123;p3=v3, p2=v2, p1=v1&#125;&#125;</span></span><br><span class="line"><span class="comment">*/</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">TestUser</span> &#123;</span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title function_">main</span><span class="params">(String[] args)</span> &#123;</span><br><span class="line">        <span class="type">ApplicationContext</span> <span class="variable">context</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">ClassPathXmlApplicationContext</span>(<span class="string">&quot;applicationContext.xml&quot;</span>);</span><br><span class="line">       </span><br><span class="line">        <span class="type">Animal</span> <span class="variable">animal</span> <span class="operator">=</span> (Animal) context.getBean(<span class="string">&quot;animal&quot;</span>);</span><br><span class="line">        System.out.println(animal);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>



<h2 id="1-7-综合案例——基于XML配置IOC"><a href="#1-7-综合案例——基于XML配置IOC" class="headerlink" title="1.7 综合案例——基于XML配置IOC"></a>1.7 综合案例——基于XML配置IOC</h2><h3 id="1-7-1-项目骨架快速搭建"><a href="#1-7-1-项目骨架快速搭建" class="headerlink" title="1.7.1 项目骨架快速搭建"></a>1.7.1 项目骨架快速搭建</h3><p><img src="/img/loading.gif" data-original="https://yuezi-1308313119.cos.ap-guangzhou.myqcloud.com/typora-user-images%2Fimage-20241030192111863.png" alt="image-20241030192111863">	</p>
<ul>
<li>创建数据库表</li>
</ul>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">create table account(</span><br><span class="line">id int primary key auto_increment,</span><br><span class="line">name varchar(40),</span><br><span class="line">money double</span><br><span class="line">)character set utf8 collate utf8_general_ci;</span><br><span class="line"></span><br><span class="line">insert into account(name,money) values(eric,1000);</span><br><span class="line">insert into account(name,money) values(&#x27;james&#x27;,1000);</span><br><span class="line">insert into account(name,money) values(&#x27;curry&#x27;,1000);</span><br></pre></td></tr></table></figure>

<ul>
<li>创建maven工程，并导入下述坐标，核心依赖说明<ul>
<li>spring依赖 spring-context</li>
<li>通过java连接mysql使用mysql-connect-java</li>
<li>操作db 选用dbutils</li>
<li>连接池选用c3p0</li>
</ul>
</li>
</ul>
<figure class="highlight xml"><table><tr><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">dependencies</span>&gt;</span></span><br><span class="line">    <span class="comment">&lt;!-- Spring核心依赖 --&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>org.springframework<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>spring-context<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">version</span>&gt;</span>5.2.0.RELEASE<span class="tag">&lt;/<span class="name">version</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br><span class="line"></span><br><span class="line">    <span class="comment">&lt;!-- DB组件核心依赖 --&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>commons-dbutils<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>commons-dbutils<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">version</span>&gt;</span>1.4<span class="tag">&lt;/<span class="name">version</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br><span class="line"></span><br><span class="line">    <span class="comment">&lt;!-- mysql驱动 --&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>mysql<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>mysql-connector-java<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">version</span>&gt;</span>5.1.6<span class="tag">&lt;/<span class="name">version</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br><span class="line"></span><br><span class="line">    <span class="comment">&lt;!-- c3p0连接池 --&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>c3p0<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>c3p0<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">version</span>&gt;</span>0.9.1.2<span class="tag">&lt;/<span class="name">version</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br><span class="line"></span><br><span class="line">    <span class="comment">&lt;!-- JUnit单元测试依赖 --&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>junit<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>junit<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">version</span>&gt;</span>4.13<span class="tag">&lt;/<span class="name">version</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">scope</span>&gt;</span>test<span class="tag">&lt;/<span class="name">scope</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">dependencies</span>&gt;</span></span><br></pre></td></tr></table></figure>

<ul>
<li>ORM思想，新建pojo.Account类</li>
</ul>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="keyword">package</span> com.xq.pojo;</span><br><span class="line"></span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@author</span> yuezi2048</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@version</span> 1.0</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">Account</span> &#123;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">private</span> Integer id;</span><br><span class="line">    <span class="keyword">private</span> String name;</span><br><span class="line">    <span class="keyword">private</span> Double money;</span><br><span class="line"></span><br><span class="line">    <span class="comment">// get set toString方法略</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<ul>
<li><p>编写Dao层和Service接口</p>
<ul>
<li>Dao层</li>
</ul>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="keyword">interface</span> <span class="title class_">AccountDao</span> &#123;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * 查询所有账户信息</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@return</span> 所有账户集合</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    List&lt;Account&gt; <span class="title function_">findAllAccount</span><span class="params">()</span>;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * 根据id查询账户信息</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@param</span> accountId id</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@return</span> 满足条件的账户</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    Account <span class="title function_">selectAccountById</span><span class="params">(Integer accountId)</span>;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * 保存账户信息</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@param</span> account 账户</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="keyword">void</span> <span class="title function_">saveAccount</span><span class="params">(Account account)</span>;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * 更新账户信息</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@param</span> account 账户</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="keyword">void</span> <span class="title function_">updateAccount</span><span class="params">(Account account)</span>;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * 根据id删除账户信息</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@param</span> accountId 待删除账户id</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="keyword">void</span> <span class="title function_">deleteAccount</span><span class="params">(Integer accountId)</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<ul>
<li>service层（由于单表查询没有业务逻辑，所以和Dao层定义相同）</li>
</ul>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="keyword">interface</span> <span class="title class_">AccountService</span> &#123;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * 查询所有账户信息</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@return</span> 所有账户集合</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    List&lt;Account&gt; <span class="title function_">findAllAccount</span><span class="params">()</span>;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * 根据id查询账户信息</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@param</span> accountId id</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@return</span> 满足条件的账户</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    Account <span class="title function_">selectAccountById</span><span class="params">(Integer accountId)</span>;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * 保存账户信息</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@param</span> account 账户</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="keyword">void</span> <span class="title function_">saveAccount</span><span class="params">(Account account)</span>;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * 更新账户信息</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@param</span> account 账户</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="keyword">void</span> <span class="title function_">updateAccount</span><span class="params">(Account account)</span>;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * 根据id删除账户信息</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@param</span> accountId 待删除账户id</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="keyword">void</span> <span class="title function_">deleteAccount</span><span class="params">(Integer accountId)</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
</li>
<li><p>编写Dao 和 Service层实现类</p>
<ul>
<li>AccountServiceImpl</li>
</ul>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">AccountServiceImpl</span> <span class="keyword">implements</span> <span class="title class_">AccountService</span> &#123;</span><br><span class="line">    AccountDao accountDao;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="keyword">public</span> List&lt;Account&gt; <span class="title function_">findAllAccount</span><span class="params">()</span> &#123;</span><br><span class="line">        <span class="keyword">return</span> accountDao.findAllAccount();</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="keyword">public</span> Account <span class="title function_">selectAccountById</span><span class="params">(Integer accountId)</span> &#123;</span><br><span class="line">        <span class="keyword">return</span> accountDao.selectAccountById(accountId);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">saveAccount</span><span class="params">(Account account)</span> &#123;</span><br><span class="line">        accountDao.saveAccount(account);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">updateAccount</span><span class="params">(Account account)</span> &#123;</span><br><span class="line">        accountDao.updateAccount(account);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">deleteAccount</span><span class="params">(Integer accountId)</span> &#123;</span><br><span class="line">        accountDao.deleteAccount(accountId);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<ul>
<li>AccountDaoImpl</li>
</ul>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">AccountDaoImpl</span> <span class="keyword">implements</span> <span class="title class_">AccountDao</span> &#123;</span><br><span class="line">    <span class="comment">// 操作数据库的核心类</span></span><br><span class="line">    <span class="keyword">private</span> QueryRunner runner;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="keyword">public</span> List&lt;Account&gt; <span class="title function_">findAllAccount</span><span class="params">()</span> &#123;</span><br><span class="line">        <span class="keyword">try</span> &#123;</span><br><span class="line">            <span class="type">String</span> <span class="variable">sql</span> <span class="operator">=</span> <span class="string">&quot;select * from account&quot;</span>;</span><br><span class="line">            List&lt;Account&gt; accountList = runner.query(sql, <span class="keyword">new</span> <span class="title class_">BeanListHandler</span>&lt;Account&gt;(Account.class));</span><br><span class="line">            <span class="keyword">return</span> accountList;</span><br><span class="line">        &#125; <span class="keyword">catch</span> (SQLException e) &#123;</span><br><span class="line">            <span class="keyword">throw</span> <span class="keyword">new</span> <span class="title class_">RuntimeException</span>(e);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="keyword">public</span> Account <span class="title function_">selectAccountById</span><span class="params">(Integer accountId)</span> &#123;</span><br><span class="line">        <span class="keyword">try</span> &#123;</span><br><span class="line">            <span class="type">String</span> <span class="variable">sql</span> <span class="operator">=</span> <span class="string">&quot;select * from account where id = ?&quot;</span>;</span><br><span class="line">            List&lt;Account&gt; accountList = runner.query(sql, <span class="keyword">new</span> <span class="title class_">BeanListHandler</span>&lt;Account&gt;(Account.class), accountId);</span><br><span class="line">            <span class="keyword">return</span> accountList.get(<span class="number">0</span>);</span><br><span class="line">        &#125; <span class="keyword">catch</span> (SQLException e) &#123;</span><br><span class="line">            <span class="keyword">throw</span> <span class="keyword">new</span> <span class="title class_">RuntimeException</span>(e);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">saveAccount</span><span class="params">(Account account)</span> &#123;</span><br><span class="line">        <span class="keyword">try</span> &#123;</span><br><span class="line">            <span class="type">String</span> <span class="variable">sql</span> <span class="operator">=</span> <span class="string">&quot;insert into account (id, name, password) values (DEFAULT,?,?)&quot;</span>;</span><br><span class="line">            runner.update(sql, account.getName(), account.getMoney());</span><br><span class="line">        &#125; <span class="keyword">catch</span> (SQLException e) &#123;</span><br><span class="line">            <span class="keyword">throw</span> <span class="keyword">new</span> <span class="title class_">RuntimeException</span>(e);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">updateAccount</span><span class="params">(Account account)</span> &#123;</span><br><span class="line">        <span class="keyword">try</span> &#123;</span><br><span class="line">            <span class="type">String</span> <span class="variable">sql</span> <span class="operator">=</span> <span class="string">&quot;update account set name=?,password=? where id=?&quot;</span>;</span><br><span class="line">            runner.update(sql, account.getName(), account.getMoney(), account.getMoney());</span><br><span class="line">        &#125; <span class="keyword">catch</span> (SQLException e) &#123;</span><br><span class="line">            <span class="keyword">throw</span> <span class="keyword">new</span> <span class="title class_">RuntimeException</span>(e);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">deleteAccount</span><span class="params">(Integer accountId)</span> &#123;</span><br><span class="line">        <span class="keyword">try</span> &#123;</span><br><span class="line">            <span class="type">String</span> <span class="variable">sql</span> <span class="operator">=</span> <span class="string">&quot;delete from account where id = ?&quot;</span>;</span><br><span class="line">            runner.update(sql, accountId);</span><br><span class="line">        &#125; <span class="keyword">catch</span> (SQLException e) &#123;</span><br><span class="line">            <span class="keyword">throw</span> <span class="keyword">new</span> <span class="title class_">RuntimeException</span>(e);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></li>
</ul>
<p>目前已经完成基本骨架创建，接下来就需要对连接mysql的dataSrouce和操作数据库的queryRunner等对象通过IOC容器进行依赖管理。</p>
<h3 id="1-7-2-基于Spring进行依赖管理"><a href="#1-7-2-基于Spring进行依赖管理" class="headerlink" title="1.7.2 基于Spring进行依赖管理"></a>1.7.2 基于Spring进行依赖管理</h3><p>需要spring管理的bean对象包括：</p>
<ul>
<li>dataSource</li>
<li>queryRunner</li>
<li>Dao层和Service层实现对象</li>
</ul>
<p>我们通过配置XML来管理这些bean对象，具体applicationContext.xml如下</p>
<figure class="highlight xml"><table><tr><td class="code"><pre><span class="line"><span class="meta">&lt;?xml version=<span class="string">&quot;1.0&quot;</span> encoding=<span class="string">&quot;UTF-8&quot;</span>?&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">beans</span> <span class="attr">xmlns</span>=<span class="string">&quot;http://www.springframework.org/schema/beans&quot;</span></span></span><br><span class="line"><span class="tag">       <span class="attr">xmlns:xsi</span>=<span class="string">&quot;http://www.w3.org/2001/XMLSchema-instance&quot;</span></span></span><br><span class="line"><span class="tag">       <span class="attr">xsi:schemaLocation</span>=<span class="string">&quot;http://www.springframework.org/schema/beans http://www.springframework.org/schema/beans/spring-beans.xsd&quot;</span>&gt;</span></span><br><span class="line"></span><br><span class="line">    <span class="comment">&lt;!--</span></span><br><span class="line"><span class="comment">        配置数据源</span></span><br><span class="line"><span class="comment">            properties: 描述连接数据库用到的用户名 url 密码 驱动类</span></span><br><span class="line"><span class="comment">    --&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">bean</span> <span class="attr">id</span>=<span class="string">&quot;dataSource&quot;</span> <span class="attr">class</span>=<span class="string">&quot;com.mchange.v2.c3p0.ComboPooledDataSource&quot;</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">&quot;driverClass&quot;</span> <span class="attr">value</span>=<span class="string">&quot;com.mysql.jdbc.Driver&quot;</span>&gt;</span><span class="tag">&lt;/<span class="name">property</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">&quot;jdbcUrl&quot;</span> <span class="attr">value</span>=<span class="string">&quot;jdbc:mysql://127.0.0.1:13306/spring&quot;</span>&gt;</span><span class="tag">&lt;/<span class="name">property</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">&quot;user&quot;</span> <span class="attr">value</span>=<span class="string">&quot;root&quot;</span>&gt;</span><span class="tag">&lt;/<span class="name">property</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">&quot;password&quot;</span> <span class="attr">value</span>=<span class="string">&quot;Aa147147+&quot;</span>&gt;</span><span class="tag">&lt;/<span class="name">property</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">bean</span>&gt;</span></span><br><span class="line"></span><br><span class="line">    <span class="comment">&lt;!--</span></span><br><span class="line"><span class="comment">        管理queryRunner核心对象</span></span><br><span class="line"><span class="comment">    --&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">bean</span> <span class="attr">id</span>=<span class="string">&quot;runner&quot;</span> <span class="attr">class</span>=<span class="string">&quot;org.apache.commons.dbutils.QueryRunner&quot;</span>&gt;</span></span><br><span class="line">        <span class="comment">&lt;!-- 将数据源注入到queryRunner对象中去 --&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">constructor-arg</span> <span class="attr">name</span>=<span class="string">&quot;ds&quot;</span> <span class="attr">ref</span>=<span class="string">&quot;dataSource&quot;</span>&gt;</span><span class="tag">&lt;/<span class="name">constructor-arg</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">bean</span>&gt;</span></span><br><span class="line"></span><br><span class="line">    <span class="comment">&lt;!--</span></span><br><span class="line"><span class="comment">        管理dao，依赖于容器中的runner对象</span></span><br><span class="line"><span class="comment">    --&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">bean</span> <span class="attr">id</span>=<span class="string">&quot;accountDao&quot;</span> <span class="attr">class</span>=<span class="string">&quot;com.xq.dao.impl.AccountDaoImpl&quot;</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">&quot;runner&quot;</span> <span class="attr">ref</span>=<span class="string">&quot;runner&quot;</span>&gt;</span><span class="tag">&lt;/<span class="name">property</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">bean</span>&gt;</span></span><br><span class="line"></span><br><span class="line">    <span class="comment">&lt;!--</span></span><br><span class="line"><span class="comment">        管理service,依赖于容器中的dao</span></span><br><span class="line"><span class="comment">    --&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">bean</span> <span class="attr">id</span>=<span class="string">&quot;accountService&quot;</span> <span class="attr">class</span>=<span class="string">&quot;com.xq.service.impl.AccountServiceImpl&quot;</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">&quot;accountDao&quot;</span> <span class="attr">ref</span>=<span class="string">&quot;accountDao&quot;</span>&gt;</span><span class="tag">&lt;/<span class="name">property</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">bean</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">beans</span>&gt;</span></span><br></pre></td></tr></table></figure>



<p>对每个功能编写测试类，实现基于XML配置的IOC</p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="keyword">package</span> com.xq;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> com.xq.pojo.Account;</span><br><span class="line"><span class="keyword">import</span> com.xq.service.AccountService;</span><br><span class="line"><span class="keyword">import</span> org.junit.Test;</span><br><span class="line"><span class="keyword">import</span> org.springframework.context.ApplicationContext;</span><br><span class="line"><span class="keyword">import</span> org.springframework.context.support.ClassPathXmlApplicationContext;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> java.util.List;</span><br><span class="line"></span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@author</span> yuezi2048</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@version</span> 1.0</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">TestAccount</span> &#123;</span><br><span class="line">    <span class="meta">@Test</span></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">test01</span><span class="params">()</span> &#123;</span><br><span class="line">        <span class="type">ApplicationContext</span> <span class="variable">context</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">ClassPathXmlApplicationContext</span>(<span class="string">&quot;applicationContext.xml&quot;</span>);</span><br><span class="line">        <span class="type">AccountService</span> <span class="variable">accountService</span> <span class="operator">=</span> (AccountService) context.getBean(<span class="string">&quot;accountService&quot;</span>);</span><br><span class="line">        List&lt;Account&gt; accountList = accountService.findAllAccount();</span><br><span class="line">        <span class="keyword">for</span> (Account account : accountList) &#123;</span><br><span class="line">            System.out.println(account);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Test</span></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">test02</span><span class="params">()</span> &#123;</span><br><span class="line">        <span class="type">ApplicationContext</span> <span class="variable">context</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">ClassPathXmlApplicationContext</span>(<span class="string">&quot;applicationContext.xml&quot;</span>);</span><br><span class="line">        <span class="type">AccountService</span> <span class="variable">accountService</span> <span class="operator">=</span> (AccountService) context.getBean(<span class="string">&quot;accountService&quot;</span>);</span><br><span class="line">        <span class="type">Account</span> <span class="variable">account</span> <span class="operator">=</span> accountService.selectAccountById(<span class="number">1</span>);</span><br><span class="line">        System.out.println(account);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Test</span></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">test03</span><span class="params">()</span> &#123;</span><br><span class="line">        <span class="type">ApplicationContext</span> <span class="variable">context</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">ClassPathXmlApplicationContext</span>(<span class="string">&quot;applicationContext.xml&quot;</span>);</span><br><span class="line">        <span class="type">AccountService</span> <span class="variable">accountService</span> <span class="operator">=</span> (AccountService) context.getBean(<span class="string">&quot;accountService&quot;</span>);</span><br><span class="line">        <span class="type">Account</span> <span class="variable">account</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">Account</span>();</span><br><span class="line">        account.setName(<span class="string">&quot;zsh&quot;</span>);</span><br><span class="line">        account.setMoney(<span class="number">1234.5</span>);</span><br><span class="line">        accountService.saveAccount(account);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Test</span></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">test04</span><span class="params">()</span> &#123;</span><br><span class="line">        <span class="type">ApplicationContext</span> <span class="variable">context</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">ClassPathXmlApplicationContext</span>(<span class="string">&quot;applicationContext.xml&quot;</span>);</span><br><span class="line">        <span class="type">AccountService</span> <span class="variable">accountService</span> <span class="operator">=</span> (AccountService) context.getBean(<span class="string">&quot;accountService&quot;</span>);</span><br><span class="line">        <span class="type">Account</span> <span class="variable">account</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">Account</span>();</span><br><span class="line">        account.setId(<span class="number">3</span>);</span><br><span class="line">        account.setName(<span class="string">&quot;zsh&quot;</span>);</span><br><span class="line">        account.setMoney(<span class="number">12345.6</span>);</span><br><span class="line">        accountService.updateAccount(account);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Test</span></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">test05</span><span class="params">()</span> &#123;</span><br><span class="line">        <span class="type">ApplicationContext</span> <span class="variable">context</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">ClassPathXmlApplicationContext</span>(<span class="string">&quot;applicationContext.xml&quot;</span>);</span><br><span class="line">        <span class="type">AccountService</span> <span class="variable">accountService</span> <span class="operator">=</span> (AccountService) context.getBean(<span class="string">&quot;accountService&quot;</span>);</span><br><span class="line">        accountService.deleteAccount(<span class="number">1</span>);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br></pre></td></tr></table></figure></article><div class="post-copyright"><div class="post-copyright__author"><span class="post-copyright-meta"><i class="fas fa-circle-user fa-fw"></i>文章作者: </span><span class="post-copyright-info"><a href="https://yuezi2048.github.io">yuezi</a></span></div><div class="post-copyright__type"><span class="post-copyright-meta"><i class="fas fa-square-arrow-up-right fa-fw"></i>文章链接: </span><span class="post-copyright-info"><a href="https://yuezi2048.github.io/2024/10/30/2.Areas%F0%9F%8C%90/back-end-java/6.SSM/Spring/1.%20%E6%A6%82%E8%BF%B0_%E5%9F%BA%E4%BA%8EXML%E9%85%8D%E7%BD%AEIOC/">https://yuezi2048.github.io/2024/10/30/2.Areas🌐/back-end-java/6.SSM/Spring/1. 概述_基于XML配置IOC/</a></span></div><div class="post-copyright__notice"><span class="post-copyright-meta"><i class="fas fa-circle-exclamation fa-fw"></i>版权声明: </span><span class="post-copyright-info">本博客所有文章除特别声明外，均采用 <a href="https://creativecommons.org/licenses/by-nc-sa/4.0/" target="_blank">CC BY-NC-SA 4.0</a> 许可协议。转载请注明来源 <a href="https://yuezi2048.github.io" target="_blank">yuezi</a>！</span></div></div><div class="tag_share"><div class="post-meta__tag-list"><a class="post-meta__tags" href="/tags/Spring/">Spring</a></div><div class="post-share"><div class="social-share" data-image="/img/touxiang.jpg" data-sites="qq,wechat"></div><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/butterfly-extsrc/sharejs/dist/css/share.min.css" media="print" onload="this.media='all'"><script src="https://cdn.jsdelivr.net/npm/butterfly-extsrc/sharejs/dist/js/social-share.min.js" defer></script></div></div><nav class="pagination-post" id="pagination"><a class="pagination-related" href="/2024/10/27/2.Areas%F0%9F%8C%90/science/Pre/%E7%BB%BC%E8%BF%B0/%E7%BB%BC%E8%BF%B0/" title="综述"><div class="cover" style="background: var(--default-bg-color)"></div><div class="info"><div class="info-1"><div class="info-item-1">上一篇</div><div class="info-item-2">综述</div></div><div class="info-2"><div class="info-item-1">abstract what: related work summarize the latest advancement in the field of RS   why: The objective of this study provide the current state-of-the-art highlight the latest trends in the development of RS   how: specific context the main taxonomy of RS, including personalized and group RS delves into the category of knowledge-based RS Summarizing evaluation metrics to asses the performance of systems ：the robustness, data bias and fairness issues in RS    Ⅰ. introduction To address the issue...</div></div></div></a><a class="pagination-related" href="/2024/11/03/2.Areas%F0%9F%8C%90/basic-408/%E6%95%B0%E6%8D%AE%E7%BB%93%E6%9E%84/%E6%97%B6%E9%97%B4%E5%A4%8D%E6%9D%82%E5%BA%A6/" title="时间复杂度"><div class="cover" style="background: var(--default-bg-color)"></div><div class="info text-right"><div class="info-1"><div class="info-item-1">下一篇</div><div class="info-item-2">时间复杂度</div></div><div class="info-2"><div class="info-item-1">算法：对特定问题的求解步骤的描述，是指令的有限序列，其中每条指令表示一个或多个操作 特性：  有穷性，确定性，可行性，输入（0&#x2F;1&#x2F;多个）和输出（1个或多个）  “好”的算法应该满足：正确的、可读性、健壮性、高效率（时间）和底存储量（空间）  高效率：运行时间短  &#x3D;&#x3D;&#x3D;&gt; 时间复杂度 低存储量：运行所占用的空间小 &#x3D;&#x3D;&gt; 空间复杂度     统计时间，可以通过采用一些统计，监控的函数&#x2F;方法，得到具体的精确的运行时间（事后统计法，马后炮） 局限性：受测试平台环境的影响，不同性能的硬件配置，对于同一个代码的运行时间是不一样的 采用事前估计法  高级语言每个语句执行时间差别不大，所以我们可以认为执行时间是一样的，一般是取执行时间最大的单条语句的时间，方便我们估计。 执行时间和语句的执行条数成正比，给出一个概念 语句频度/时间频度：某条语句在算法中被重复执行的次数，一般将算法中所有频度之和为T (n) T(n) 是关于问题规模 / 数据规模 n 的函数 引入一个辅助函数 f(n)...</div></div></div></a></nav><div class="relatedPosts"><div class="headline"><i class="fas fa-thumbs-up fa-fw"></i><span>相关推荐</span></div><div class="relatedPosts-list"><a class="pagination-related" href="/2025/05/07/2.Areas%F0%9F%8C%90/back-end-java/6.SSM/Spring/3.%20AOP/" title="3. AOP"><div class="cover" style="background: var(--default-bg-color)"></div><div class="info text-center"><div class="info-1"><div class="info-item-1"><i class="far fa-calendar-alt fa-fw"></i> 2025-05-07</div><div class="info-item-2">3. AOP</div></div><div class="info-2"><div class="info-item-1">三、AOP3.1 转账的事务问题与解决思路继续上一章节转账案例的进度，当前进度：  通过注解或者XML配置文件的方式配置了IOC 对数据源、queryRunner核心对象、以及DAO层Service层关键对象 进行bean对象管理   实现了具体的业务代码，关键业务是AcoountServiceImpl中的transfer转账业务   当前进度存在的问题：没有实现事务  这会造成一个问题：当业务操作处理过程中，出现了问题，那么就不满足事务的一致性，一个扣钱了，另外一个人却没有加钱，这是非常严重的问题。 	  造成该问题的根本原因：   没有定义事务； 数据库链接对象不统一，进而造成数据库的操作不在同一个事务中。   解决方案：将数据库的CRUD操作的连接对象统一即可，具体来说三个步骤   通过ThreadLocal将当前线程和数据库连接对象绑定 定义事务的管理器，包含开启事务、提交事务、回滚事务、释放资源的方法 然后具体的执行业务的方法应当修改成如下方式  try &#123;  开启事务  执行业务代码  提交事务&#125; catch(Exception e)...</div></div></div></a><a class="pagination-related" href="/2024/11/13/2.Areas%F0%9F%8C%90/back-end-java/6.SSM/Spring/4.%20jdbcTemplate_%E4%BA%8B%E5%8A%A1_Spring5%E6%96%B0%E7%89%B9%E6%80%A7/" title="4. jdbcTemplate_事务_Spring5新特性"><div class="cover" style="background: var(--default-bg-color)"></div><div class="info text-center"><div class="info-1"><div class="info-item-1"><i class="far fa-calendar-alt fa-fw"></i> 2024-11-13</div><div class="info-item-2">4. jdbcTemplate_事务_Spring5新特性</div></div><div class="info-2"><div class="info-item-1">四、JdbcTemplate_事务_Spring5新特性4.1 JdbcTemplate4.1.1 JdbcTemplate概述spring当中的JdbcTemplate对原生的jdbc进行了简单封装，提供一些操作模板类，类似的对象还包括：  操作关系型数据库的：  JdbcTemplate  HibernateTemplate    操作nosql数据库的:  RedisTemplate   操作消息队列的：  JmsTemplate    4.1.2 搭建JdbcTemplate环境导入JdbcTemplate依赖，以及spring和mysql相关依赖  spring-tx是控制事务相关  &lt;dependencies&gt;    &lt;dependency&gt;        &lt;groupId&gt;org.springframework&lt;/groupId&gt;        &lt;artifactId&gt;spring-context&lt;/artifactId&gt;       ...</div></div></div></a><a class="pagination-related" href="/2024/11/13/2.Areas%F0%9F%8C%90/back-end-java/6.SSM/Spring/2.%20%E5%9F%BA%E4%BA%8E%E6%B3%A8%E8%A7%A3%E9%85%8D%E7%BD%AEIOC/" title="2. 基于注解配置IOC"><div class="cover" style="background: var(--default-bg-color)"></div><div class="info text-center"><div class="info-1"><div class="info-item-1"><i class="far fa-calendar-alt fa-fw"></i> 2024-11-13</div><div class="info-item-2">2. 基于注解配置IOC</div></div><div class="info-2"><div class="info-item-1">二、基于注解配置IOC2.1 IOC注解改进项目我们在上一章的基础上，基于注解来管理bean 对于原生的XML配置，我们可以思考里面对应的注解类别  创建bean对象：&lt;bean id&#x3D;”” class&#x3D;””&gt;   依赖注入：&lt;property&gt;等    作用范围：scope属性   生命周期：init &#x2F; destroy - method     &lt;bean id=&quot;userDao&quot; class=&quot;com.xq.dao.impl.UserDaoImpl&quot; scope=&quot;prototype&quot; init-method=&quot;init&quot; destroy-method=&quot;destroy&quot;&gt;	&lt;property name=&quot;&quot; value=&quot;&quot; | ref=&quot;&quot;&gt;&lt;/property&gt;&lt;/bean&gt;      2.1.1...</div></div></div></a></div></div></div><div class="aside-content" id="aside-content"><div class="card-widget card-info text-center"><div class="avatar-img"><img src="/img/loading.gif" data-original="/img/touxiang.jpg" onerror="this.onerror=null;this.src='/img/friend_404.gif'" alt="avatar"/></div><div class="author-info-name">yuezi</div><div class="author-info-description">积微者速成</div><div class="site-data"><a href="/archives/"><div class="headline">文章</div><div class="length-num">603</div></a><a href="/tags/"><div class="headline">标签</div><div class="length-num">61</div></a><a href="/categories/"><div class="headline">分类</div><div class="length-num">85</div></a></div><a id="card-info-btn" target="_blank" rel="noopener" href="https://github.com/yuezi2048"><i class="fab fa-github"></i><span>Follow Me</span></a><div class="card-info-social-icons"><a class="social-icon" href="https://githubfast.com/yuezi2048" target="_blank" title="Github"><i class="fab fa-github"></i></a><a class="social-icon" href="https://blog.csdn.net/qq_46345703" target="_blank" title="CSDN"><i class="fa fa-book-open"></i></a><a class="social-icon" href="https://qm.qq.com/cgi-bin/qm/qr?k=dD62GIPTf5-iS4UdSfJRy7NHwsrCh3-j" target="_blank" title="QQ"><i class="fab fa-qq"></i></a><a class="social-icon" href="mailto:joyLing@stumail.nwu.edu.cn" target="_blank" title="Email"><i class="fas fa-envelope-open-text"></i></a></div></div><div class="card-widget card-announcement"><div class="item-headline"><i class="fas fa-bullhorn fa-shake"></i><span>公告</span></div><div class="announcement_content">积微者速成</div></div><div class="sticky_layout"><div class="card-widget" id="card-toc"><div class="item-headline"><i class="fas fa-stream"></i><span>目录</span><span class="toc-percentage"></span></div><div class="toc-content"><ol class="toc"><li class="toc-item toc-level-1"><a class="toc-link" href="#%E4%B8%80%E3%80%81%E6%A6%82%E8%BF%B0-%E5%9F%BA%E4%BA%8EXML%E9%85%8D%E7%BD%AEIOC"><span class="toc-text">一、概述_基于XML配置IOC</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#1-1-Spring%E7%9A%84%E5%9F%BA%E6%9C%AC%E6%A6%82%E8%BF%B0"><span class="toc-text">1.1 Spring的基本概述</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#1-1-1-Spring%E6%98%AF%E4%BB%80%E4%B9%88"><span class="toc-text">1.1.1 Spring是什么</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#1-1-2-Spring%E7%9A%84%E4%BC%98%E5%8A%BF"><span class="toc-text">1.1.2 Spring的优势</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#1-1-3-Spring%E4%BD%93%E7%B3%BB"><span class="toc-text">1.1.3 Spring体系</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#1-2-%E8%80%A6%E5%90%88%E4%B8%8E%E8%A7%A3%E8%80%A6"><span class="toc-text">1.2 耦合与解耦</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#1-2-1-%E5%8F%8D%E5%B0%84%E8%A7%A3%E8%80%A6%E6%A1%88%E4%BE%8B"><span class="toc-text">1.2.1 反射解耦案例</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#1-2-1-1-%E5%9F%BA%E4%BA%8EJDBC%E7%9A%84%E8%80%A6%E5%90%88%E6%A1%88%E4%BE%8B%E6%90%AD%E5%BB%BA"><span class="toc-text">1.2.1.1 基于JDBC的耦合案例搭建</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#1-2-1-2-%E8%80%A6%E5%90%88%E5%88%86%E6%9E%90%E4%B8%8E%E8%A7%A3%E8%80%A6%E6%96%B9%E6%A1%88"><span class="toc-text">1.2.1.2 耦合分析与解耦方案</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#1-2-2-%E5%B7%A5%E5%8E%82%E8%A7%A3%E8%80%A6%E6%A1%88%E4%BE%8B"><span class="toc-text">1.2.2 工厂解耦案例</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#1-2-2-1-%E5%9F%BA%E4%BA%8EMVC%E7%9A%84%E8%80%A6%E5%90%88%E6%A1%88%E4%BE%8B%E6%90%AD%E5%BB%BA"><span class="toc-text">1.2.2.1 基于MVC的耦合案例搭建</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#1-2-2-2-%E8%80%A6%E5%90%88%E5%88%86%E6%9E%90%E4%B8%8E%E8%A7%A3%E8%80%A6%E6%96%B9%E6%A1%88"><span class="toc-text">1.2.2.2 耦合分析与解耦方案</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#1-2-2-3-%E5%A4%9A%E4%BE%8B%E5%88%9B%E5%BB%BA%E9%97%AE%E9%A2%98%E7%9A%84%E8%A7%A3%E5%86%B3%E6%96%B9%E6%A1%88"><span class="toc-text">1.2.2.3 多例创建问题的解决方案</span></a></li></ol></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#1-3-IOC%E6%A6%82%E5%BF%B5%E5%92%8C%E4%BD%BF%E7%94%A8"><span class="toc-text">1.3 IOC概念和使用</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#1-3-1-Spring%E7%8E%AF%E5%A2%83%E6%90%AD%E5%BB%BA%E5%BF%AB%E9%80%9F%E5%85%A5%E9%97%A8"><span class="toc-text">1.3.1 Spring环境搭建快速入门</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#1-3-2-%E7%BB%86%E8%8A%82%E2%80%94%E2%80%94ApplicationContext-BeanFactory"><span class="toc-text">1.3.2 细节——ApplicationContext_BeanFactory</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#1-4-Sprng%E5%AF%B9Bean%E7%9A%84%E7%AE%A1%E7%90%86%E6%96%B9%E5%BC%8F"><span class="toc-text">1.4 Sprng对Bean的管理方式&lt;bean&gt;</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#1-4-1-%E5%9F%BA%E4%BA%8E%E6%97%A0%E5%8F%82%E6%9E%84%E9%80%A0%E5%87%BD%E6%95%B0%E5%AE%9E%E4%BE%8B%E5%8C%96%EF%BC%88%E9%BB%98%E8%AE%A4%EF%BC%89"><span class="toc-text">1.4.1 基于无参构造函数实例化（默认）</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#1-4-2-%E4%BD%BF%E7%94%A8%E5%B7%A5%E5%8E%82%E6%99%AE%E9%80%9A%E6%96%B9%E6%B3%95%E5%AE%9E%E4%BE%8B%E5%8C%96%E5%AF%B9%E8%B1%A1"><span class="toc-text">1.4.2 使用工厂普通方法实例化对象</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#1-4-3-%E4%BD%BF%E7%94%A8%E5%B7%A5%E5%8E%82%E9%9D%99%E6%80%81%E6%96%B9%E6%B3%95%E5%AE%9E%E4%BE%8B%E5%8C%96%E5%AF%B9%E8%B1%A1"><span class="toc-text">1.4.3 使用工厂静态方法实例化对象</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#1-4-4-%E7%BB%86%E8%8A%82%E2%80%94%E2%80%94Bean%E5%AF%B9%E8%B1%A1%E7%9A%84%E5%B1%9E%E6%80%A7"><span class="toc-text">1.4.4 细节——Bean对象的属性</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#1-4-4-1-Bean%E7%9A%84%E4%BD%9C%E7%94%A8%E5%9F%9F-scope"><span class="toc-text">1.4.4.1 Bean的作用域 scope</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#1-4-4-2-Bean%E7%9A%84%E7%94%9F%E5%91%BD%E5%91%A8%E6%9C%9F-init-destroy"><span class="toc-text">1.4.4.2 Bean的生命周期 init&#x2F;destroy</span></a></li></ol></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#1-6-%E4%BE%9D%E8%B5%96%E6%B3%A8%E5%85%A5DI"><span class="toc-text">1.6 依赖注入DI</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#1-6-1-%E4%BD%BF%E7%94%A8Set%E6%96%B9%E6%B3%95%E6%B3%A8%E5%85%A5"><span class="toc-text">1.6.1 使用Set方法注入&lt;properties&gt;</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#1-6-2-%E6%9E%84%E9%80%A0%E5%87%BD%E6%95%B0%E6%B3%A8%E5%85%A5"><span class="toc-text">1.6.2 构造函数注入&lt;constructor-args&gt;</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#1-6-3-%E5%A4%8D%E6%9D%82%E7%B1%BB%E5%9E%8B%E6%95%B0%E6%8D%AE%E6%B3%A8%E5%85%A5"><span class="toc-text">1.6.3 复杂类型数据注入</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#1-7-%E7%BB%BC%E5%90%88%E6%A1%88%E4%BE%8B%E2%80%94%E2%80%94%E5%9F%BA%E4%BA%8EXML%E9%85%8D%E7%BD%AEIOC"><span class="toc-text">1.7 综合案例——基于XML配置IOC</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#1-7-1-%E9%A1%B9%E7%9B%AE%E9%AA%A8%E6%9E%B6%E5%BF%AB%E9%80%9F%E6%90%AD%E5%BB%BA"><span class="toc-text">1.7.1 项目骨架快速搭建</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#1-7-2-%E5%9F%BA%E4%BA%8ESpring%E8%BF%9B%E8%A1%8C%E4%BE%9D%E8%B5%96%E7%AE%A1%E7%90%86"><span class="toc-text">1.7.2 基于Spring进行依赖管理</span></a></li></ol></li></ol></li></ol></div></div><div class="card-widget card-recent-post"><div class="item-headline"><i class="fas fa-history"></i><span>最新文章</span></div><div class="aside-list"><div class="aside-list-item no-cover"><div class="content"><a class="title" href="/2025/10/31/Excalidraw/Drawing%202024-11-01%2015.37.37.excalidraw/" title="Drawing 2024-11-01 15.37.37.excalidraw">Drawing 2024-11-01 15.37.37.excalidraw</a><time datetime="2025-10-31T04:19:26.621Z" title="发表于 2025-10-31 12:19:26">2025-10-31</time></div></div><div class="aside-list-item no-cover"><div class="content"><a class="title" href="/2025/10/31/2.Areas%F0%9F%8C%90/01.project/condefather/yupao/back-end/7.%E4%BC%98%E5%8C%96%E4%B8%BB%E9%A1%B5%E6%80%A7%E8%83%BD-%E4%BC%98%E5%8C%96%E6%89%B9%E9%87%8F%E5%AF%BC%E5%85%A5%E6%95%B0%E6%8D%AE/" title="7.优化主页性能-优化批量导入数据">7.优化主页性能-优化批量导入数据</a><time datetime="2025-10-31T04:19:26.102Z" title="发表于 2025-10-31 12:19:26">2025-10-31</time></div></div><div class="aside-list-item no-cover"><div class="content"><a class="title" href="/2025/10/31/2.Areas%F0%9F%8C%90/02.%E9%9D%A2%E7%BB%8F%E8%AE%B0%E5%BD%95/MySQL/81.%E4%BB%80%E4%B9%88%E6%98%AF%E6%B8%B8%E6%A0%87Cursor%E5%88%86%E9%A1%B5_%E5%AF%B9%E6%AF%94%E4%BC%A0%E7%BB%9FLIMIT_OFFSET%E5%88%86%E9%A1%B5%E7%9A%84%E4%BC%98%E5%8A%BF%E6%98%AF%E4%BB%80%E4%B9%88/" title="81.什么是游标Cursor分页_对比传统LIMIT_OFFSET分页的优势是什么">81.什么是游标Cursor分页_对比传统LIMIT_OFFSET分页的优势是什么</a><time datetime="2025-10-31T04:14:27.000Z" title="发表于 2025-10-31 12:14:27">2025-10-31</time></div></div><div class="aside-list-item no-cover"><div class="content"><a class="title" href="/2025/10/31/2.Areas%F0%9F%8C%90/02.%E9%9D%A2%E7%BB%8F%E8%AE%B0%E5%BD%95/MySQL/80.%E5%85%A8%E9%87%8F%E5%90%8C%E6%AD%A5%E5%92%8C%E5%A2%9E%E9%87%8F%E5%90%8C%E6%AD%A5%E5%90%84%E8%87%AA%E4%BC%98%E7%BC%BA%E7%82%B9/" title="80.全量同步和增量同步各自优缺点">80.全量同步和增量同步各自优缺点</a><time datetime="2025-10-31T04:13:32.000Z" title="发表于 2025-10-31 12:13:32">2025-10-31</time></div></div><div class="aside-list-item no-cover"><div class="content"><a class="title" href="/2025/10/31/2.Areas%F0%9F%8C%90/02.%E9%9D%A2%E7%BB%8F%E8%AE%B0%E5%BD%95/MySQL/79.%E4%BB%80%E4%B9%88%E6%98%AF%E6%89%B9%E9%87%8F%E6%95%B0%E6%8D%AE%E5%85%A5%E5%BA%93_%E7%9B%B8%E6%AF%94%E5%8D%95%E6%9D%A1%E6%8F%92%E5%85%A5%E4%BC%98%E5%8A%BF/" title="79.什么是批量数据入库_相比单条插入优势">79.什么是批量数据入库_相比单条插入优势</a><time datetime="2025-10-31T04:03:26.000Z" title="发表于 2025-10-31 12:03:26">2025-10-31</time></div></div></div></div></div></div></main><footer id="footer" style="background-image: url(/img/default.png);"><div id="footer-wrap"><div class="copyright">&copy;2019 - 2025 By yuezi</div><div class="framework-info"><span>框架 </span><a target="_blank" rel="noopener" href="https://hexo.io">Hexo 8.0.0</a><span class="footer-separator">|</span><span>主题 </span><a target="_blank" rel="noopener" href="https://github.com/jerryc127/hexo-theme-butterfly">Butterfly 5.3.5</a></div></div></footer></div><div id="rightside"><div id="rightside-config-hide"><button id="readmode" type="button" title="阅读模式"><i class="fas fa-book-open"></i></button><button id="darkmode" type="button" title="日间和夜间模式切换"><i class="fas fa-adjust"></i></button><button id="hide-aside-btn" type="button" title="单栏和双栏切换"><i class="fas fa-arrows-alt-h"></i></button></div><div id="rightside-config-show"><button id="rightside-config" type="button" title="设置"><i class="fas fa-cog fa-spin"></i></button><button class="close" id="mobile-toc-button" type="button" title="目录"><i class="fas fa-list-ul"></i></button><button id="go-up" type="button" title="回到顶部"><span class="scroll-percent"></span><i class="fas fa-arrow-up"></i></button></div></div><div><script src="/js/utils.js"></script><script src="/js/main.js"></script><div class="js-pjax"></div><script id="canvas_nest" defer="defer" color="0,0,255" opacity="0.7" zIndex="-1" count="99" mobile="false" src="https://cdn.jsdelivr.net/npm/butterfly-extsrc/dist/canvas-nest.min.js"></script><script async data-pjax src="//busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js"></script><div id="algolia-search"><div class="search-dialog"><nav class="search-nav"><span class="search-dialog-title">搜索</span><button class="search-close-button"><i class="fas fa-times"></i></button></nav><div class="search-wrap"><div id="algolia-search-input"></div><hr/><div id="algolia-search-results"><div id="algolia-hits"></div><div id="algolia-pagination"></div><div id="algolia-info"><div class="algolia-stats"></div><div class="algolia-poweredBy"></div></div></div></div></div><div id="search-mask"></div><script src="https://cdn.jsdelivr.net/npm/algoliasearch/dist/lite/builds/browser.umd.min.js"></script><script src="https://cdn.jsdelivr.net/npm/instantsearch.js/dist/instantsearch.production.min.js"></script><script src="/js/search/algolia.js"></script></div></div>
        <style>
            [bg-lazy] {
                background-image: none !important;
                background-color: #eee !important;
            }
        </style>
        <script>
            window.imageLazyLoadSetting = {
                isSPA: false,
                preloadRatio: 1,
                processImages: null,
            };
        </script><script>window.addEventListener("load",function(){var t=/\.(gif|jpg|jpeg|tiff|png)$/i,r=/^data:image\/[a-z\d\-\.\+]+;base64,/;Array.prototype.slice.call(document.querySelectorAll("img[data-original]")).forEach(function(a){var e=a.parentNode;"A"===e.tagName&&(t.test(e.href)||r.test(e.href))&&(e.href=a.dataset.original)})});</script><script>(r=>{r.imageLazyLoadSetting.processImages=t;var a=r.imageLazyLoadSetting.isSPA,o=r.imageLazyLoadSetting.preloadRatio||1,d=i();function i(){var t=Array.prototype.slice.call(document.querySelectorAll("img[data-original]")),e=Array.prototype.slice.call(document.querySelectorAll("[bg-lazy]"));return t.concat(e)}function t(t){(a||t)&&(d=i());for(var e,n=0;n<d.length;n++)0<=(e=(e=d[n]).getBoundingClientRect()).bottom&&0<=e.left&&e.top<=(r.innerHeight*o||document.documentElement.clientHeight*o)&&(()=>{var t,e,a,o,i=d[n];e=function(){d=d.filter(function(t){return i!==t}),r.imageLazyLoadSetting.onImageLoaded&&r.imageLazyLoadSetting.onImageLoaded(i)},(t=i).dataset.loaded||(t.hasAttribute("bg-lazy")?(t.removeAttribute("bg-lazy"),e&&e()):(a=new Image,o=t.getAttribute("data-original"),a.onload=function(){t.src=o,t.removeAttribute("data-original"),t.setAttribute("data-loaded",!0),e&&e()},a.onerror=function(){t.removeAttribute("data-original"),t.setAttribute("data-loaded",!1),t.src=o},t.src!==o&&(a.src=o)))})()}function e(){clearTimeout(t.tId),t.tId=setTimeout(t,500)}t(),document.addEventListener("scroll",e),r.addEventListener("resize",e),r.addEventListener("orientationchange",e)})(this);</script></body></html>