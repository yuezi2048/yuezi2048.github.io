<!DOCTYPE html><html lang="zh-CN" data-theme="light"><head><meta charset="UTF-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1.0,viewport-fit=cover"><title>5. Servlet | yuezi</title><meta name="author" content="yuezi"><meta name="copyright" content="yuezi"><meta name="format-detection" content="telephone=no"><meta name="theme-color" content="#ffffff"><meta name="description" content="第五章 Servlet1. Servlet简介首先明确动态资源和静态资源的概念（买蛋糕的例子，现有和现做的区别） 静态资源：无需通过代码运行生成的资源，即在运行前就写好的资源，包括前端三大件、img等多媒体文件 动态资源：需要通过代码运行生成的资源，即程序运行前无法确定的数据，需要运行时动态生成，包括Servlet、Thymeleaf  注：动态资源是强调运行时动态生成数据，而不是视图上的动画效果">
<meta property="og:type" content="article">
<meta property="og:title" content="5. Servlet">
<meta property="og:url" content="https://yuezi2048.github.io/2024/10/02/2.Areas%F0%9F%8C%90/back-end-java/4.JavaWeb/5.%20Servlet/index.html">
<meta property="og:site_name" content="yuezi">
<meta property="og:description" content="第五章 Servlet1. Servlet简介首先明确动态资源和静态资源的概念（买蛋糕的例子，现有和现做的区别） 静态资源：无需通过代码运行生成的资源，即在运行前就写好的资源，包括前端三大件、img等多媒体文件 动态资源：需要通过代码运行生成的资源，即程序运行前无法确定的数据，需要运行时动态生成，包括Servlet、Thymeleaf  注：动态资源是强调运行时动态生成数据，而不是视图上的动画效果">
<meta property="og:locale" content="zh_CN">
<meta property="og:image" content="https://yuezi2048.github.io/img/touxiang.jpg">
<meta property="article:published_time" content="2024-10-02T14:43:21.000Z">
<meta property="article:modified_time" content="2024-10-02T14:43:21.000Z">
<meta property="article:author" content="yuezi">
<meta property="article:tag" content="4.JavaWeb">
<meta name="twitter:card" content="summary">
<meta name="twitter:image" content="https://yuezi2048.github.io/img/touxiang.jpg"><script type="application/ld+json">{
  "@context": "https://schema.org",
  "@type": "BlogPosting",
  "headline": "5. Servlet",
  "url": "https://yuezi2048.github.io/2024/10/02/2.Areas%F0%9F%8C%90/back-end-java/4.JavaWeb/5.%20Servlet/",
  "image": "https://yuezi2048.github.io/img/touxiang.jpg",
  "datePublished": "2024-10-02T14:43:21.000Z",
  "dateModified": "2024-10-02T14:43:21.000Z",
  "author": [
    {
      "@type": "Person",
      "name": "yuezi",
      "url": "https://yuezi2048.github.io/"
    }
  ]
}</script><link rel="shortcut icon" href="/img/favicon.png"><link rel="canonical" href="https://yuezi2048.github.io/2024/10/02/2.Areas%F0%9F%8C%90/back-end-java/4.JavaWeb/5.%20Servlet/index.html"><link rel="preconnect" href="//cdn.jsdelivr.net"/><link rel="preconnect" href="//hm.baidu.com"/><link rel="preconnect" href="//busuanzi.ibruce.info"/><link rel="stylesheet" href="/css/index.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fortawesome/fontawesome-free/css/all.min.css"><script>
    (() => {
      
    const saveToLocal = {
      set: (key, value, ttl) => {
        if (!ttl) return
        const expiry = Date.now() + ttl * 86400000
        localStorage.setItem(key, JSON.stringify({ value, expiry }))
      },
      get: key => {
        const itemStr = localStorage.getItem(key)
        if (!itemStr) return undefined
        const { value, expiry } = JSON.parse(itemStr)
        if (Date.now() > expiry) {
          localStorage.removeItem(key)
          return undefined
        }
        return value
      }
    }

    window.btf = {
      saveToLocal,
      getScript: (url, attr = {}) => new Promise((resolve, reject) => {
        const script = document.createElement('script')
        script.src = url
        script.async = true
        Object.entries(attr).forEach(([key, val]) => script.setAttribute(key, val))
        script.onload = script.onreadystatechange = () => {
          if (!script.readyState || /loaded|complete/.test(script.readyState)) resolve()
        }
        script.onerror = reject
        document.head.appendChild(script)
      }),
      getCSS: (url, id) => new Promise((resolve, reject) => {
        const link = document.createElement('link')
        link.rel = 'stylesheet'
        link.href = url
        if (id) link.id = id
        link.onload = link.onreadystatechange = () => {
          if (!link.readyState || /loaded|complete/.test(link.readyState)) resolve()
        }
        link.onerror = reject
        document.head.appendChild(link)
      }),
      addGlobalFn: (key, fn, name = false, parent = window) => {
        if (!false && key.startsWith('pjax')) return
        const globalFn = parent.globalFn || {}
        globalFn[key] = globalFn[key] || {}
        globalFn[key][name || Object.keys(globalFn[key]).length] = fn
        parent.globalFn = globalFn
      }
    }
  
      
      const activateDarkMode = () => {
        document.documentElement.setAttribute('data-theme', 'dark')
        if (document.querySelector('meta[name="theme-color"]') !== null) {
          document.querySelector('meta[name="theme-color"]').setAttribute('content', '#0d0d0d')
        }
      }
      const activateLightMode = () => {
        document.documentElement.setAttribute('data-theme', 'light')
        if (document.querySelector('meta[name="theme-color"]') !== null) {
          document.querySelector('meta[name="theme-color"]').setAttribute('content', '#ffffff')
        }
      }

      btf.activateDarkMode = activateDarkMode
      btf.activateLightMode = activateLightMode

      const theme = saveToLocal.get('theme')
    
          theme === 'dark' ? activateDarkMode() : theme === 'light' ? activateLightMode() : null
        
      
      const asideStatus = saveToLocal.get('aside-status')
      if (asideStatus !== undefined) {
        document.documentElement.classList.toggle('hide-aside', asideStatus === 'hide')
      }
    
      
    const detectApple = () => {
      if (/iPad|iPhone|iPod|Macintosh/.test(navigator.userAgent)) {
        document.documentElement.classList.add('apple')
      }
    }
    detectApple()
  
    })()
  </script><script>var _hmt = _hmt || [];
(function() {
  var hm = document.createElement("script");
  hm.src = "https://hm.baidu.com/hm.js?bfb48b678d82bea9f9cc9d59227767e4";
  var s = document.getElementsByTagName("script")[0];
  s.parentNode.insertBefore(hm, s);
})();
btf.addGlobalFn('pjaxComplete', () => {
  _hmt.push(['_trackPageview',window.location.pathname])
}, 'baidu_analytics')
</script><script>const GLOBAL_CONFIG = {
  root: '/',
  algolia: {"appId":"FPH6F2TOJL","apiKey":"06d9ea26c803ba912b4d8e13404ed34d","indexName":"blog","hitsPerPage":6,"languages":{"input_placeholder":"搜索","hits_empty":"未找到符合您查询的内容：${query}","hits_stats":"找到 ${hits} 条结果，耗时 ${time} 毫秒"}},
  localSearch: undefined,
  translate: undefined,
  highlight: {"plugin":"highlight.js","highlightCopy":true,"highlightLang":true,"highlightHeightLimit":350,"highlightFullpage":false,"highlightMacStyle":false},
  copy: {
    success: '复制成功',
    error: '复制失败',
    noSupport: '浏览器不支持'
  },
  relativeDate: {
    homepage: false,
    post: false
  },
  runtime: '天',
  dateSuffix: {
    just: '刚刚',
    min: '分钟前',
    hour: '小时前',
    day: '天前',
    month: '个月前'
  },
  copyright: undefined,
  lightbox: 'null',
  Snackbar: undefined,
  infinitegrid: {
    js: 'https://cdn.jsdelivr.net/npm/@egjs/infinitegrid/dist/infinitegrid.min.js',
    buttonText: '加载更多'
  },
  isPhotoFigcaption: false,
  islazyloadPlugin: false,
  isAnchor: false,
  percent: {
    toc: true,
    rightside: false,
  },
  autoDarkmode: false
}</script><script id="config-diff">var GLOBAL_CONFIG_SITE = {
  title: '5. Servlet',
  isHighlightShrink: false,
  isToc: true,
  pageType: 'post'
}</script><link rel="stylesheet" href="/css/backgound.css"><meta name="generator" content="Hexo 8.0.0"></head><body><div id="sidebar"><div id="menu-mask"></div><div id="sidebar-menus"><div class="avatar-img text-center"><img src="/img/loading.gif" data-original="/img/touxiang.jpg" onerror="this.onerror=null;this.src='/img/friend_404.gif'" alt="avatar"/></div><div class="site-data text-center"><a href="/archives/"><div class="headline">文章</div><div class="length-num">603</div></a><a href="/tags/"><div class="headline">标签</div><div class="length-num">61</div></a><a href="/categories/"><div class="headline">分类</div><div class="length-num">85</div></a></div><div class="menus_items"><div class="menus_item"><a class="site-page" href="/"><i class="fa-fw fas fa-home"></i><span> 主页</span></a></div><div class="menus_item"><span class="site-page group"><i class="fa-fw fa fa-graduation-cap"></i><span> 博文</span><i class="fas fa-chevron-down"></i></span><ul class="menus_item_child"><li><a class="site-page child" href="/categories/"><i class="fa-fw fa fa-archive"></i><span> 分类</span></a></li><li><a class="site-page child" href="/tags/"><i class="fa-fw fa fa-tags"></i><span> 标签</span></a></li><li><a class="site-page child" href="/archives/"><i class="fa-fw fa fa-folder-open"></i><span> 归档</span></a></li></ul></div><div class="menus_item"><a class="site-page" href="/about/"><i class="fa-fw fas fa-heart"></i><span> 关于笔者</span></a></div></div></div></div><div class="post" id="body-wrap"><header class="post-bg" id="page-header" style="background-image: url(/img/default.png);"><nav id="nav"><span id="blog-info"><a class="nav-site-title" href="/"><span class="site-name">yuezi</span></a><a class="nav-page-title" href="/"><span class="site-name">5. Servlet</span></a></span><div id="menus"><div id="search-button"><span class="site-page social-icon search"><i class="fas fa-search fa-fw"></i><span> 搜索</span></span></div><div class="menus_items"><div class="menus_item"><a class="site-page" href="/"><i class="fa-fw fas fa-home"></i><span> 主页</span></a></div><div class="menus_item"><span class="site-page group"><i class="fa-fw fa fa-graduation-cap"></i><span> 博文</span><i class="fas fa-chevron-down"></i></span><ul class="menus_item_child"><li><a class="site-page child" href="/categories/"><i class="fa-fw fa fa-archive"></i><span> 分类</span></a></li><li><a class="site-page child" href="/tags/"><i class="fa-fw fa fa-tags"></i><span> 标签</span></a></li><li><a class="site-page child" href="/archives/"><i class="fa-fw fa fa-folder-open"></i><span> 归档</span></a></li></ul></div><div class="menus_item"><a class="site-page" href="/about/"><i class="fa-fw fas fa-heart"></i><span> 关于笔者</span></a></div></div><div id="toggle-menu"><span class="site-page"><i class="fas fa-bars fa-fw"></i></span></div></div></nav><div id="post-info"><h1 class="post-title">5. Servlet</h1><div id="post-meta"><div class="meta-firstline"><span class="post-meta-date"><i class="far fa-calendar-alt fa-fw post-meta-icon"></i><span class="post-meta-label">发表于</span><time class="post-meta-date-created" datetime="2024-10-02T14:43:21.000Z" title="发表于 2024-10-02 22:43:21">2024-10-02</time><span class="post-meta-separator">|</span><i class="fas fa-history fa-fw post-meta-icon"></i><span class="post-meta-label">更新于</span><time class="post-meta-date-updated" datetime="2024-10-02T14:43:21.000Z" title="更新于 2024-10-02 22:43:21">2024-10-02</time></span><span class="post-meta-categories"><span class="post-meta-separator">|</span><i class="fas fa-inbox fa-fw post-meta-icon"></i><a class="post-meta-categories" href="/categories/2-Areas%F0%9F%8C%90/">2.Areas🌐</a><i class="fas fa-angle-right post-meta-separator"></i><i class="fas fa-inbox fa-fw post-meta-icon"></i><a class="post-meta-categories" href="/categories/2-Areas%F0%9F%8C%90/back-end-java/">back-end-java</a><i class="fas fa-angle-right post-meta-separator"></i><i class="fas fa-inbox fa-fw post-meta-icon"></i><a class="post-meta-categories" href="/categories/2-Areas%F0%9F%8C%90/back-end-java/4-JavaWeb/">4.JavaWeb</a></span></div><div class="meta-secondline"><span class="post-meta-separator">|</span><span class="post-meta-wordcount"><i class="far fa-file-word fa-fw post-meta-icon"></i><span class="post-meta-label">总字数:</span><span class="word-count">16k</span><span class="post-meta-separator">|</span><i class="far fa-clock fa-fw post-meta-icon"></i><span class="post-meta-label">阅读时长:</span><span>70分钟</span></span><span class="post-meta-separator">|</span><span class="post-meta-pv-cv" id="" data-flag-title=""><i class="far fa-eye fa-fw post-meta-icon"></i><span class="post-meta-label">浏览量:</span><span id="busuanzi_value_page_pv"><i class="fa-solid fa-spinner fa-spin"></i></span></span></div></div></div></header><main class="layout" id="content-inner"><div id="post"><article class="container post-content" id="article-container"><h1 id="第五章-Servlet"><a href="#第五章-Servlet" class="headerlink" title="第五章 Servlet"></a>第五章 Servlet</h1><h2 id="1-Servlet简介"><a href="#1-Servlet简介" class="headerlink" title="1. Servlet简介"></a>1. Servlet简介</h2><p>首先明确<code>动态资源</code>和<code>静态资源</code>的概念（买蛋糕的例子，现有和现做的区别）</p>
<p>静态资源：无需通过代码运行生成的资源，即在运行前就写好的资源，包括前端三大件、img等多媒体文件</p>
<p>动态资源：需要通过代码运行生成的资源，即程序运行前无法确定的数据，需要运行时动态生成，包括Servlet、Thymeleaf</p>
<blockquote>
<p>注：动态资源是强调运行时动态生成数据，而不是视图上的动画效果或者是简单的人机交互效果</p>
</blockquote>
<p>接下来引出我们的动态资源——<code>Servlet</code></p>
<ul>
<li>Servlet（<code>Server applet</code>）是运行在服务端（Tomcat）的Java小程序，由sun公司定义动态资源规范，代码层面上Servlet就是一个<code>接口</code></li>
<li>作用<ul>
<li>接收、处理用户端请求，并响应给浏览器相关的<code>动态资源</code>。因此Servlet常被当做Controller控制器<ul>
<li>Servlet运行在服务端，需要依靠WEB项目，并且在Tomcat这样的服务容器中运行</li>
</ul>
</li>
</ul>
</li>
</ul>
<p>为何要存在这样一个组件？用生活例子来说明</p>
<ul>
<li>我们不能完全通过Java类来接收处理用户请求，因此需要一个这样能处理客户端请求并作出响应的规范<code>Servlet</code></li>
</ul>
<p><img src="/img/loading.gif" data-original="https://yuezi-1308313119.cos.ap-guangzhou.myqcloud.com/typora-user-images%2Fimage-20240901192902326.png" alt="image-20240901192902326">	</p>
<p>前后端请求响应与<code>HttpServletRequest</code>和<code>HttpServletResponse</code>之间的对应关系</p>
<ul>
<li>请求时，请求报文到Servlet容器里就消化成一个HttpServletRequest类，供service方法使用</li>
<li>而service方法构建好HttpServletResponse后，Servlet容器将其构建为一个报文再响应回给前端</li>
</ul>
<p><img src="/img/loading.gif" data-original="https://yuezi-1308313119.cos.ap-guangzhou.myqcloud.com/typora-user-images%2Fimage-20240901193133727.png" alt="image-20240901193133727">	</p>
<h2 id="2-Servlet开发流程-验证注册案例"><a href="#2-Servlet开发流程-验证注册案例" class="headerlink" title="2. Servlet开发流程(验证注册案例)"></a>2. Servlet开发流程(验证注册案例)</h2><blockquote>
<p>根据上面的演示图，立马通过Servlet技术实现一个小目标：</p>
<p><strong>客户端注册时发送请求到服务端，携带数据username，服务端检查username是否为atguigu，是返回yes，不是返回no，并将该内容作为报文响应发送给客户端</strong></p>
</blockquote>
<ul>
<li>Step1：首先创建一个module，按照我之前写的关于Tomcat的内容搭建好WEB项目环境</li>
<li>Step2：开发UserServlet，用于作为User相关的Controller<ul>
<li>Servlet继承<code>HttpServlet</code>类，并重写service方法用于处理用户请求</li>
<li>其中<code>HttpServletRequest</code>和<code>HttpServletResponse </code>代表请求和响应对象</li>
<li>Servlet对象的<code>生命周期</code>(创建,初始化,处理服务,销毁)是由tomcat管理的,无需我们自己new</li>
<li>HttpServletRequest HttpServletResponse 两个对象也是有tomcat负责转换,在调用service方法时传入给我们用的</li>
</ul>
</li>
</ul>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="keyword">package</span> com.atguigu.servlet;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> jakarta.servlet.Servlet;</span><br><span class="line"><span class="keyword">import</span> jakarta.servlet.ServletException;</span><br><span class="line"><span class="keyword">import</span> jakarta.servlet.http.HttpServlet;</span><br><span class="line"><span class="keyword">import</span> jakarta.servlet.http.HttpServletRequest;</span><br><span class="line"><span class="keyword">import</span> jakarta.servlet.http.HttpServletResponse;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> java.io.IOException;</span><br><span class="line"><span class="keyword">import</span> java.io.PrintWriter;</span><br><span class="line"></span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * Servlet开发流程</span></span><br><span class="line"><span class="comment"> * 1. 创建javaWeb项目，添加tomcat为项目的依赖（data structure中设置）</span></span><br><span class="line"><span class="comment"> * 2. 重写service方法service(HttpServletRequest req, HttpServletResponse resp)</span></span><br><span class="line"><span class="comment"> * 3. 在service中定义业务处理代码</span></span><br><span class="line"><span class="comment"> * 4. web.xml中配置servlet对应的请求映射路径</span></span><br><span class="line"><span class="comment"> *</span></span><br><span class="line"><span class="comment"> * 问题</span></span><br><span class="line"><span class="comment"> * 1. servlet-api.jar 导入问题</span></span><br><span class="line"><span class="comment"> *      servlet-api编码时需要，而服务器运行的时候由Tmocat提供即可</span></span><br><span class="line"><span class="comment"> *      因此我们JavaWeb项目构建build的时候无需携带Servlet-api jar包（作用域provided编译使用 但构建不载入）</span></span><br><span class="line"><span class="comment"> * 2. Content-Type 响应头问题</span></span><br><span class="line"><span class="comment"> *      MIME类型响应头————媒体类型，文件类型，响应的数据类型</span></span><br><span class="line"><span class="comment"> *      MIME类型用于告诉客户端响应的数据是什么类型，客户端根据类型来解析响应体（默认text/html）</span></span><br><span class="line"><span class="comment"> *</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@author</span> yuezi2048</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@version</span> 1.0</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">UserServlet</span> <span class="keyword">extends</span> <span class="title class_">HttpServlet</span> &#123;</span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="keyword">protected</span> <span class="keyword">void</span> <span class="title function_">service</span><span class="params">(HttpServletRequest req, HttpServletResponse resp)</span> <span class="keyword">throws</span> ServletException, IOException &#123;</span><br><span class="line">        <span class="comment">// 1. 从request对象中请求任何信息（username参数）</span></span><br><span class="line">        <span class="type">String</span> <span class="variable">username</span> <span class="operator">=</span> req.getParameter(<span class="string">&quot;username&quot;</span>);<span class="comment">// 根据参数名获得参数值（无论get/post，只要是键值对就可以）</span></span><br><span class="line"></span><br><span class="line">        <span class="comment">// 2. 处理业务</span></span><br><span class="line">        <span class="type">String</span> <span class="variable">info</span> <span class="operator">=</span> <span class="string">&quot;&lt;h1&gt;yes&lt;/h1&gt;&quot;</span>;</span><br><span class="line">        <span class="keyword">if</span> (!<span class="string">&quot;atguigu&quot;</span>.equals(username)) &#123;</span><br><span class="line">            info = <span class="string">&quot;&lt;h1&gt;no&lt;/h1&gt;&quot;</span>;</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        <span class="comment">// 3. 将响应的数据放入response中</span></span><br><span class="line">        <span class="comment">// 应当设置Content-Type响应头</span></span><br><span class="line"><span class="comment">//        resp.setHeader(&quot;Content-Type&quot;, &quot;text/html&quot;);</span></span><br><span class="line">        resp.setContentType(<span class="string">&quot;text/html&quot;</span>);</span><br><span class="line">        <span class="type">PrintWriter</span> <span class="variable">writer</span> <span class="operator">=</span> resp.getWriter(); <span class="comment">// 向响应体写入打印字符串的字符流</span></span><br><span class="line">        writer.write(info);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<ul>
<li>Step3：因为Servlet作为动态资源并不是实际存在的文件，因此要获取到该资源，需要配置<code>请求映射路径</code>到web.xml（后续可通过注解完成该操作）要点<ul>
<li>配置<code>servlet</code>元素<ul>
<li><code>servlet-name</code>：Servlet的别名，用于后续在<code>servlet-mapping</code>标签定位请求映射路径</li>
<li><code>servlet-class</code> ：告知Tomcat需要实例化的类，好让Tomcat反射出来</li>
</ul>
</li>
<li>配置<code>servlet-mapping</code>元素<ul>
<li><code>servlet-name</code>：匹配servlet中的别名</li>
<li><code>url-pattern</code>：定义servlet的请求<code>映射路径</code>，支持通配写法：<ul>
<li>&#x2F;        表示通配所有资源,不包括jsp文件</li>
<li>&#x2F;*      表示通配所有资源,包括jsp文件</li>
<li>&#x2F;a&#x2F;*     匹配所有以a前缀的映射路径</li>
<li>*.action 匹配所有以action为后缀的映射路径</li>
</ul>
</li>
</ul>
</li>
</ul>
</li>
</ul>
<blockquote>
<p>注：一个servlet可以有多个url-pattern，但多个servlet不能享有同一个url-pattern</p>
</blockquote>
<p><img src="/img/loading.gif" data-original="https://yuezi-1308313119.cos.ap-guangzhou.myqcloud.com/typora-user-images%2Fimage-20240901201633095.png" alt="image-20240901201633095">	</p>
<p>注：<code>请求上下文路径和磁盘的路径</code>之间的关系，再次强调。</p>
<p><img src="/img/loading.gif" data-original="https://yuezi-1308313119.cos.ap-guangzhou.myqcloud.com/typora-user-images%2Fimage-20240901202955551.png" alt="image-20240901202955551">	</p>
<figure class="highlight xml"><table><tr><td class="code"><pre><span class="line"><span class="meta">&lt;?xml version=<span class="string">&quot;1.0&quot;</span> encoding=<span class="string">&quot;UTF-8&quot;</span>?&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">web-app</span> <span class="attr">xmlns</span>=<span class="string">&quot;http://xmlns.jcp.org/xml/ns/javaee&quot;</span></span></span><br><span class="line"><span class="tag">         <span class="attr">xmlns:xsi</span>=<span class="string">&quot;http://www.w3.org/2001/XMLSchema-instance&quot;</span></span></span><br><span class="line"><span class="tag">         <span class="attr">xsi:schemaLocation</span>=<span class="string">&quot;http://xmlns.jcp.org/xml/ns/javaee http://xmlns.jcp.org/xml/ns/javaee/web-app_4_0.xsd&quot;</span></span></span><br><span class="line"><span class="tag">         <span class="attr">version</span>=<span class="string">&quot;4.0&quot;</span>&gt;</span></span><br><span class="line">    <span class="comment">&lt;!--</span></span><br><span class="line"><span class="comment">        配置Servlet，并起一个别名</span></span><br><span class="line"><span class="comment">        servlet-class用于告知tomcat需要实例化的Servlet类(反射技术)</span></span><br><span class="line"><span class="comment">        servlet-name用于关联请求的映射路径</span></span><br><span class="line"><span class="comment">    --&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">servlet</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">servlet-name</span>&gt;</span>userServlet<span class="tag">&lt;/<span class="name">servlet-name</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">servlet-class</span>&gt;</span>com.atguigu.servlet.UserServlet<span class="tag">&lt;/<span class="name">servlet-class</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">servlet</span>&gt;</span></span><br><span class="line"></span><br><span class="line">    <span class="tag">&lt;<span class="name">servlet-mapping</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">servlet-name</span>&gt;</span>userServlet<span class="tag">&lt;/<span class="name">servlet-name</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">url-pattern</span>&gt;</span>/userServlet<span class="tag">&lt;/<span class="name">url-pattern</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">servlet-mapping</span>&gt;</span></span><br><span class="line"></span><br><span class="line">    <span class="comment">&lt;!--</span></span><br><span class="line"><span class="comment">        一个servlet-name可以同时对应多个url-pattern</span></span><br><span class="line"><span class="comment">        一个servlet标签可以对应多个servlet-mapping标签</span></span><br><span class="line"><span class="comment"></span></span><br><span class="line"><span class="comment">        url-pattern</span></span><br><span class="line"><span class="comment">            1. 精确匹配</span></span><br><span class="line"><span class="comment">                /servlet1</span></span><br><span class="line"><span class="comment">            2. 模糊匹配</span></span><br><span class="line"><span class="comment">                *作为通配符，*在哪里，哪里就是模糊的</span></span><br><span class="line"><span class="comment">                /       匹配全部，不包含jsp文件</span></span><br><span class="line"><span class="comment">                /*      匹配全部，包含jsp文件</span></span><br><span class="line"><span class="comment">                /a/*    匹配前缀后缀模糊（以a开头的）</span></span><br><span class="line"><span class="comment">                *.action 匹配后缀，前缀模糊（前面的斜线要去掉 否则匹配全部）</span></span><br><span class="line"><span class="comment">    --&gt;</span></span><br><span class="line"><span class="comment">&lt;!--    &lt;servlet&gt;--&gt;</span></span><br><span class="line"><span class="comment">&lt;!--        &lt;servlet-name&gt;servlet1&lt;/servlet-name&gt;--&gt;</span></span><br><span class="line"><span class="comment">&lt;!--        &lt;servlet-class&gt;com.atguigu.servlet.Servlet1&lt;/servlet-class&gt;--&gt;</span></span><br><span class="line"><span class="comment">&lt;!--    &lt;/servlet&gt;--&gt;</span></span><br><span class="line">    </span><br><span class="line"><span class="comment">&lt;!--    &lt;servlet-mapping&gt;--&gt;</span></span><br><span class="line"><span class="comment">&lt;!--        &lt;servlet-name&gt;servlet1&lt;/servlet-name&gt;--&gt;</span></span><br><span class="line"><span class="comment">&lt;!--        &lt;url-pattern&gt;/s1&lt;/url-pattern&gt;--&gt;</span></span><br><span class="line"><span class="comment">&lt;!--    &lt;/servlet-mapping&gt;--&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="comment">&lt;!--    &lt;servlet-mapping&gt;--&gt;</span></span><br><span class="line"><span class="comment">&lt;!--        &lt;servlet-name&gt;servlet1&lt;/servlet-name&gt;--&gt;</span></span><br><span class="line">        <span class="comment">&lt;!--精确匹配--&gt;</span></span><br><span class="line"><span class="comment">&lt;!--        &lt;url-pattern&gt;/servlet1&lt;/url-pattern&gt;--&gt;</span></span><br><span class="line">        <span class="comment">&lt;!--模糊匹配，/不包含jsp, /*全部--&gt;</span>	</span><br><span class="line"><span class="comment">&lt;!--        &lt;url-pattern&gt;/&lt;/url-pattern&gt;--&gt;</span></span><br><span class="line"><span class="comment">&lt;!--        &lt;url-pattern&gt;/*&lt;/url-pattern&gt;--&gt;</span></span><br><span class="line"><span class="comment">&lt;!--        &lt;url-pattern&gt;/a/*&lt;/url-pattern&gt;--&gt;</span></span><br><span class="line"><span class="comment">&lt;!--        &lt;url-pattern&gt;*.action&lt;/url-pattern&gt;--&gt;</span></span><br><span class="line"><span class="comment">&lt;!--    &lt;/servlet-mapping&gt;--&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="tag">&lt;/<span class="name">web-app</span>&gt;</span></span><br></pre></td></tr></table></figure>



<ul>
<li>Step4：编写form表单提交请求，因为异步请求的知识暂时没有解锁，通过跳转界面来演示</li>
</ul>
<figure class="highlight html"><table><tr><td class="code"><pre><span class="line"><span class="meta">&lt;!DOCTYPE <span class="keyword">html</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">html</span> <span class="attr">lang</span>=<span class="string">&quot;en&quot;</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">head</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">meta</span> <span class="attr">charset</span>=<span class="string">&quot;UTF-8&quot;</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">meta</span> <span class="attr">name</span>=<span class="string">&quot;viewport&quot;</span> <span class="attr">content</span>=<span class="string">&quot;width=device-width, initial-scale=1.0&quot;</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">title</span>&gt;</span>Document<span class="tag">&lt;/<span class="name">title</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">head</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">body</span>&gt;</span></span><br><span class="line">    <span class="comment">&lt;!--</span></span><br><span class="line"><span class="comment">     get: http://127.0.0.1:8080/userServlet?username=zhangsan</span></span><br><span class="line"><span class="comment">     post: 请求体中 username=zhangsan</span></span><br><span class="line"><span class="comment">     --&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">form</span> <span class="attr">method</span>=<span class="string">&quot;post&quot;</span> <span class="attr">action</span>=<span class="string">&quot;userServlet&quot;</span>&gt;</span></span><br><span class="line">        用户名：<span class="tag">&lt;<span class="name">input</span> <span class="attr">type</span>=<span class="string">&quot;text&quot;</span> <span class="attr">name</span>=<span class="string">&quot;username&quot;</span>&gt;</span><span class="tag">&lt;<span class="name">br</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">input</span> <span class="attr">type</span>=<span class="string">&quot;submit&quot;</span> <span class="attr">value</span>=<span class="string">&quot;校验&quot;</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">form</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">body</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">html</span>&gt;</span></span><br></pre></td></tr></table></figure>



<ul>
<li>Step5：debug测试服务端是否正常处理业务，前端是否返回数据</li>
</ul>
<p><img src="/img/loading.gif" data-original="https://yuezi-1308313119.cos.ap-guangzhou.myqcloud.com/typora-user-images%2Fimage-20240901202920601.png" alt="image-20240901202920601">	</p>
<p><img src="/img/loading.gif" data-original="https://yuezi-1308313119.cos.ap-guangzhou.myqcloud.com/typora-user-images%2Fimage-20240901202910082.png" alt="image-20240901202910082">	</p>
<p><img src="/img/loading.gif" data-original="https://yuezi-1308313119.cos.ap-guangzhou.myqcloud.com/typora-user-images%2Fimage-20240901202930340.png" alt="image-20240901202930340">	</p>
<h2 id="3-Servlet注解"><a href="#3-Servlet注解" class="headerlink" title="3. Servlet注解"></a>3. Servlet注解</h2><h3 id="3-1-WebServlet源码"><a href="#3-1-WebServlet源码" class="headerlink" title="3.1 @WebServlet源码"></a>3.1 @WebServlet源码</h3><p>官方JAVAEEAPI文档下载地址：<a target="_blank" rel="noopener" href="https://www.oracle.com/java/technologies/javaee/javaeetechnologies.html#javaee8">Java EE - Technologies (oracle.com)</a> </p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="keyword">package</span> jakarta.servlet.annotation;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> java.lang.annotation.Documented;</span><br><span class="line"><span class="keyword">import</span> java.lang.annotation.ElementType;</span><br><span class="line"><span class="keyword">import</span> java.lang.annotation.Retention;</span><br><span class="line"><span class="keyword">import</span> java.lang.annotation.RetentionPolicy;</span><br><span class="line"><span class="keyword">import</span> java.lang.annotation.Target;</span><br><span class="line"></span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@since</span> Servlet 3.0</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="meta">@Target(&#123; ElementType.TYPE &#125;)</span></span><br><span class="line"><span class="meta">@Retention(RetentionPolicy.RUNTIME)</span></span><br><span class="line"><span class="meta">@Documented</span></span><br><span class="line"><span class="keyword">public</span> <span class="meta">@interface</span> WebServlet &#123;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * The name of the servlet</span></span><br><span class="line"><span class="comment">     * 相当于 servlet-name</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@return</span> the name of the servlet</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    String <span class="title function_">name</span><span class="params">()</span> <span class="keyword">default</span> <span class="string">&quot;&quot;</span>;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * The URL patterns of the servlet</span></span><br><span class="line"><span class="comment">     * 如果只配置一个url-pattern ,则通过该属性即可,和urlPatterns属性互斥</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@return</span> the URL patterns of the servlet</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    String[] value() <span class="keyword">default</span> &#123;&#125;;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * The URL patterns of the servlet</span></span><br><span class="line"><span class="comment">     * 如果要配置多个url-pattern ,需要通过该属性,和value属性互斥</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@return</span> the URL patterns of the servlet</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    String[] urlPatterns() <span class="keyword">default</span> &#123;&#125;;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * The load-on-startup order of the servlet</span></span><br><span class="line"><span class="comment">     * 配置Servlet是否在项目加载时实例化</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@return</span> the load-on-startup order of the servlet</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="type">int</span> <span class="title function_">loadOnStartup</span><span class="params">()</span> <span class="keyword">default</span> -<span class="number">1</span>;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * The init parameters of the servlet</span></span><br><span class="line"><span class="comment">     * 配置初始化参数</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@return</span> the init parameters of the servlet</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    WebInitParam[] initParams() <span class="keyword">default</span> &#123;&#125;;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * Declares whether the servlet supports asynchronous operation mode.</span></span><br><span class="line"><span class="comment">     *</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@return</span> &#123;<span class="doctag">@code</span> true&#125; if the servlet supports asynchronous operation mode</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@see</span> jakarta.servlet.ServletRequest#startAsync</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@see</span> jakarta.servlet.ServletRequest#startAsync( jakarta.servlet.ServletRequest,jakarta.servlet.ServletResponse)</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="type">boolean</span> <span class="title function_">asyncSupported</span><span class="params">()</span> <span class="keyword">default</span> <span class="literal">false</span>;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * The small-icon of the servlet</span></span><br><span class="line"><span class="comment">     *</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@return</span> the small-icon of the servlet</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    String <span class="title function_">smallIcon</span><span class="params">()</span> <span class="keyword">default</span> <span class="string">&quot;&quot;</span>;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * The large-icon of the servlet</span></span><br><span class="line"><span class="comment">     *</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@return</span> the large-icon of the servlet</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    String <span class="title function_">largeIcon</span><span class="params">()</span> <span class="keyword">default</span> <span class="string">&quot;&quot;</span>;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * The description of the servlet</span></span><br><span class="line"><span class="comment">     *</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@return</span> the description of the servlet</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    String <span class="title function_">description</span><span class="params">()</span> <span class="keyword">default</span> <span class="string">&quot;&quot;</span>;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * The display name of the servlet</span></span><br><span class="line"><span class="comment">     *</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@return</span> the display name of the servlet</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    String <span class="title function_">displayName</span><span class="params">()</span> <span class="keyword">default</span> <span class="string">&quot;&quot;</span>;</span><br><span class="line"></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>



<h3 id="3-2-WebServlet使用"><a href="#3-2-WebServlet使用" class="headerlink" title="3.2 @WebServlet使用"></a>3.2 @WebServlet使用</h3><p>通过@WebServlet注解替换Servlet配置，配置信息包含</p>
<ul>
<li>别名<code>name</code></li>
<li>映射路径<code>value</code>（单个），<code>urlPatterns</code>（多个）</li>
<li>初始参数<code>initParams</code></li>
<li>初始化Servlet时第n个加载实例化<code>loadonStartup</code></li>
</ul>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="meta">@WebServlet(</span></span><br><span class="line"><span class="meta">        name = &quot;userServlet&quot;,</span></span><br><span class="line"><span class="meta">        //value = &quot;/user&quot;,</span></span><br><span class="line"><span class="meta">        urlPatterns = &#123;&quot;/userServlet1&quot;,&quot;/userServlet2&quot;,&quot;/userServlet&quot;&#125;,</span></span><br><span class="line"><span class="meta">        initParams = &#123;@WebInitParam(name = &quot;encoding&quot;,value = &quot;UTF-8&quot;)&#125;,</span></span><br><span class="line"><span class="meta">        loadOnStartup = 6</span></span><br><span class="line"><span class="meta">)</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">UserServlet</span>  <span class="keyword">extends</span> <span class="title class_">HttpServlet</span> &#123;</span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="keyword">protected</span> <span class="keyword">void</span> <span class="title function_">service</span><span class="params">(HttpServletRequest req, HttpServletResponse resp)</span> <span class="keyword">throws</span> ServletException, IOException &#123;</span><br><span class="line">        <span class="type">String</span> <span class="variable">encoding</span> <span class="operator">=</span> getServletConfig().getInitParameter(<span class="string">&quot;encoding&quot;</span>);</span><br><span class="line">        System.out.println(encoding);</span><br><span class="line">		<span class="comment">// ...</span></span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>



<h2 id="4-Servlet生命周期"><a href="#4-Servlet生命周期" class="headerlink" title="4. Servlet生命周期"></a>4. Servlet生命周期</h2><h3 id="4-1-生命周期简介"><a href="#4-1-生命周期简介" class="headerlink" title="4.1 生命周期简介"></a>4.1 生命周期简介</h3><ul>
<li>Servlet对象<code>生命周期</code>：应用程序中的对象除了空间上的层次关系，在时间上会<strong>随着程序运行的不同阶段而展现出不同的状态和行为</strong><ul>
<li>理解：对象在容器中从开始到销毁的过程</li>
</ul>
</li>
<li>Servlet<code>容器</code>：Servlet对象通过Servlet容器创建，生命周期相关方法均通过容器实现（目前使用<code>Tomcat</code>），在今后学习中，很多对象会交由给容器或者框架来帮助我们创建，调用，开发人员会将更多精力放在业务流程，而不是具体实现上</li>
<li>生命周期相关方法和执行情况如下：</li>
</ul>
<table>
<thead>
<tr>
<th>生命周期</th>
<th>对应方法</th>
<th>执行时机</th>
<th>执行次数</th>
</tr>
</thead>
<tbody><tr>
<td>构造对象</td>
<td>构造器</td>
<td>第一次请求或者容器启动</td>
<td>1</td>
</tr>
<tr>
<td>初始化</td>
<td>init()</td>
<td>构造完毕后</td>
<td>1</td>
</tr>
<tr>
<td>处理服务</td>
<td>service(HttpServletRequest req,HttpServletResponse resp)</td>
<td>每次请求</td>
<td>多次</td>
</tr>
<tr>
<td>销毁</td>
<td>destory()</td>
<td>容器关闭</td>
<td>1</td>
</tr>
</tbody></table>
<h3 id="4-2-生命周期方法测试"><a href="#4-2-生命周期方法测试" class="headerlink" title="4.2 生命周期方法测试"></a>4.2 生命周期方法测试</h3><figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="keyword">package</span> com.atguigu.servlet;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> jakarta.servlet.ServletException;</span><br><span class="line"><span class="keyword">import</span> jakarta.servlet.annotation.WebServlet;</span><br><span class="line"><span class="keyword">import</span> jakarta.servlet.http.HttpServlet;</span><br><span class="line"><span class="keyword">import</span> jakarta.servlet.http.HttpServletRequest;</span><br><span class="line"><span class="keyword">import</span> jakarta.servlet.http.HttpServletResponse;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> java.io.IOException;</span><br><span class="line"></span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@author</span> yuezi2048</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@version</span> 1.0</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="comment">// 建议loadOnStartup从6开始写 避免和conf目录下定义好的冲突</span></span><br><span class="line"> <span class="meta">@WebServlet(value = &quot;/servletLifeCircle&quot;, loadOnStartup = 6)</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">ServletLifeCircle</span> <span class="keyword">extends</span> <span class="title class_">HttpServlet</span> &#123;</span><br><span class="line">    <span class="keyword">public</span> <span class="title function_">ServletLifeCircle</span><span class="params">()</span> &#123;</span><br><span class="line">        System.out.println(<span class="string">&quot;ServletLifeCircle constructor&quot;</span>);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">init</span><span class="params">()</span> <span class="keyword">throws</span> ServletException &#123;</span><br><span class="line">        System.out.println(<span class="string">&quot;ServletLifeCircle init&quot;</span>);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">//    @Override</span></span><br><span class="line"><span class="comment">//    protected void service(HttpServletRequest req, HttpServletResponse resp) throws ServletException, IOException &#123;</span></span><br><span class="line"><span class="comment">//            i++;</span></span><br><span class="line"><span class="comment">//        System.out.println(&quot;ServletLifeCircle service&quot;);</span></span><br><span class="line"><span class="comment">//    &#125;</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="keyword">protected</span> <span class="keyword">void</span> <span class="title function_">doGet</span><span class="params">(HttpServletRequest req, HttpServletResponse resp)</span> <span class="keyword">throws</span> ServletException, IOException &#123;</span><br><span class="line">        <span class="built_in">this</span>.doPost(req, resp);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="keyword">protected</span> <span class="keyword">void</span> <span class="title function_">doPost</span><span class="params">(HttpServletRequest req, HttpServletResponse resp)</span> <span class="keyword">throws</span> ServletException, IOException &#123;</span><br><span class="line">        System.out.println(<span class="string">&quot;请求业务逻辑 start...&quot;</span>);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">destroy</span><span class="params">()</span> &#123;</span><br><span class="line">        System.out.println(<span class="string">&quot;ServletLifeCircle destroy&quot;</span>);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<p>log日志重要句柄</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">04-Sep-2024 10:59:54.317 信息 [main] org.apache.catalina.startup.Catalina.start [178]毫秒后服务器启动</span><br><span class="line">Connected to server</span><br><span class="line">[2024-09-04 10:59:54,835] Artifact demo02-servlet01:Web exploded: Artifact is being deployed, please <span class="built_in">wait</span>...</span><br><span class="line"></span><br><span class="line">ServletLifeCircle constructor</span><br><span class="line">ServletLifeCircle init</span><br><span class="line">    </span><br><span class="line">[D:\application\apache-tomcat-10.1.28\webapps\manager]的部署已在[128]毫秒内完成</span><br><span class="line">请求业务逻辑 start...</span><br><span class="line">    </span><br><span class="line">D:\application\apache-tomcat-10.1.28\bin\catalina.bat stop</span><br><span class="line">04-Sep-2024 11:00:25.228 信息 [main] org.apache.catalina.core.StandardServer.await 通过关闭端口接收到有效的关闭命令。正在停止服务器实例。</span><br><span class="line">ServletLifeCircle destroy</span><br><span class="line">Disconnected from server</span><br></pre></td></tr></table></figure>





<h3 id="4-3-使用结论"><a href="#4-3-使用结论" class="headerlink" title="4.3 使用结论"></a>4.3 使用结论</h3><ol>
<li>Servlet在容器中是<code>单例</code>的</li>
<li>容器可以处理用户<code>并发</code>请求，每个请求在容器中会开启一个线程</li>
<li>Servlet的成员变量在多个线程栈中是<code>共享</code>的，因此<code>不建议修改</code>成员变量（加锁会影响服务器性能）</li>
<li><code>load-on-startup</code>表示实例化的顺序，虽然重复了容器会自行解决，但要避免重复，建议从6开始，1-5是实例化servlet自身定义的</li>
<li><code>default-servlet </code>实际上就是所有servlet没有匹配上，找静态资源，通过I&#x2F;O读入resp再返回给请求端</li>
</ol>
<h2 id="5-Servlet源码追溯和结论"><a href="#5-Servlet源码追溯和结论" class="headerlink" title="5. Servlet源码追溯和结论"></a>5. Servlet源码追溯和结论</h2><h3 id="5-1-继承结构"><a href="#5-1-继承结构" class="headerlink" title="5.1 继承结构"></a>5.1 继承结构</h3><p>继承结构图</p>
<p><img src="/img/loading.gif" data-original="https://yuezi-1308313119.cos.ap-guangzhou.myqcloud.com/typora-user-images%2Fimage-20240904104519317.png" alt="image-20240904104519317">	</p>
<h3 id="5-2-源码分析"><a href="#5-2-源码分析" class="headerlink" title="5.2 源码分析"></a>5.2 源码分析</h3><p>顶级<code>Servlet接口</code></p>
<ul>
<li>明显地告诉了我们生命周期所需要的方法规范</li>
</ul>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="keyword">interface</span> <span class="title class_">Servlet</span> &#123;</span><br><span class="line">   <span class="comment">// 构造完毕后由Tomcat自动调用完成初始化功能的方法</span></span><br><span class="line">    <span class="keyword">void</span> <span class="title function_">init</span><span class="params">(ServletConfig var1)</span> <span class="keyword">throws</span> ServletException;</span><br><span class="line">   <span class="comment">// 获得ServletConfig对象</span></span><br><span class="line">    ServletConfig <span class="title function_">getServletConfig</span><span class="params">()</span>;</span><br><span class="line">   <span class="comment">// 接收用户请求，向用户响应信息</span></span><br><span class="line">    <span class="keyword">void</span> <span class="title function_">service</span><span class="params">(ServletRequest var1, ServletResponse var2)</span> <span class="keyword">throws</span> ServletException, IOException;</span><br><span class="line">   <span class="comment">// 返回Servlet字符串形式描述信息的方法</span></span><br><span class="line">    String <span class="title function_">getServletInfo</span><span class="params">()</span>;</span><br><span class="line">   <span class="comment">// Servlet在回收前调用的销毁方法，往往用于做资源释放等工作</span></span><br><span class="line">    <span class="keyword">void</span> <span class="title function_">destroy</span><span class="params">()</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>



<p>实现类<code>GenericServlet</code>（侧重service以外的方法处理）</p>
<ul>
<li>主要是传入一些配置信息以便初始化，并让开发者可以重写<code>init()</code>和<code>destroy()</code>方法在原有基础上扩展初始化和销毁的动作（释放资源等）</li>
</ul>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="keyword">abstract</span> <span class="keyword">class</span> <span class="title class_">GenericServlet</span> <span class="keyword">implements</span> <span class="title class_">Servlet</span>, ServletConfig, Serializable &#123;</span><br><span class="line">    <span class="comment">// 平庸实现：将抽象方法重写为普通方法，内部没有方法体</span></span><br><span class="line">    <span class="comment">// 好处：可以不要求重写所有接口方法，可通过继承该类自动实现该类</span></span><br><span class="line">     <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">destroy</span><span class="params">()</span> &#123;</span><br><span class="line">     &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">// tomcat调用init方法时读取配置信息，进入ServletConfig对象，将该对象传入init方法</span></span><br><span class="line">     <span class="keyword">private</span> <span class="keyword">transient</span> ServletConfig config;</span><br><span class="line">     <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">init</span><span class="params">(ServletConfig config)</span> <span class="keyword">throws</span> ServletException &#123;</span><br><span class="line">        <span class="comment">// config对象存储为当前属性</span></span><br><span class="line">         <span class="built_in">this</span>.config = config;</span><br><span class="line">        <span class="comment">// 调用重载的init方法（好处，开发者按需重写初始化的行为，而无需定义config等相关api）</span></span><br><span class="line">         <span class="built_in">this</span>.init();</span><br><span class="line">     &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">// 重载初始化的init方法，是我们待重写的方法</span></span><br><span class="line">     <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">init</span><span class="params">()</span> <span class="keyword">throws</span> ServletException &#123;</span><br><span class="line">     &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">// 返回servletConfig</span></span><br><span class="line">     <span class="keyword">public</span> ServletConfig <span class="title function_">getServletConfig</span><span class="params">()</span> &#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="built_in">this</span>.config;</span><br><span class="line">     &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">// 针对service方法再次抽象申明</span></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">abstract</span> <span class="keyword">void</span> <span class="title function_">service</span><span class="params">(ServletRequest var1, ServletResponse var2)</span> <span class="keyword">throws</span> ServletException, IOException;</span><br><span class="line"> &#125;</span><br></pre></td></tr></table></figure>



<p><code>HttpServlet</code>（侧重service的处理）</p>
<ul>
<li>直接调用本类service方法的处理方式：直接报405</li>
<li>因此我们一般继承该类，重写<code>service</code>方法（或<code>doXxx</code>方法）</li>
</ul>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="keyword">abstract</span> <span class="keyword">class</span> <span class="title class_">HttpServlet</span> <span class="keyword">extends</span> <span class="title class_">GenericServlet</span> &#123;</span><br><span class="line">    <span class="comment">// 参数父转子，调用重载的service方法</span></span><br><span class="line">     <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">service</span><span class="params">(ServletRequest req, ServletResponse res)</span> <span class="keyword">throws</span> ServletException, IOException &#123;</span><br><span class="line">        <span class="comment">// 参数的父转子，有更丰富的方法</span></span><br><span class="line">         request = (HttpServletRequest)req;</span><br><span class="line">         response = (HttpServletResponse)res;</span><br><span class="line">        <span class="comment">// 调用重载的service方法</span></span><br><span class="line">         <span class="built_in">this</span>.service(request, response);</span><br><span class="line">     &#125;</span><br><span class="line"></span><br><span class="line">     <span class="keyword">protected</span> <span class="keyword">void</span> <span class="title function_">service</span><span class="params">(HttpServletRequest req, HttpServletResponse resp)</span> <span class="keyword">throws</span> ServletException, IOException &#123;</span><br><span class="line">        <span class="comment">// 获取请求方式</span></span><br><span class="line">         <span class="type">String</span> <span class="variable">method</span> <span class="operator">=</span> req.getMethod(); <span class="comment">// GET POST PUT DELETE OPTIONS...</span></span><br><span class="line">        <span class="comment">// 根据请求方式调用对应的do...</span></span><br><span class="line">         <span class="keyword">if</span> (method.equals(<span class="string">&quot;GET&quot;</span>)) &#123;</span><br><span class="line">            lastModified = <span class="built_in">this</span>.getLastModified(req);</span><br><span class="line">            <span class="built_in">this</span>.doGet(req, resp);</span><br><span class="line">         &#125;</span><br><span class="line">        <span class="keyword">else</span> <span class="keyword">if</span> (method.equals(<span class="string">&quot;HEAD&quot;</span>)) &#123;</span><br><span class="line">             lastModified = <span class="built_in">this</span>.getLastModified(req);</span><br><span class="line">             <span class="built_in">this</span>.maybeSetLastModified(resp, lastModified);</span><br><span class="line">             <span class="built_in">this</span>.doHead(req, resp);</span><br><span class="line">         &#125; <span class="keyword">else</span> <span class="keyword">if</span> (method.equals(<span class="string">&quot;POST&quot;</span>)) &#123;</span><br><span class="line">             <span class="built_in">this</span>.doPost(req, resp);</span><br><span class="line">         &#125; <span class="keyword">else</span> <span class="keyword">if</span> (method.equals(<span class="string">&quot;PUT&quot;</span>)) &#123;</span><br><span class="line">            <span class="built_in">this</span>.doPut(req, resp);</span><br><span class="line">         &#125; <span class="keyword">else</span> <span class="keyword">if</span> (method.equals(<span class="string">&quot;DELETE&quot;</span>)) &#123;</span><br><span class="line">            <span class="built_in">this</span>.doDelete(req, resp);</span><br><span class="line">         &#125; <span class="keyword">else</span> <span class="keyword">if</span> (method.equals(<span class="string">&quot;OPTIONS&quot;</span>)) &#123;</span><br><span class="line">            <span class="built_in">this</span>.doOptions(req, resp);</span><br><span class="line">         &#125; <span class="keyword">else</span> <span class="keyword">if</span> (method.equals(<span class="string">&quot;TRACE&quot;</span>)) &#123;</span><br><span class="line">            <span class="built_in">this</span>.doTrace(req, resp);</span><br><span class="line">         &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">             resp.sendError(<span class="number">501</span>, errMsg);</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">     &#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">     <span class="keyword">protected</span> <span class="keyword">void</span> <span class="title function_">doGet</span><span class="params">(HttpServletRequest req, HttpServletResponse resp)</span> <span class="keyword">throws</span> ServletException, IOException &#123;</span><br><span class="line">         <span class="type">String</span> <span class="variable">msg</span> <span class="operator">=</span> lStrings.getString(<span class="string">&quot;http.method_get_not_supported&quot;</span>);</span><br><span class="line">         <span class="comment">// 故意响应405</span></span><br><span class="line">         resp.sendError(<span class="number">405</span>, msg);</span><br><span class="line">     &#125;</span><br><span class="line"></span><br><span class="line">     <span class="keyword">protected</span> <span class="keyword">void</span> <span class="title function_">doPost</span><span class="params">(HttpServletRequest req, HttpServletResponse resp)</span> <span class="keyword">throws</span> ServletException, IOException &#123;</span><br><span class="line">         <span class="type">String</span> <span class="variable">msg</span> <span class="operator">=</span> lStrings.getString(<span class="string">&quot;http.method_post_not_supported&quot;</span>);</span><br><span class="line"></span><br><span class="line">         <span class="comment">// 故意响应405</span></span><br><span class="line">        resp.sendError(<span class="number">405</span>, msg);</span><br><span class="line">     &#125;</span><br><span class="line"> &#125;</span><br></pre></td></tr></table></figure>



<p>开发者自定义Servlet</p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="keyword">class</span> <span class="title class_">Servlet1</span> <span class="keyword">extends</span> <span class="title class_">HttpServlet</span> &#123;</span><br><span class="line">    <span class="keyword">protected</span> <span class="keyword">void</span> <span class="title function_">service</span><span class="params">(HttpServletRequest req, HttpServletResponse resp)</span> <span class="keyword">throws</span> ServletException, IOException &#123;</span><br><span class="line">         <span class="comment">// 接收用户请求信息做出响应</span></span><br><span class="line">    &#125;</span><br><span class="line"> &#125;</span><br></pre></td></tr></table></figure>



<h3 id="5-3-结论"><a href="#5-3-结论" class="headerlink" title="5.3 结论"></a>5.3 结论</h3><p>得到：</p>
<ol>
<li>如果实现类没有重写Service方法，就会自动调用父类的方法，返回405</li>
<li>子类的实现类同样也可以定义doGet() doPost()方法对特定类型的请求方式做业务逻辑的判断(推荐)</li>
</ol>
<p> 我们要明确的结论：</p>
<ol>
<li>部分程序员推荐doGet() doPost()处理请求，理由：如果直接重写service方法，父类service方法处理功能失效</li>
<li>目前直接重写service没问题的（last_modified等没有影响到业务）</li>
<li>后续使用Spring MVC框架后，无需继承HttpServlet，处理请求的方法也无需是doXxx(), service()</li>
<li>doGet和 doPost 方法中如果定义的方法都一样，让一个方法调用另一个即可</li>
</ol>
<p>需掌握的技能：继承HttpServlet后，要么重写<code>Service</code>方法，要么重写<code>doGet/doPost</code></p>
<p>这个图解挺牛的，涵盖了上述大部分Servlet要点</p>
<p><img src="/img/loading.gif" data-original="https://yuezi-1308313119.cos.ap-guangzhou.myqcloud.com/typora-user-images%2Fimage-20240904111007214.png" alt="image-20240904111007214">	</p>
<h2 id="6-ServletConfig和ServletContext"><a href="#6-ServletConfig和ServletContext" class="headerlink" title="6. ServletConfig和ServletContext"></a>6. ServletConfig和ServletContext</h2><h3 id="6-1-ServletConfig"><a href="#6-1-ServletConfig" class="headerlink" title="6.1 ServletConfig"></a>6.1 ServletConfig</h3><ul>
<li><code>ServletConfig</code>：Servlet初始化配置参数的对象，每个Servlet都有自己专属的一个ServletConfig</li>
<li>容器会实例化ServletConfig，通过生命周期的init方法传入给Servlet作为属性</li>
<li>我们可以在定义Servlet的时候传入自定义配置参数<code>init-param</code>（每个Servlet都需单独定义）</li>
</ul>
<p><img src="/img/loading.gif" data-original="https://yuezi-1308313119.cos.ap-guangzhou.myqcloud.com/typora-user-images%2Fimage-20240904111905843.png" alt="image-20240904111905843">	</p>
<p>获取相关内容的API如下：</p>
<table>
<thead>
<tr>
<th>方法名</th>
<th>作用</th>
</tr>
</thead>
<tbody><tr>
<td>getServletName()</td>
<td>获取&lt;servlet-name&gt;HelloServlet&lt;&#x2F;servlet-name&gt;定义的Servlet名称</td>
</tr>
<tr>
<td>getServletConfig()</td>
<td>获取ServletConfig对象</td>
</tr>
<tr>
<td>getInitParameter()</td>
<td>获取配置Servlet时设置的『初始化参数』，根据名字获取值</td>
</tr>
<tr>
<td>getInitParameterNames()</td>
<td>获取所有初始化参数名组成的Enumeration对象</td>
</tr>
</tbody></table>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="keyword">package</span> com.atguigu.com.atguigu.servlet;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> jakarta.servlet.ServletConfig;</span><br><span class="line"><span class="keyword">import</span> jakarta.servlet.ServletContext;</span><br><span class="line"><span class="keyword">import</span> jakarta.servlet.ServletException;</span><br><span class="line"><span class="keyword">import</span> jakarta.servlet.http.HttpServlet;</span><br><span class="line"><span class="keyword">import</span> jakarta.servlet.http.HttpServletRequest;</span><br><span class="line"><span class="keyword">import</span> jakarta.servlet.http.HttpServletResponse;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> java.io.IOException;</span><br><span class="line"><span class="keyword">import</span> java.util.Enumeration;</span><br><span class="line"></span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@author</span> yuezi2048</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@version</span> 1.0</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="comment">/*</span></span><br><span class="line"><span class="comment">	--------servlet Config 参数--------</span></span><br><span class="line"><span class="comment">    keyA: valueA</span></span><br><span class="line"><span class="comment">    keyA: valueA</span></span><br><span class="line"><span class="comment">    keyB: valueB</span></span><br><span class="line"><span class="comment">*/</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">Servlet1</span> <span class="keyword">extends</span> <span class="title class_">HttpServlet</span> &#123;</span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="keyword">protected</span> <span class="keyword">void</span> <span class="title function_">service</span><span class="params">(HttpServletRequest req, HttpServletResponse resp)</span> <span class="keyword">throws</span> ServletException, IOException &#123;</span><br><span class="line">        System.out.println(<span class="string">&quot;--------servlet Config 参数--------&quot;</span>);</span><br><span class="line">        <span class="type">ServletConfig</span> <span class="variable">servletConfig</span> <span class="operator">=</span> getServletConfig();</span><br><span class="line">        <span class="comment">// 根据参数名获取参数值</span></span><br><span class="line">        <span class="type">String</span> <span class="variable">keyA</span> <span class="operator">=</span> servletConfig.getInitParameter(<span class="string">&quot;keyA&quot;</span>);</span><br><span class="line">        System.out.println(<span class="string">&quot;keyA: &quot;</span> + keyA);</span><br><span class="line"></span><br><span class="line">        <span class="comment">// 获取所有的初始参数的名字 iterator</span></span><br><span class="line">        <span class="comment">// hasMoreElements 判断有没有下一个参数，如果有返回true 否则返回false</span></span><br><span class="line">        <span class="comment">// nextElement     1. 取出下一个元素； 2. 向下移动游标</span></span><br><span class="line">        Enumeration&lt;String&gt; initParameterNames = servletConfig.getInitParameterNames();</span><br><span class="line">        <span class="keyword">while</span> (initParameterNames.hasMoreElements()) &#123;</span><br><span class="line">            <span class="type">String</span> <span class="variable">pName</span> <span class="operator">=</span> initParameterNames.nextElement();</span><br><span class="line">            System.out.println(pName + <span class="string">&quot;: &quot;</span> + servletConfig.getInitParameter(pName));</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>相关配置文件，这里先使用xml格式说明两个Servlet之间的独立性，Servlet2的代码就略了，copy一下Servlet1即可</p>
<figure class="highlight xml"><table><tr><td class="code"><pre><span class="line"><span class="meta">&lt;?xml version=<span class="string">&quot;1.0&quot;</span> encoding=<span class="string">&quot;UTF-8&quot;</span>?&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">web-app</span> <span class="attr">xmlns</span>=<span class="string">&quot;https://jakarta.ee/xml/ns/jakartaee&quot;</span></span></span><br><span class="line"><span class="tag">         <span class="attr">xmlns:xsi</span>=<span class="string">&quot;http://www.w3.org/2001/XMLSchema-instance&quot;</span></span></span><br><span class="line"><span class="tag">         <span class="attr">xsi:schemaLocation</span>=<span class="string">&quot;https://jakarta.ee/xml/ns/jakartaee https://jakarta.ee/xml/ns/jakartaee/web-app_6_0.xsd&quot;</span></span></span><br><span class="line"><span class="tag">         <span class="attr">version</span>=<span class="string">&quot;6.0&quot;</span>&gt;</span></span><br><span class="line"></span><br><span class="line">    <span class="tag">&lt;<span class="name">servlet</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">servlet-name</span>&gt;</span>servlet1<span class="tag">&lt;/<span class="name">servlet-name</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">servlet-class</span>&gt;</span>com.atguigu.com.atguigu.servlet.Servlet1<span class="tag">&lt;/<span class="name">servlet-class</span>&gt;</span></span><br><span class="line">        <span class="comment">&lt;!-- 配置servlet的初始参数 --&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">init-param</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">param-name</span>&gt;</span>keyA<span class="tag">&lt;/<span class="name">param-name</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">param-value</span>&gt;</span>valueA<span class="tag">&lt;/<span class="name">param-value</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;/<span class="name">init-param</span>&gt;</span></span><br><span class="line">        </span><br><span class="line">        <span class="tag">&lt;<span class="name">init-param</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">param-name</span>&gt;</span>keyB<span class="tag">&lt;/<span class="name">param-name</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">param-value</span>&gt;</span>valueB<span class="tag">&lt;/<span class="name">param-value</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;/<span class="name">init-param</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">servlet</span>&gt;</span></span><br><span class="line"></span><br><span class="line">    <span class="tag">&lt;<span class="name">servlet-mapping</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">servlet-name</span>&gt;</span>servlet1<span class="tag">&lt;/<span class="name">servlet-name</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">url-pattern</span>&gt;</span>/servlet1<span class="tag">&lt;/<span class="name">url-pattern</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">servlet-mapping</span>&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="comment">&lt;!-- 每一个servletConfig之间都是相互独立的，即需要单独再定义一次 --&gt;</span></span><br><span class="line"><span class="comment">&lt;!--    &lt;servlet&gt;--&gt;</span></span><br><span class="line"><span class="comment">&lt;!--        &lt;servlet-name&gt;servlet2&lt;/servlet-name&gt;--&gt;</span></span><br><span class="line"><span class="comment">&lt;!--        &lt;servlet-class&gt;com.atguigu.com.atguigu.servlet.Servlet2&lt;/servlet-class&gt;--&gt;</span></span><br><span class="line"><span class="comment">&lt;!--        &amp;lt;!&amp;ndash; 配置servlet的初始参数 &amp;ndash;&amp;gt;--&gt;</span></span><br><span class="line"><span class="comment">&lt;!--        &lt;init-param&gt;--&gt;</span></span><br><span class="line"><span class="comment">&lt;!--            &lt;param-name&gt;keyC&lt;/param-name&gt;--&gt;</span></span><br><span class="line"><span class="comment">&lt;!--            &lt;param-value&gt;valueC&lt;/param-value&gt;--&gt;</span></span><br><span class="line"><span class="comment">&lt;!--        &lt;/init-param&gt;--&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="comment">&lt;!--        &lt;init-param&gt;--&gt;</span></span><br><span class="line"><span class="comment">&lt;!--            &lt;param-name&gt;keyD&lt;/param-name&gt;--&gt;</span></span><br><span class="line"><span class="comment">&lt;!--            &lt;param-value&gt;valueD&lt;/param-value&gt;--&gt;</span></span><br><span class="line"><span class="comment">&lt;!--        &lt;/init-param&gt;--&gt;</span></span><br><span class="line"><span class="comment">&lt;!--    &lt;/servlet&gt;--&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="comment">&lt;!--    &lt;servlet-mapping&gt;--&gt;</span></span><br><span class="line"><span class="comment">&lt;!--        &lt;servlet-name&gt;servlet2&lt;/servlet-name&gt;--&gt;</span></span><br><span class="line"><span class="comment">&lt;!--        &lt;url-pattern&gt;/servlet2&lt;/url-pattern&gt;--&gt;</span></span><br><span class="line"><span class="comment">&lt;!--    &lt;/servlet-mapping&gt;--&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">web-app</span>&gt;</span></span><br></pre></td></tr></table></figure>



<h3 id="6-2-ServletContext"><a href="#6-2-ServletContext" class="headerlink" title="6.2 ServletContext"></a>6.2 ServletContext</h3><ul>
<li><code>ServletContext</code>对象，一般称呼为<code>上下文对象</code>&#x2F;应用域对象（后面会说到<code>域对象</code>的概念）</li>
<li>容器会为app创建<code>独立且唯一</code>的ServletContext对象，该对象为所有Servlet共享，并为其提供初始<code>配置参数</code></li>
</ul>
<p><img src="/img/loading.gif" data-original="https://yuezi-1308313119.cos.ap-guangzhou.myqcloud.com/typora-user-images%2Fimage-20240904112338937.png" alt="image-20240904112338937">		</p>
<p>在原来Servlet1基础上说明</p>
<ul>
<li>很多程序员喜欢将ServletContext()对象看作是整个应用层的<code>域对象application</code>（我们也可以在原来的配置上进一步操作元素和属性）</li>
</ul>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="keyword">package</span> com.atguigu.com.atguigu.servlet;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> jakarta.servlet.ServletConfig;</span><br><span class="line"><span class="keyword">import</span> jakarta.servlet.ServletContext;</span><br><span class="line"><span class="keyword">import</span> jakarta.servlet.ServletException;</span><br><span class="line"><span class="keyword">import</span> jakarta.servlet.annotation.WebServlet;</span><br><span class="line"><span class="keyword">import</span> jakarta.servlet.http.HttpServlet;</span><br><span class="line"><span class="keyword">import</span> jakarta.servlet.http.HttpServletRequest;</span><br><span class="line"><span class="keyword">import</span> jakarta.servlet.http.HttpServletResponse;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> java.io.IOException;</span><br><span class="line"><span class="keyword">import</span> java.util.Enumeration;</span><br><span class="line"></span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@author</span> yuezi2048</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@version</span> 1.0</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="comment">/*</span></span><br><span class="line"><span class="comment">	--------servlet Context 参数--------</span></span><br><span class="line"><span class="comment">    true</span></span><br><span class="line"><span class="comment">    true</span></span><br><span class="line"><span class="comment">    encoding: UTF-8</span></span><br><span class="line"><span class="comment">    org.apache.catalina.resources: null</span></span><br><span class="line"><span class="comment">    org.apache.catalina.webappVersion: null</span></span><br><span class="line"><span class="comment">    org.apache.tomcat.InstanceManager: null</span></span><br><span class="line"><span class="comment">    org.apache.tomcat.util.threads.ScheduledThreadPoolExecutor: null</span></span><br><span class="line"><span class="comment">    org.apache.catalina.jsp_classpath: null</span></span><br><span class="line"><span class="comment">    jakarta.servlet.context.tempdir: null</span></span><br><span class="line"><span class="comment">    jakarta.websocket.server.ServerContainer: null</span></span><br><span class="line"><span class="comment">    org.apache.jasper.compiler.TldCache: null</span></span><br><span class="line"><span class="comment">    org.apache.tomcat.JarScanner: null</span></span><br><span class="line"><span class="comment">*/</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">Servlet1</span> <span class="keyword">extends</span> <span class="title class_">HttpServlet</span> &#123;</span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="keyword">protected</span> <span class="keyword">void</span> <span class="title function_">service</span><span class="params">(HttpServletRequest req, HttpServletResponse resp)</span> <span class="keyword">throws</span> ServletException, IOException &#123;</span><br><span class="line"></span><br><span class="line">        System.out.println(<span class="string">&quot;--------servlet Context 参数--------&quot;</span>);</span><br><span class="line">        <span class="comment">// 获取ServletContext</span></span><br><span class="line">        <span class="type">ServletContext</span> <span class="variable">servletContext1</span> <span class="operator">=</span> getServletContext();</span><br><span class="line">        <span class="type">ServletContext</span> <span class="variable">servletContext2</span> <span class="operator">=</span> servletConfig.getServletContext();</span><br><span class="line">        <span class="type">ServletContext</span> <span class="variable">servletContext3</span> <span class="operator">=</span> req.getServletContext();</span><br><span class="line">        System.out.println(servletContext1 == servletContext2);</span><br><span class="line">        System.out.println(servletContext2 == servletContext3);</span><br><span class="line">        <span class="type">String</span> <span class="variable">encoding</span> <span class="operator">=</span> servletContext1.getInitParameter(<span class="string">&quot;encoding&quot;</span>);</span><br><span class="line">        System.out.println(<span class="string">&quot;encoding: &quot;</span> + encoding);</span><br><span class="line"></span><br><span class="line">        Enumeration&lt;String&gt; pNames = servletContext1.getAttributeNames();</span><br><span class="line">        <span class="keyword">while</span> (pNames.hasMoreElements()) &#123;</span><br><span class="line">            <span class="type">String</span> <span class="variable">pName</span> <span class="operator">=</span> pNames.nextElement();</span><br><span class="line">            System.out.println(pName + <span class="string">&quot;: &quot;</span> + servletContext1.getInitParameter(pName));</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        <span class="comment">// 很多程序员喜欢将ServletContext对象取名为application作为整个应用层的域对象</span></span><br><span class="line">        <span class="type">ServletContext</span> <span class="variable">application</span> <span class="operator">=</span> getServletContext();</span><br><span class="line"></span><br><span class="line">        <span class="comment">// 作为域对象，一定会有的api</span></span><br><span class="line">        <span class="comment">// void setAttribute(String key, Object value)</span></span><br><span class="line">        servletContext1.setAttribute(<span class="string">&quot;ka&quot;</span>, <span class="string">&quot;va&quot;</span>); <span class="comment">// 向域中增加数据</span></span><br><span class="line">        servletContext1.setAttribute(<span class="string">&quot;ka&quot;</span>, <span class="string">&quot;vaa&quot;</span>); <span class="comment">// 向域中修改数据</span></span><br><span class="line">        <span class="comment">// Object getAttribute(String key)</span></span><br><span class="line">        <span class="type">String</span> <span class="variable">ka</span> <span class="operator">=</span> (String) servletContext1.getAttribute(<span class="string">&quot;ka&quot;</span>);</span><br><span class="line"></span><br><span class="line">        <span class="comment">// void removeAttribute(String key)</span></span><br><span class="line">       servletContext1.removeAttribute(<span class="string">&quot;ka&quot;</span>);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<p>xml配置文件（配置Servlet的参数就不再赘述了）</p>
<figure class="highlight xml"><table><tr><td class="code"><pre><span class="line"><span class="meta">&lt;?xml version=<span class="string">&quot;1.0&quot;</span> encoding=<span class="string">&quot;UTF-8&quot;</span>?&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">web-app</span> <span class="attr">xmlns</span>=<span class="string">&quot;https://jakarta.ee/xml/ns/jakartaee&quot;</span></span></span><br><span class="line"><span class="tag">         <span class="attr">xmlns:xsi</span>=<span class="string">&quot;http://www.w3.org/2001/XMLSchema-instance&quot;</span></span></span><br><span class="line"><span class="tag">         <span class="attr">xsi:schemaLocation</span>=<span class="string">&quot;https://jakarta.ee/xml/ns/jakartaee https://jakarta.ee/xml/ns/jakartaee/web-app_6_0.xsd&quot;</span></span></span><br><span class="line"><span class="tag">         <span class="attr">version</span>=<span class="string">&quot;6.0&quot;</span>&gt;</span></span><br><span class="line">    </span><br><span class="line">    <span class="tag">&lt;<span class="name">context-param</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">param-name</span>&gt;</span>encoding<span class="tag">&lt;/<span class="name">param-name</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">param-value</span>&gt;</span>UTF-8<span class="tag">&lt;/<span class="name">param-value</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">context-param</span>&gt;</span></span><br><span class="line">    </span><br><span class="line">    <span class="tag">&lt;<span class="name">context-param</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">param-name</span>&gt;</span>username<span class="tag">&lt;/<span class="name">param-name</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">param-value</span>&gt;</span>zhangsan<span class="tag">&lt;/<span class="name">param-value</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">context-param</span>&gt;</span></span><br><span class="line">    </span><br><span class="line"><span class="tag">&lt;/<span class="name">web-app</span>&gt;</span></span><br></pre></td></tr></table></figure>





<h3 id="6-3-ServletContext其他重要API"><a href="#6-3-ServletContext其他重要API" class="headerlink" title="6.3 ServletContext其他重要API"></a>6.3 ServletContext其他重要API</h3><p>获取路径</p>
<ul>
<li>获取资源的<code>真实路径</code></li>
</ul>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="type">String</span> <span class="variable">realPath</span> <span class="operator">=</span> servletContext.getRealPath(<span class="string">&quot;资源在web目录中的路径&quot;</span>);</span><br></pre></td></tr></table></figure>

<ul>
<li>真实路径，我们一般在部署到服务器上，路径会动态改变，所以需要用到获取资源真实路径来保证资源准确定位到相应的web资源目录</li>
</ul>
<ul>
<li>获取项目的<code>上下文路径</code></li>
</ul>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="type">String</span> <span class="variable">contextPath</span> <span class="operator">=</span> servletContext.getContextPath();</span><br></pre></td></tr></table></figure>

<ul>
<li><code>项目部署名称</code>，也叫项目上下文路径，该路径也有可能会变化，通过获取该路径来解决后续<code>后端渲染页面、请求转发和相应重定向的路径问题</code></li>
</ul>
<p>应用域对象相关API</p>
<ul>
<li><code>域对象</code>: 一些用于存储数据和传递数据的对象,传递数据不同的范围,我们称之为不同的域,不同的域对象代表不同的域,共享数据的范围也不同</li>
<li><code>ServletContext</code>代表应用,所以ServletContext域也叫作应用域,是webapp中最大的域,可以在本应用内实现数据的共享和传递</li>
<li>webapp中的三大域对象,分别是<code>应用域,会话域,请求域</code></li>
<li>后续会统一说三大域对象，其中他们共同拥有的API如下</li>
</ul>
<table>
<thead>
<tr>
<th>API</th>
<th>功能解释</th>
</tr>
</thead>
<tbody><tr>
<td>void setAttribute(String key,Object value);</td>
<td>向域中存储&#x2F;修改数据</td>
</tr>
<tr>
<td>Object getAttribute(String key);</td>
<td>获得域中的数据</td>
</tr>
<tr>
<td>void removeAttribute(String key);</td>
<td>移除域中的数据</td>
</tr>
</tbody></table>
<ul>
<li>给出一个实际案例：向资源目录下的upload文件夹上传文件（I&#x2F;O流得复习一下了）</li>
</ul>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"></span><br><span class="line"><span class="keyword">package</span> com.atguigu.com.atguigu.servlet;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> jakarta.servlet.ServletContext;</span><br><span class="line"><span class="keyword">import</span> jakarta.servlet.ServletException;</span><br><span class="line"><span class="keyword">import</span> jakarta.servlet.annotation.WebServlet;</span><br><span class="line"><span class="keyword">import</span> jakarta.servlet.http.HttpServlet;</span><br><span class="line"><span class="keyword">import</span> jakarta.servlet.http.HttpServletRequest;</span><br><span class="line"><span class="keyword">import</span> jakarta.servlet.http.HttpServletResponse;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> java.io.FileOutputStream;</span><br><span class="line"><span class="keyword">import</span> java.io.IOException;</span><br><span class="line"></span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@author</span> yuezi2048</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@version</span> 1.0</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="comment">/*</span></span><br><span class="line"><span class="comment">    C:\Users\ljy\Documents\Programs\IDEA\atguigu\javaweb\web-all\out\artifacts\demo03_servletConfig_serveletContext_war_exploded\upload</span></span><br><span class="line"><span class="comment">    /demo03_servletConfig_serveletContext_war_exploded</span></span><br><span class="line"><span class="comment">*/</span></span><br><span class="line"><span class="meta">@WebServlet(&quot;/servlet3&quot;)</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">Servlet3</span> <span class="keyword">extends</span> <span class="title class_">HttpServlet</span> &#123;</span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="keyword">protected</span> <span class="keyword">void</span> <span class="title function_">service</span><span class="params">(HttpServletRequest req, HttpServletResponse resp)</span> <span class="keyword">throws</span> ServletException, IOException &#123;</span><br><span class="line">        <span class="comment">// 向upload目录写入一个文件，由于是要部署上去的，这里仅为工程文件，我们需要通过得到真实磁盘路径，而ServletContext可以实现这个</span></span><br><span class="line">        <span class="type">ServletContext</span> <span class="variable">servletContext</span> <span class="operator">=</span> getServletContext();</span><br><span class="line">        <span class="comment">// 获得指向项目部署位置下的某个目录磁盘真实路径的api</span></span><br><span class="line">        <span class="type">String</span> <span class="variable">path</span> <span class="operator">=</span> servletContext.getRealPath(<span class="string">&quot;upload&quot;</span>);</span><br><span class="line">        System.out.println(path);</span><br><span class="line"><span class="comment">//        FileOutputStream fos = new FileOutputStream(path + &quot;/a.txt&quot;);</span></span><br><span class="line"></span><br><span class="line">        <span class="comment">// 同时也可以获得项目部署的上下文路径（项目的url访问路径）</span></span><br><span class="line">        <span class="comment">// 后续我们会学习在项目中使用相对和绝对路径去寻找目标资源(绝对路径比较固定，我们需要一个灵活的写法)</span></span><br><span class="line">        <span class="comment">// servlet1  /demo03/servlet1</span></span><br><span class="line">        <span class="type">String</span> <span class="variable">contextPath</span> <span class="operator">=</span> servletContext.getContextPath(); <span class="comment">// 获取项目的上下文路径（项目的访问路径）</span></span><br><span class="line">        System.out.println(contextPath);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>



<h2 id="7-HttpServletRequest"><a href="#7-HttpServletRequest" class="headerlink" title="7. HttpServletRequest"></a>7. HttpServletRequest</h2><h3 id="7-1-概述"><a href="#7-1-概述" class="headerlink" title="7.1 概述"></a>7.1 概述</h3><ul>
<li><code>HttpServletRequest</code>是一个接口，父接口是<code>ServletRequest</code></li>
<li><code>HttpServletRequest</code>是Tomcat将请求报文自动封装的对象，调用<code>service方法</code>时传入</li>
<li>通过HttpServletRequest对象可以获取到<code>客户端请求</code>中的相关信息</li>
</ul>
<p><img src="/img/loading.gif" data-original="https://yuezi-1308313119.cos.ap-guangzhou.myqcloud.com/typora-user-images%2Fimage-20240904214606096.png" alt="image-20240904214606096">	</p>
<h3 id="7-2-相关API"><a href="#7-2-相关API" class="headerlink" title="7.2 相关API"></a>7.2 相关API</h3><ul>
<li>获取请求行信息相关(方式,请求的url,协议及版本)</li>
</ul>
<table>
<thead>
<tr>
<th>API</th>
<th>功能解释</th>
</tr>
</thead>
<tbody><tr>
<td>StringBuffer getRequestURL();</td>
<td>获取客户端请求的url</td>
</tr>
<tr>
<td>String getRequestURI();</td>
<td>获取客户端请求项目中的具体资源</td>
</tr>
<tr>
<td>int getServerPort();</td>
<td>获取客户端发送请求时的端口</td>
</tr>
<tr>
<td>int getLocalPort();</td>
<td>获取本应用在所在容器的端口</td>
</tr>
<tr>
<td>int getRemotePort();</td>
<td>获取客户端程序的端口</td>
</tr>
<tr>
<td>String getScheme();</td>
<td>获取请求协议</td>
</tr>
<tr>
<td>String getProtocol();</td>
<td>获取请求协议及版本号</td>
</tr>
<tr>
<td>String getMethod();</td>
<td>获取请求方式</td>
</tr>
</tbody></table>
<ul>
<li>获得请求头信息相关</li>
</ul>
<table>
<thead>
<tr>
<th>API</th>
<th>功能解释</th>
</tr>
</thead>
<tbody><tr>
<td>String getHeader(String headerName);</td>
<td>根据头名称获取请求头</td>
</tr>
<tr>
<td>Enumeration<String> getHeaderNames();</td>
<td>获取所有的请求头名字</td>
</tr>
<tr>
<td>String getContentType();</td>
<td>获取content-type请求头</td>
</tr>
</tbody></table>
<ul>
<li>获得请求参数相关</li>
</ul>
<table>
<thead>
<tr>
<th>API</th>
<th>功能解释</th>
</tr>
</thead>
<tbody><tr>
<td>String getParameter(String parameterName);</td>
<td>根据请求参数名获取请求单个参数值</td>
</tr>
<tr>
<td>String[] getParameterValues(String parameterName);</td>
<td>根据请求参数名获取请求多个参数值数组</td>
</tr>
<tr>
<td>Enumeration<String> getParameterNames();</td>
<td>获取所有请求参数名</td>
</tr>
<tr>
<td>Map&lt;String, String[]&gt; getParameterMap();</td>
<td>获取所有请求参数的键值对集合</td>
</tr>
<tr>
<td>BufferedReader getReader() throws IOException;</td>
<td>获取读取请求体的字符输入流</td>
</tr>
<tr>
<td>ServletInputStream getInputStream() throws IOException;</td>
<td>获取读取请求体的字节输入流</td>
</tr>
<tr>
<td>int getContentLength();</td>
<td>获得请求体长度的字节数</td>
</tr>
</tbody></table>
<ul>
<li>其他API</li>
</ul>
<table>
<thead>
<tr>
<th>API</th>
<th>功能解释</th>
</tr>
</thead>
<tbody><tr>
<td>String getServletPath();</td>
<td>获取请求的Servlet的映射路径</td>
</tr>
<tr>
<td>ServletContext getServletContext();</td>
<td>获取ServletContext对象</td>
</tr>
<tr>
<td>Cookie[] getCookies();</td>
<td>获取请求中的所有cookie</td>
</tr>
<tr>
<td>HttpSession getSession();</td>
<td>获取Session对象</td>
</tr>
<tr>
<td>void setCharacterEncoding(String encoding) ;</td>
<td>设置请求体字符集</td>
</tr>
</tbody></table>
<blockquote>
<p> 注：URI是项目内的资源路径，URL是项目资源的完整路径</p>
</blockquote>
<h3 id="7-3-API测试"><a href="#7-3-API测试" class="headerlink" title="7.3 API测试"></a>7.3 API测试</h3><p><strong>第一组（请求头 请求体相关）</strong></p>
<p>输出</p>
<blockquote>
<p>GET<br>http<br>HTTP&#x2F;1.1<br>&#x2F;demo03_servletConfig_serveletContext_war_exploded&#x2F;servlet4<br><a target="_blank" rel="noopener" href="http://localhost:8080/demo03_servletConfig_serveletContext_war_exploded/servlet4">http://localhost:8080/demo03_servletConfig_serveletContext_war_exploded/servlet4</a><br>8080<br>8080<br>35644<br>Accept: text&#x2F;html,application&#x2F;xhtml+xml,application&#x2F;xml;q&#x3D;0.9,image&#x2F;avif,image&#x2F;webp,image&#x2F;apng,<em>&#x2F;</em>;q&#x3D;0.8,application&#x2F;signed-exchange;v&#x3D;b3;q&#x3D;0.7<br>host:  localhost:8080<br>connection:  keep-alive<br>sec-ch-ua:  “Chromium”;v&#x3D;”128”, “Not;A&#x3D;Brand”;v&#x3D;”24”, “Google Chrome”;v&#x3D;”128”<br>sec-ch-ua-mobile:  ?0<br>sec-ch-ua-platform:  “Windows”<br>upgrade-insecure-requests:  1<br>user-agent:  Mozilla&#x2F;5.0 (Windows NT 10.0; Win64; x64) AppleWebKit&#x2F;537.36 (KHTML, like Gecko) Chrome&#x2F;128.0.0.0 Safari&#x2F;537.36<br>accept:  text&#x2F;html,application&#x2F;xhtml+xml,application&#x2F;xml;q&#x3D;0.9,image&#x2F;avif,image&#x2F;webp,image&#x2F;apng,<em>&#x2F;</em>;q&#x3D;0.8,application&#x2F;signed-exchange;v&#x3D;b3;q&#x3D;0.7<br>sec-fetch-site:  none<br>sec-fetch-mode:  navigate<br>sec-fetch-user:  ?1<br>sec-fetch-dest:  document<br>accept-encoding:  gzip, deflate, br, zstd<br>accept-language:  zh-CN,zh;q&#x3D;0.9<br>cookie:  username-localhost-8888&#x3D;”2|1:0|10:1724759932|23:username-localhost-8888|44:NDFmNDQ5NThiYjYyNGQwODhhMGNlZDRlY2M2NDRhOTY&#x3D;|46fb35176fe15fb76e70d9a08234baf1d7312b5dae1964abc190e75c756357f2”</p>
</blockquote>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="keyword">package</span> com.atguigu.com.atguigu.servlet;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> jakarta.servlet.ServletException;</span><br><span class="line"><span class="keyword">import</span> jakarta.servlet.annotation.WebServlet;</span><br><span class="line"><span class="keyword">import</span> jakarta.servlet.http.HttpServlet;</span><br><span class="line"><span class="keyword">import</span> jakarta.servlet.http.HttpServletRequest;</span><br><span class="line"><span class="keyword">import</span> jakarta.servlet.http.HttpServletResponse;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> java.io.IOException;</span><br><span class="line"><span class="keyword">import</span> java.util.Enumeration;</span><br><span class="line"></span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@author</span> yuezi2048</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@version</span> 1.0</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="meta">@WebServlet(&quot;/servlet4&quot;)</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">Servlet4</span> <span class="keyword">extends</span> <span class="title class_">HttpServlet</span> &#123;</span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="keyword">protected</span> <span class="keyword">void</span> <span class="title function_">service</span><span class="params">(HttpServletRequest req, HttpServletResponse resp)</span> <span class="keyword">throws</span> ServletException, IOException &#123;</span><br><span class="line">        <span class="comment">// 行相关 GET/POST URI http/1.1</span></span><br><span class="line">        System.out.println(req.getMethod()); <span class="comment">// 获取请求方式</span></span><br><span class="line">        System.out.println(req.getScheme()); <span class="comment">// 获取请求协议</span></span><br><span class="line">        System.out.println(req.getProtocol()); <span class="comment">// 获取请求协议及版本号</span></span><br><span class="line">        System.out.println(req.getRequestURI()); <span class="comment">// URI: 项目内的资源路径</span></span><br><span class="line">        System.out.println(req.getRequestURL()); <span class="comment">// URL: 项目内资源的完整路径</span></span><br><span class="line">        <span class="comment">/*</span></span><br><span class="line"><span class="comment">         * URI: 统一资源标识符 /demo03/a.html                   interface URI()             是资源定位的要求规范  动物类</span></span><br><span class="line"><span class="comment">         * URL: 统一资源定位符 http://ip:port/demo03/a.html     class URL implements URI&#123;&#125;  一个具体的资源路径   哺乳动物类</span></span><br><span class="line"><span class="comment">         */</span></span><br><span class="line">        System.out.println(req.getLocalPort()); <span class="comment">// 获取本应用容器的端口号                  8080</span></span><br><span class="line">        System.out.println(req.getServerPort()); <span class="comment">// 获取客户端请求时的端口号（代理会用到）   8888</span></span><br><span class="line">        System.out.println(req.getRemotePort()); <span class="comment">// 获取客户端软件的端口号                 4325（浏览器进程）</span></span><br><span class="line"></span><br><span class="line">        <span class="comment">// 头相关 k:v</span></span><br><span class="line">        <span class="comment">// 根据名字获取某个请求头</span></span><br><span class="line">        <span class="type">String</span> <span class="variable">accept</span> <span class="operator">=</span> req.getHeader(<span class="string">&quot;Accept&quot;</span>);</span><br><span class="line">        System.out.println(<span class="string">&quot;Accept: &quot;</span> + accept);</span><br><span class="line"></span><br><span class="line">        <span class="comment">// 如果不知道有什么名字，可以获取所有k</span></span><br><span class="line">        Enumeration&lt;String&gt; headerNames = req.getHeaderNames();</span><br><span class="line">        <span class="keyword">while</span> (headerNames.hasMoreElements()) &#123;</span><br><span class="line">            <span class="type">String</span> <span class="variable">headerName</span> <span class="operator">=</span> headerNames.nextElement();</span><br><span class="line">            System.out.println(headerName + <span class="string">&quot;:  &quot;</span> + req.getHeader(headerName));</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br></pre></td></tr></table></figure>



<p><strong>第二组（请求参数相关）</strong></p>
<p>输出</p>
<blockquote>
<p>admin<br>password</p>
<p>[1, 2, 3]</p>
<p>&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;</p>
<p>username&#x3D;admin<br>password&#x3D;password</p>
<p>hobby&#x3D;[1, 2, 3]</p>
<p>&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;</p>
<p>username &#x3D; admin<br>password &#x3D; password<br>hobby &#x3D; [1, 2, 3]</p>
</blockquote>
<blockquote>
<p>注1：如果是要<code>输出所有的k-v</code>，字典的值我们默认都定义为String[]，再根据数组的长度再做进一步处理（也可以通过获取所有map集合的API）</p>
<p>注2：如果是<code>非键值对</code>，如JSON 文件，需要按照情况使用字符输入流或字节输入流来读取，后面的操作见I&#x2F;O相关知识</p>
</blockquote>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="keyword">package</span> com.atguigu.com.atguigu.servlet;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> jakarta.servlet.ServletException;</span><br><span class="line"><span class="keyword">import</span> jakarta.servlet.ServletInputStream;</span><br><span class="line"><span class="keyword">import</span> jakarta.servlet.annotation.WebServlet;</span><br><span class="line"><span class="keyword">import</span> jakarta.servlet.http.HttpServlet;</span><br><span class="line"><span class="keyword">import</span> jakarta.servlet.http.HttpServletRequest;</span><br><span class="line"><span class="keyword">import</span> jakarta.servlet.http.HttpServletResponse;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> java.io.BufferedReader;</span><br><span class="line"><span class="keyword">import</span> java.io.IOException;</span><br><span class="line"><span class="keyword">import</span> java.util.Arrays;</span><br><span class="line"><span class="keyword">import</span> java.util.Enumeration;</span><br><span class="line"><span class="keyword">import</span> java.util.Map;</span><br><span class="line"><span class="keyword">import</span> java.util.Set;</span><br><span class="line"></span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@author</span> yuezi2048</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@version</span> 1.0</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="meta">@WebServlet(&quot;/servlet5&quot;)</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">Servlet5</span> <span class="keyword">extends</span> <span class="title class_">HttpServlet</span> &#123;</span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="keyword">protected</span> <span class="keyword">void</span> <span class="title function_">service</span><span class="params">(HttpServletRequest req, HttpServletResponse resp)</span> <span class="keyword">throws</span> ServletException, IOException &#123;</span><br><span class="line">        <span class="comment">// 接受请求中【键值对】类型的参数(请求行和请求体中都可以)</span></span><br><span class="line">        <span class="comment">// 根据参数名获取单个参数值</span></span><br><span class="line">        <span class="type">String</span> <span class="variable">username</span> <span class="operator">=</span> req.getParameter(<span class="string">&quot;username&quot;</span>);</span><br><span class="line">        System.out.println(username);</span><br><span class="line">        <span class="type">String</span> <span class="variable">password</span> <span class="operator">=</span> req.getParameter(<span class="string">&quot;password&quot;</span>);</span><br><span class="line">        System.out.println(password);</span><br><span class="line"></span><br><span class="line">        <span class="comment">// 根据参数名获取多个参数值</span></span><br><span class="line">        String[] hobbies = req.getParameterValues(<span class="string">&quot;hobby&quot;</span>);</span><br><span class="line">        System.out.println(Arrays.toString(hobbies));</span><br><span class="line">        System.out.println(<span class="string">&quot;============================&quot;</span>);</span><br><span class="line"></span><br><span class="line">        <span class="comment">// 获取所有参数名</span></span><br><span class="line">        Enumeration&lt;String&gt; parameterNames = req.getParameterNames();</span><br><span class="line">        <span class="keyword">while</span> (parameterNames.hasMoreElements()) &#123;</span><br><span class="line">            <span class="type">String</span> <span class="variable">parameterName</span> <span class="operator">=</span> parameterNames.nextElement();</span><br><span class="line">            String[] parameterValues = req.getParameterValues(parameterName); <span class="comment">// 统一用多个长度处理</span></span><br><span class="line">            <span class="keyword">if</span> (parameterValues.length &gt; <span class="number">1</span>) &#123;</span><br><span class="line">                System.out.println(parameterName + <span class="string">&quot;=&quot;</span> + Arrays.toString(parameterValues));</span><br><span class="line">            &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">                System.out.println(parameterName + <span class="string">&quot;=&quot;</span> + parameterValues[<span class="number">0</span>]);</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">        System.out.println(<span class="string">&quot;============================&quot;</span>);</span><br><span class="line"></span><br><span class="line">        <span class="comment">// 可以返回所有map集合 k 参数名，v 参数值</span></span><br><span class="line">        Map&lt;String, String[]&gt; parameterMap = req.getParameterMap();</span><br><span class="line">        Set&lt;Map.Entry&lt;String, String[]&gt;&gt; entries = parameterMap.entrySet();</span><br><span class="line">        <span class="keyword">for</span> (Map.Entry&lt;String, String[]&gt; entry : entries) &#123;</span><br><span class="line">            System.out.print(entry.getKey() + <span class="string">&quot; = &quot;</span>);</span><br><span class="line">            <span class="keyword">if</span> (entry.getValue().length &gt; <span class="number">1</span>) &#123;</span><br><span class="line">                System.out.println(Arrays.toString(entry.getValue()));</span><br><span class="line">            &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">                System.out.println(entry.getValue()[<span class="number">0</span>]);</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        <span class="comment">/*</span></span><br><span class="line"><span class="comment">            请求</span></span><br><span class="line"><span class="comment">                请求行     方式 URI http/1.1</span></span><br><span class="line"><span class="comment">                请求头</span></span><br><span class="line"><span class="comment">                请求体</span></span><br><span class="line"><span class="comment"></span></span><br><span class="line"><span class="comment">            form表单</span></span><br><span class="line"><span class="comment">                get：参数以键值对的形式放在URL后，不放在请求体里，但是GET请求也可以有请求体</span></span><br><span class="line"><span class="comment">                post</span></span><br><span class="line"><span class="comment"></span></span><br><span class="line"><span class="comment">            获得请求体中非键值对数据</span></span><br><span class="line"><span class="comment">                JSON串（字符输入流）</span></span><br><span class="line"><span class="comment">                文件（字节输入流）</span></span><br><span class="line"><span class="comment">         */</span></span><br><span class="line">        <span class="comment">// 从请求体中获取字符输入流</span></span><br><span class="line">        <span class="type">BufferedReader</span> <span class="variable">reader</span> <span class="operator">=</span> req.getReader();</span><br><span class="line">        <span class="type">ServletInputStream</span> <span class="variable">inputStream</span> <span class="operator">=</span> req.getInputStream();</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br></pre></td></tr></table></figure>



<h2 id="8-HttpServletResponse"><a href="#8-HttpServletResponse" class="headerlink" title="8. HttpServletResponse"></a>8. HttpServletResponse</h2><h3 id="8-1-概述"><a href="#8-1-概述" class="headerlink" title="8.1 概述"></a>8.1 概述</h3><ul>
<li><code>HttpServletResponse</code>是一个接口,其父接口是<code>ServletResponse</code></li>
</ul>
<ul>
<li>同样地，HttpServletResponse是Tomcat预先创建的，在调用service方法传入</li>
<li>HttpServletResponse代表的是客户端的响应，该对象会转化成响应报文发送给客户端，我们可以通过该对象<code>设置响应信息</code></li>
</ul>
<p><img src="/img/loading.gif" data-original="https://yuezi-1308313119.cos.ap-guangzhou.myqcloud.com/typora-user-images%2Fimage-20240904220100850.png" alt="image-20240904220100850">	</p>
<h3 id="8-2-相关API"><a href="#8-2-相关API" class="headerlink" title="8.2 相关API"></a>8.2 相关API</h3><ul>
<li>设置响应行相关</li>
</ul>
<table>
<thead>
<tr>
<th>API</th>
<th>功能解释</th>
</tr>
</thead>
<tbody><tr>
<td>void setStatus(int  code);</td>
<td>设置响应状态码</td>
</tr>
</tbody></table>
<ul>
<li>设置响应头相关</li>
</ul>
<table>
<thead>
<tr>
<th>API</th>
<th>功能解释</th>
</tr>
</thead>
<tbody><tr>
<td>void setHeader(String headerName, String headerValue);</td>
<td>设置&#x2F;修改响应头键值对</td>
</tr>
<tr>
<td>void setContentType(String contentType);</td>
<td>设置content-type响应头及响应字符集(设置MIME类型)</td>
</tr>
</tbody></table>
<ul>
<li>设置响应体相关</li>
</ul>
<table>
<thead>
<tr>
<th>API</th>
<th>功能解释</th>
</tr>
</thead>
<tbody><tr>
<td>PrintWriter getWriter() throws IOException;</td>
<td>获得向响应体放入信息的字符输出流</td>
</tr>
<tr>
<td>ServletOutputStream getOutputStream() throws IOException;</td>
<td>获得向响应体放入信息的字节输出流</td>
</tr>
<tr>
<td>void setContentLength(int length);</td>
<td>设置响应体的字节长度,其实就是在设置content-length响应头</td>
</tr>
</tbody></table>
<ul>
<li>其他API</li>
</ul>
<table>
<thead>
<tr>
<th>API</th>
<th>功能解释</th>
</tr>
</thead>
<tbody><tr>
<td>void sendError(int code, String message) throws IOException;</td>
<td>向客户端响应错误信息的方法,需要指定响应码和响应信息</td>
</tr>
<tr>
<td>void addCookie(Cookie cookie);</td>
<td>向响应体中增加cookie</td>
</tr>
<tr>
<td>void setCharacterEncoding(String encoding);</td>
<td>设置响应体字符集</td>
</tr>
</tbody></table>
<blockquote>
<p>MIME类型</p>
</blockquote>
<ul>
<li>MIME类型,可以理解为文档类型,用户表示传递的数据是属于什么类型的文档</li>
<li>浏览器可以根据MIME类型决定该用什么样的方式解析接收到的响应体数据</li>
<li>可以这样理解: 前后端交互数据时,告诉对方发给对方的是 html&#x2F;css&#x2F;js&#x2F;图片&#x2F;声音&#x2F;视频&#x2F;… …</li>
<li>tomcat&#x2F;conf&#x2F;web.xml中配置了常见文件的拓展名和MIMIE类型的对应关系</li>
<li>常见的MIME类型举例如下</li>
</ul>
<table>
<thead>
<tr>
<th>文件拓展名</th>
<th>MIME类型</th>
</tr>
</thead>
<tbody><tr>
<td>.html</td>
<td>text&#x2F;html</td>
</tr>
<tr>
<td>.css</td>
<td>text&#x2F;css</td>
</tr>
<tr>
<td>.js</td>
<td>application&#x2F;javascript</td>
</tr>
<tr>
<td>.png &#x2F;.jpeg&#x2F;.jpg&#x2F;… …</td>
<td>image&#x2F;jpeg</td>
</tr>
<tr>
<td>.mp3&#x2F;.mpe&#x2F;.mpeg&#x2F; … …</td>
<td>audio&#x2F;mpeg</td>
</tr>
<tr>
<td>.mp4</td>
<td>video&#x2F;mp4</td>
</tr>
<tr>
<td>.m1v&#x2F;.m1v&#x2F;.m2v&#x2F;.mpe&#x2F;… …</td>
<td>video&#x2F;mpeg</td>
</tr>
</tbody></table>
<h3 id="8-3-测试"><a href="#8-3-测试" class="headerlink" title="8.3 测试"></a>8.3 测试</h3><p>Servlet6响应数据如下</p>
<p><img src="/img/loading.gif" data-original="https://yuezi-1308313119.cos.ap-guangzhou.myqcloud.com/typora-user-images%2Fimage-20240904221246005.png" alt="image-20240904221246005">	</p>
<blockquote>
<p>HTTP&#x2F;1.1 200<br>Content-Type: text&#x2F;html;charset&#x3D;UTF-8<br>Content-Length: 14<br>Date: Wed, 04 Sep 2024 14:07:02 GMT<br>Keep-Alive: timeout&#x3D;20<br>Connection: keep-alive</p>
</blockquote>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="keyword">package</span> com.atguigu.com.atguigu.servlet;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> jakarta.servlet.ServletException;</span><br><span class="line"><span class="keyword">import</span> jakarta.servlet.ServletOutputStream;</span><br><span class="line"><span class="keyword">import</span> jakarta.servlet.annotation.WebServlet;</span><br><span class="line"><span class="keyword">import</span> jakarta.servlet.http.HttpServlet;</span><br><span class="line"><span class="keyword">import</span> jakarta.servlet.http.HttpServletRequest;</span><br><span class="line"><span class="keyword">import</span> jakarta.servlet.http.HttpServletResponse;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> java.io.IOException;</span><br><span class="line"><span class="keyword">import</span> java.io.PrintWriter;</span><br><span class="line"></span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@author</span> yuezi2048</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@version</span> 1.0</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="meta">@WebServlet(&quot;/servlet6&quot;)</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">Servlet6</span> <span class="keyword">extends</span> <span class="title class_">HttpServlet</span> &#123;</span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="keyword">protected</span> <span class="keyword">void</span> <span class="title function_">service</span><span class="params">(HttpServletRequest req, HttpServletResponse resp)</span> <span class="keyword">throws</span> ServletException, IOException &#123;</span><br><span class="line">        <span class="type">String</span> <span class="variable">info</span> <span class="operator">=</span> <span class="string">&quot;&lt;h1&gt;hello&lt;/h1&gt;&quot;</span>;</span><br><span class="line"></span><br><span class="line">        <span class="comment">// 设置响应行相关API HTTP/1.1 200/404/405/500</span></span><br><span class="line">        resp.setStatus(<span class="number">200</span>);</span><br><span class="line"></span><br><span class="line">        <span class="comment">// 设置响应头相关API</span></span><br><span class="line"><span class="comment">//        resp.setHeader(&quot;aaa&quot;, &quot;valueA&quot;);</span></span><br><span class="line"><span class="comment">//        resp.setHeader(&quot;Content-Type&quot;, &quot;text/html&quot;);</span></span><br><span class="line">        resp.setHeader(<span class="string">&quot;Content-Length&quot;</span>, <span class="string">&quot;1234&quot;</span>);</span><br><span class="line">        resp.setContentType(<span class="string">&quot;text/html&quot;</span>);</span><br><span class="line">        resp.setContentLength(info.getBytes().length); <span class="comment">// 可以通过变量来计算得出</span></span><br><span class="line"></span><br><span class="line">        <span class="comment">// 设置响应体内容API</span></span><br><span class="line">        <span class="comment">// 获得向响应体输入文本字符输出流</span></span><br><span class="line">        <span class="type">PrintWriter</span> <span class="variable">writer</span> <span class="operator">=</span> resp.getWriter();</span><br><span class="line">        <span class="comment">// print可以打印object write没有</span></span><br><span class="line">        writer.write(info);</span><br><span class="line"></span><br><span class="line">        <span class="comment">// 获得向响应体输入二进制信息的字节输出流</span></span><br><span class="line">        <span class="comment">// ServletOutputStream outputStream = resp.getOutputStream();</span></span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>





<h2 id="9-请求转发和响应重定向"><a href="#9-请求转发和响应重定向" class="headerlink" title="9. 请求转发和响应重定向"></a>9. 请求转发和响应重定向</h2><h3 id="9-1-概念"><a href="#9-1-概念" class="headerlink" title="9.1 概念"></a>9.1 概念</h3><p>什么是<code>请求转发</code>和<code>响应重定向</code>？</p>
<ul>
<li>请求转发是通过<code>HttpServletRequest</code>实现</li>
<li>响应重定向是通过<code>HttpServletResponse</code>实现</li>
<li>目的都是为了<strong>间接访问web资源和控制页面跳转</strong>（上课给出了张三借钱的例子，我的理解：请求转发就是代理转发，响应重定向是类似于DNS的迭代查询的过程）</li>
</ul>
<p>后面测试用的代码框架如下</p>
<p><img src="/img/loading.gif" data-original="https://yuezi-1308313119.cos.ap-guangzhou.myqcloud.com/typora-user-images%2Fimage-20240904222623608.png" alt="image-20240904222623608">	</p>
<h3 id="9-2-请求转发"><a href="#9-2-请求转发" class="headerlink" title="9.2 请求转发"></a>9.2 请求转发</h3><p><code>请求转发</code>图解</p>
<p><img src="/img/loading.gif" data-original="https://yuezi-1308313119.cos.ap-guangzhou.myqcloud.com/typora-user-images%2Fimage-20240904221755166.png" alt="image-20240904221755166">	</p>
<p>请求转发特点（背诵）</p>
<ul>
<li>请求转发是通过HttpServletRequest对象的<code>requestDispatcher</code>实现的</li>
<li>请求转发是服务器内部的行为，对客户端是屏蔽的</li>
<li>客户端只发送了一次请求，客户端的地址栏保持不变</li>
<li>服务端只产生一堆请求和响应的对象，请求转发时会将请求和响应对象传递给下一个资源</li>
<li>请求转发可以转发Servlet动态资源，也可以是静态资源实现页面跳转</li>
<li>目标资源可以是WEB-INF下受保护资源，该方式是访问WEB-INF下目录的【唯一】方式</li>
<li>但不可以访问本项目以外的外部资源</li>
</ul>
<p>测试</p>
<p>客户端ServletA</p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="keyword">package</span> com.atguigu.servlet;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> jakarta.servlet.RequestDispatcher;</span><br><span class="line"><span class="keyword">import</span> jakarta.servlet.ServletException;</span><br><span class="line"><span class="keyword">import</span> jakarta.servlet.annotation.WebServlet;</span><br><span class="line"><span class="keyword">import</span> jakarta.servlet.http.HttpServlet;</span><br><span class="line"><span class="keyword">import</span> jakarta.servlet.http.HttpServletRequest;</span><br><span class="line"><span class="keyword">import</span> jakarta.servlet.http.HttpServletResponse;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> java.io.IOException;</span><br><span class="line"></span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@author</span> yuezi2048</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@version</span> 1.0</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="meta">@WebServlet(&quot;/servletA&quot;)</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">ServletA</span> <span class="keyword">extends</span> <span class="title class_">HttpServlet</span> &#123;</span><br><span class="line">    <span class="comment">/*</span></span><br><span class="line"><span class="comment">        请求转发 特点：要背出来</span></span><br><span class="line"><span class="comment">        1. 请求转发是通过HttpServletRequest对象实现的</span></span><br><span class="line"><span class="comment">        2. 请求转发是服务器内部行为，对客户端是屏蔽的</span></span><br><span class="line"><span class="comment">        3. 客户端只产生一次请求，服务端只产生一对request和response对象</span></span><br><span class="line"><span class="comment">        4. 客户端的地址栏是不变的</span></span><br><span class="line"><span class="comment">        5. 请求的参数是可以继续传递的（因为转发器传递了req和resp）</span></span><br><span class="line"><span class="comment">        6. 目标资源除了是Servlet动态资源，也可以是html等静态资源</span></span><br><span class="line"><span class="comment">        7. 目标资源可以是WEB-INF下的受保护资源，该方式是访问WEB-INF资源的【唯一】方式</span></span><br><span class="line"><span class="comment">        8. 请求转发不可以访问外部资源</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line"></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="keyword">protected</span> <span class="keyword">void</span> <span class="title function_">service</span><span class="params">(HttpServletRequest req, HttpServletResponse resp)</span> <span class="keyword">throws</span> ServletException, IOException &#123;</span><br><span class="line">        System.out.println(<span class="string">&quot;ServletA run...&quot;</span>);</span><br><span class="line"></span><br><span class="line">        <span class="type">String</span> <span class="variable">money</span> <span class="operator">=</span> req.getParameter(<span class="string">&quot;money&quot;</span>);</span><br><span class="line">        System.out.println(<span class="string">&quot;ServletA money: &quot;</span> + money);</span><br><span class="line"></span><br><span class="line">        <span class="comment">// 请求转发给ServletB</span></span><br><span class="line">        <span class="comment">// 根据目标资源路径 定义请求转发器</span></span><br><span class="line"><span class="comment">//        RequestDispatcher requestDispatcher = req.getRequestDispatcher(&quot;servletB&quot;);</span></span><br><span class="line"><span class="comment">//        RequestDispatcher requestDispatcher = req.getRequestDispatcher(&quot;a.html&quot;);</span></span><br><span class="line"><span class="comment">//        requestDispatcher requestDispatcher = req.getRequestDispatcher(&quot;http://www.atguigu.com&quot;); // 不可以访问外部资源</span></span><br><span class="line">        <span class="type">RequestDispatcher</span> <span class="variable">requestDispatcher</span> <span class="operator">=</span> req.getRequestDispatcher(<span class="string">&quot;WEB-INF/b.html&quot;</span>); <span class="comment">// 受保护资源是可以通过请求转发获取的</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">        <span class="comment">// 让请求转发器做出转发动作</span></span><br><span class="line">        requestDispatcher.forward(req, resp);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br></pre></td></tr></table></figure>



<p>服务端ServletB</p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="keyword">package</span> com.atguigu.servlet;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> jakarta.servlet.ServletException;</span><br><span class="line"><span class="keyword">import</span> jakarta.servlet.annotation.WebServlet;</span><br><span class="line"><span class="keyword">import</span> jakarta.servlet.http.HttpServlet;</span><br><span class="line"><span class="keyword">import</span> jakarta.servlet.http.HttpServletRequest;</span><br><span class="line"><span class="keyword">import</span> jakarta.servlet.http.HttpServletResponse;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> java.io.IOException;</span><br><span class="line"></span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@author</span> yuezi2048</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@version</span> 1.0</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="meta">@WebServlet(&quot;/servletB&quot;)</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">ServletB</span> <span class="keyword">extends</span> <span class="title class_">HttpServlet</span> &#123;</span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="keyword">protected</span> <span class="keyword">void</span> <span class="title function_">service</span><span class="params">(HttpServletRequest req, HttpServletResponse resp)</span> <span class="keyword">throws</span> ServletException, IOException &#123;</span><br><span class="line">        System.out.println(<span class="string">&quot;ServletB run...&quot;</span>);</span><br><span class="line">        <span class="type">String</span> <span class="variable">money</span> <span class="operator">=</span> req.getParameter(<span class="string">&quot;money&quot;</span>);</span><br><span class="line">        System.out.println(<span class="string">&quot;ServletB money: &quot;</span> + money);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br></pre></td></tr></table></figure>



<p><strong>测试结果</strong></p>
<p>请求URL：<a target="_blank" rel="noopener" href="http://localhost:8080/demo04_forward_redirect1_war_exploded/servletA?money=100">http://localhost:8080/demo04_forward_redirect1_war_exploded/servletA?money=100</a></p>
<p>响应：WEB-INF目录下的b.html正常显示，但地址栏没有变化</p>
<p><img src="/img/loading.gif" data-original="https://yuezi-1308313119.cos.ap-guangzhou.myqcloud.com/typora-user-images%2Fimage-20240904222505113.png" alt="image-20240904222505113">	</p>
<p>控制台输出：</p>
<blockquote>
<p>ServletA run…<br>ServletA money: 100</p>
</blockquote>
<h3 id="9-3-响应重定向"><a href="#9-3-响应重定向" class="headerlink" title="9.3 响应重定向"></a>9.3 响应重定向</h3><p><code>响应重定向</code>图解</p>
<p><img src="/img/loading.gif" data-original="https://yuezi-1308313119.cos.ap-guangzhou.myqcloud.com/typora-user-images%2Fimage-20240904222934797.png" alt="image-20240904222934797"></p>
<p>响应重定向特点（背诵）</p>
<ul>
<li>重定向是通过HttpServletResponse对象的<code>sendRedirect</code>方法实现的（状态码status为302 + 重定向链接location）</li>
<li>响应重定向是给服务端提示302和路径后，由用户端重新发起请求的行为</li>
<li>客户端至少发送了两次请求，客户端的地址栏发生变化</li>
<li>服务端产生多次请求和响应对象，这些对象不会传递给下一个资源</li>
<li>重定向可以是Servlet动态资源，也可以是静态资源实现页面跳转</li>
<li>重定向不可以访问WEB-INF目录下受保护资源</li>
<li>但可以访问本项目以外的外部资源</li>
</ul>
<p>在一般的页面跳转场景中（除了参数传递和访问WEB-INF的场景），我们一般都是考虑响应重定向的方式</p>
<p><strong>客户端ServletC</strong></p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="keyword">package</span> com.atguigu.servlet;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> jakarta.servlet.ServletException;</span><br><span class="line"><span class="keyword">import</span> jakarta.servlet.annotation.WebServlet;</span><br><span class="line"><span class="keyword">import</span> jakarta.servlet.http.HttpServlet;</span><br><span class="line"><span class="keyword">import</span> jakarta.servlet.http.HttpServletRequest;</span><br><span class="line"><span class="keyword">import</span> jakarta.servlet.http.HttpServletResponse;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> java.io.IOException;</span><br><span class="line"></span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@author</span> yuezi2048</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@version</span> 1.0</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="meta">@WebServlet(&quot;/servletC&quot;)</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">ServletC</span> <span class="keyword">extends</span> <span class="title class_">HttpServlet</span> &#123;</span><br><span class="line">    <span class="comment">/*</span></span><br><span class="line"><span class="comment">        响应重定向结论（背诵）</span></span><br><span class="line"><span class="comment">        1. 重定向是通过HttpServletResponse对象实现</span></span><br><span class="line"><span class="comment">        2. 响应重定向是服务端提示下，客户端的行为</span></span><br><span class="line"><span class="comment">        3. 客户端的地址栏是变化的</span></span><br><span class="line"><span class="comment">        4. 客户端至少发送两次请求，即产生了多次请求</span></span><br><span class="line"><span class="comment">        5. 请求产生了多次，后端就会有多个request对象，此时请求中的参数不会继续传递</span></span><br><span class="line"><span class="comment">        6. 目标资源可以是视图静态资源</span></span><br><span class="line"><span class="comment">        7. 无法访问WEB-INF目录下的受保护资源</span></span><br><span class="line"><span class="comment">        8. 但可以访问外部资源</span></span><br><span class="line"><span class="comment"></span></span><br><span class="line"><span class="comment">        重点：除了参数传递、访问外部资源和WEB-INF的场景下不能用重定向，控制一般的【页面跳转】 优先使用重定向</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="keyword">protected</span> <span class="keyword">void</span> <span class="title function_">service</span><span class="params">(HttpServletRequest req, HttpServletResponse resp)</span> <span class="keyword">throws</span> ServletException, IOException &#123;</span><br><span class="line">        <span class="comment">// 接收用户请求</span></span><br><span class="line">        System.out.println(<span class="string">&quot;ServletC嗷嗷 run ...&quot;</span>);</span><br><span class="line"></span><br><span class="line">        System.out.println(<span class="string">&quot;ServletC get money: &quot;</span> + req.getParameter(<span class="string">&quot;money&quot;</span>));</span><br><span class="line"></span><br><span class="line">        <span class="comment">// 响应重定向</span></span><br><span class="line"><span class="comment">//        resp.setStatus(302);</span></span><br><span class="line"><span class="comment">//        resp.setHeader(&quot;location&quot;, &quot;servletD&quot;);</span></span><br><span class="line"><span class="comment">//        resp.sendRedirect(&quot;servletD&quot;); // 1. 设置响应状态码302；2. 同时设置location响应头</span></span><br><span class="line"><span class="comment">//        resp.sendRedirect(&quot;a.html&quot;);</span></span><br><span class="line"><span class="comment">//        resp.sendRedirect(&quot;WEB-INF/b.html&quot;); // 不可以访问WEB-INF受保护资源（相当于让浏览器访问WEB-INF资源）</span></span><br><span class="line">        resp.sendRedirect(<span class="string">&quot;http://www.atguigu.com&quot;</span>); <span class="comment">// 但可以访问外部资源</span></span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>





<p><strong>服务端ServletD</strong></p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="keyword">package</span> com.atguigu.servlet;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> jakarta.servlet.ServletException;</span><br><span class="line"><span class="keyword">import</span> jakarta.servlet.annotation.WebServlet;</span><br><span class="line"><span class="keyword">import</span> jakarta.servlet.http.HttpServlet;</span><br><span class="line"><span class="keyword">import</span> jakarta.servlet.http.HttpServletRequest;</span><br><span class="line"><span class="keyword">import</span> jakarta.servlet.http.HttpServletResponse;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> java.io.IOException;</span><br><span class="line"></span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@author</span> yuezi2048</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@version</span> 1.0</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="meta">@WebServlet(&quot;/servletD&quot;)</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">ServletD</span> <span class="keyword">extends</span> <span class="title class_">HttpServlet</span> &#123;</span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="keyword">protected</span> <span class="keyword">void</span> <span class="title function_">service</span><span class="params">(HttpServletRequest req, HttpServletResponse resp)</span> <span class="keyword">throws</span> ServletException, IOException &#123;</span><br><span class="line">        System.out.println(<span class="string">&quot;ServletD run...&quot;</span>);</span><br><span class="line"></span><br><span class="line">        System.out.println(<span class="string">&quot;ServletD get money: &quot;</span> + req.getParameter(<span class="string">&quot;money&quot;</span>));</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>



<p>测试结果</p>
<p>请求URL：<a target="_blank" rel="noopener" href="http://localhost:8080/demo04_forward_redirect1_war_exploded/servletC?money=100">http://localhost:8080/demo04_forward_redirect1_war_exploded/servletC?money=100</a></p>
<p>响应报文：</p>
<figure class="highlight html"><table><tr><td class="code"><pre><span class="line">HTTP/1.1 302</span><br><span class="line">Location: http://www.atguigu.com</span><br><span class="line">Content-Length: 0</span><br><span class="line">Date: Wed, 04 Sep 2024 14:27:25 GMT</span><br><span class="line">Keep-Alive: timeout=20</span><br><span class="line">Connection: keep-alive</span><br></pre></td></tr></table></figure>

<p>控制台日志</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">ServletC嗷嗷 run ...</span><br><span class="line">ServletC get money: 100</span><br></pre></td></tr></table></figure>



<p>最终显示的是<a target="_blank" rel="noopener" href="http://www.atguigu.com的界面/">www.atguigu.com的界面</a></p>
<h2 id="10-乱码和路径问题总结"><a href="#10-乱码和路径问题总结" class="headerlink" title="10. 乱码和路径问题总结"></a>10. 乱码和路径问题总结</h2><h3 id="10-1-乱码问题"><a href="#10-1-乱码问题" class="headerlink" title="10.1 乱码问题"></a>10.1 乱码问题</h3><p>乱码问题本质上是<code>字符集</code>问题，有两种情况</p>
<ul>
<li>编码和解码不是同一个字符集</li>
<li>使用了不支持的字符集</li>
</ul>
<p>字符集的兼容性如下，可以看到<code>ASCII</code>作为最基础的编码，到哪里都不会乱码</p>
<p><img src="/img/loading.gif" data-original="https://yuezi-1308313119.cos.ap-guangzhou.myqcloud.com/typora-user-images%2Fimage-20240905215520907.png" alt="image-20240905215520907">	</p>
<blockquote>
<p>第一种情况：HTML<strong>前端</strong>：</p>
</blockquote>
<p>视图文件会在头标签声明浏览器用什么字符集来解析当前文件</p>
<figure class="highlight html"><table><tr><td class="code"><pre><span class="line"><span class="meta">&lt;!DOCTYPE <span class="keyword">html</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">html</span> <span class="attr">lang</span>=<span class="string">&quot;en&quot;</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">head</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">meta</span> <span class="attr">charset</span>=<span class="string">&quot;UTF-8&quot;</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">title</span>&gt;</span>Title<span class="tag">&lt;/<span class="name">title</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">head</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">body</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">body</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">html</span>&gt;</span></span><br></pre></td></tr></table></figure>

<p>在idea中编码中，<code>Global Encoding</code> 全局字符集,<code>Project Encoding</code> 项目字符集, <code>Properties Files</code> 属性配置文件字符集，其中全局要和HTML一致</p>
<p><img src="/img/loading.gif" data-original="https://yuezi-1308313119.cos.ap-guangzhou.myqcloud.com/typora-user-images%2Fimage-20240906193021241.png" alt="image-20240906193021241">	</p>
<blockquote>
<p><strong>第二种：Tomcat乱码</strong></p>
</blockquote>
<p><code>tomcat/conf/logging.properties</code>中,所有的UTF-8为GBK即可</p>
<img src="/img/loading.gif" data-original="https://yuezi-1308313119.cos.ap-guangzhou.myqcloud.com/typora-user-images%2Fimage-20240906193141751.png" alt="image-20240906193141751" style="zoom:67%;" />	



<p>在sout控制台打印时，如果出现乱码，是因为JVM虚拟机在类加载时的编码和编译时的编码不一致（如果在没有乱码的问题下，不要随便修改，知道有这回事即可）</p>
<ul>
<li>我们修改<code>JVM加载class文件的字符集</code>和编译时的字符集和一致即可</li>
</ul>
<img src="/img/loading.gif" data-original="https://yuezi-1308313119.cos.ap-guangzhou.myqcloud.com/typora-user-images%2Fimage-20240906193255178.png" alt="image-20240906193255178" style="zoom:80%;" />		



<blockquote>
<p><strong>第三种情况：请求乱码问题</strong></p>
</blockquote>
<p><img src="/img/loading.gif" data-original="https://yuezi-1308313119.cos.ap-guangzhou.myqcloud.com/typora-user-images%2Fimage-20240906193737958.png" alt="image-20240906193737958">	</p>
<p>对于<code>GET请求</code>：请求时将参数放入URL中，Tomcat解析时要与URL编码时一致，因此两种解决思路</p>
<ul>
<li><code>URL编码</code>指定：由HTML文件的头标签meta的charset属性 定义（推荐）</li>
<li><code>Tomcat解析</code>：conf&#x2F;server.xml中 Connecter标签 添加 URIEncoding&#x3D;”UTF-8”  （不推荐）</li>
</ul>
<p>对于POST请求：请求时参数在请求体中，Tomcat解析时要与请求体的编码一致，因此由两种解决思路</p>
<ul>
<li><code>请求体编码</code>指定：由HTML文件的头标签meta的charset属性 定义（推荐）</li>
<li>Tomcat解析：<code>req.setCharacter(&quot;UTF-8&quot;)</code>方法来匹配请求体编码（不推荐）</li>
</ul>
<blockquote>
<p><strong>第四种情况：响应乱码问题</strong></p>
</blockquote>
<p>响应时，浏览器解析的编码和resp的编码不一致，因此有两种解决思路</p>
<ul>
<li>浏览器对请求使用指定字符集（不推荐）</li>
<li>Tomcat解析：<code>req.setCharacter(&quot;UTF-8&quot;)</code>方法来匹配请求体编码（不推荐）</li>
</ul>
<p>推荐的做法是两者结合：</p>
<ul>
<li>服务器通过响应对象的<code>setCharacter</code>方法定义好请求体编码（Tomcat10以上不用 默认UTF-8，但建议养成习惯）</li>
<li>使用请求头<code>Content-type</code>后面跟上告知服务器要解析的响应体</li>
</ul>
<p><img src="/img/loading.gif" data-original="https://yuezi-1308313119.cos.ap-guangzhou.myqcloud.com/typora-user-images%2Fimage-20240906194301197.png" alt="image-20240906194301197">	</p>
<h3 id="10-2-路径问题"><a href="#10-2-路径问题" class="headerlink" title="10.2 路径问题"></a>10.2 路径问题</h3><p>首先说明相对路径和绝对路径</p>
<ul>
<li>相对路径<ul>
<li>相对路径的规则是: <code>以当前资源所在的路径为出发点</code>去寻找目标资源</li>
<li>相对路径不以 &#x2F; 开头</li>
<li>在file协议下,使用的是磁盘路径，在http协议下,使用的是url路径</li>
<li>相对路径中可以使用<code> ./</code>表示当前资源所在路径,可以省略不写</li>
<li>相对路径中可以使用<code>../</code>表示当前资源所在路径的上一层路径,需要时要手动添加</li>
</ul>
</li>
<li>绝对路径<ul>
<li>绝对路径的规则是: 使用<code>以一个固定的路径做出出发点</code>去寻找目标资源,和当前资源所在的路径没有关系</li>
<li>绝对路径要以&#x2F; 开头</li>
<li>绝对路径的写法中,不以当前资源的所在路径为出发点,所以<code>不会出现  ./ 和../</code></li>
<li>不同的项目和不同的协议下,绝对路径的基础位置可能不同,要通过测试确定</li>
<li>绝对路径的好处就是:无论当前资源位置在哪,寻找目标资源路径的写法都一致</li>
</ul>
</li>
<li>应用场景<ol>
<li>前端代码中,href src action 等属性</li>
<li>请求转发和重定向中的路径</li>
</ol>
</li>
</ul>
<h4 id="10-2-1-前端路径问题"><a href="#10-2-1-前端路径问题" class="headerlink" title="10.2.1 前端路径问题"></a>10.2.1 前端路径问题</h4><p><img src="/img/loading.gif" data-original="https://yuezi-1308313119.cos.ap-guangzhou.myqcloud.com/typora-user-images%2Fimage-20240906194611477.png" alt="image-20240906194611477">	</p>
<blockquote>
<p>相对路径1：<code>web/index.html</code>中引入<code>web/static/img/logo.png</code>（正常访问）</p>
</blockquote>
<ul>
<li>相对路径表示从<a target="_blank" rel="noopener" href="http://localhost:8080/web03_war_exploded/%E5%BC%80%E5%A7%8B%E6%8B%BC%E6%8E%A5%EF%BC%8C%E5%9B%A0%E6%AD%A4%E5%90%8E%E9%9D%A2%E7%9B%B4%E6%8E%A5%E8%B7%9F%E4%B8%8Astatic%E5%90%8E%E9%9D%A2%E7%9A%84%E9%83%A8%E5%88%86%E5%8D%B3%E5%8F%AF">http://localhost:8080/web03_war_exploded/开始拼接，因此后面直接跟上static后面的部分即可</a></li>
</ul>
<figure class="highlight html"><table><tr><td class="code"><pre><span class="line"><span class="meta">&lt;!DOCTYPE <span class="keyword">html</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">html</span> <span class="attr">lang</span>=<span class="string">&quot;en&quot;</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">head</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">meta</span> <span class="attr">charset</span>=<span class="string">&quot;UTF-8&quot;</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">title</span>&gt;</span>Title<span class="tag">&lt;/<span class="name">title</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">head</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">body</span>&gt;</span></span><br><span class="line">    </span><br><span class="line">    <span class="tag">&lt;<span class="name">img</span> <span class="attr">src</span>=<span class="string">&quot;static/img/logo.png&quot;</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">body</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">html</span>&gt;</span></span><br></pre></td></tr></table></figure>



<blockquote>
<p>相对路径2：<code>web/a/b/c/test.html</code>中引入<code>web/static/img/logo.png</code>（多级目录访问）</p>
</blockquote>
<ul>
<li>从<a target="_blank" rel="noopener" href="http://localhost:8080/web03_war_exploded/a/b/c/test.html%E5%BC%80%E5%A7%8B%E6%8B%BC%E6%8E%A5%EF%BC%8C%E5%9B%A0%E6%AD%A4%E5%90%8E%E9%9D%A2%E9%9C%80%E8%A6%81%E4%B8%89%E4%B8%AA%60../%60%E6%8A%B5%E6%B6%88%E5%89%8D%E9%9D%A2%E4%B8%89%E4%B8%AA%E7%9B%AE%E5%BD%95%EF%BC%8C%E5%86%8D%E8%B7%9F%E4%B8%8Astatic%E5%90%8E%E9%9D%A2%E7%9A%84%E9%83%A8%E5%88%86">http://localhost:8080/web03_war_exploded/a/b/c/test.html开始拼接，因此后面需要三个`../`抵消前面三个目录，再跟上static后面的部分</a></li>
</ul>
<figure class="highlight html"><table><tr><td class="code"><pre><span class="line"><span class="meta">&lt;!DOCTYPE <span class="keyword">html</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">html</span> <span class="attr">lang</span>=<span class="string">&quot;en&quot;</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">head</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">meta</span> <span class="attr">charset</span>=<span class="string">&quot;UTF-8&quot;</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">title</span>&gt;</span>Title<span class="tag">&lt;/<span class="name">title</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">head</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">body</span>&gt;</span></span><br><span class="line">    <span class="comment">&lt;!-- ../代表上一层路径 --&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">img</span> <span class="attr">src</span>=<span class="string">&quot;../../../static/img/logo.png&quot;</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">body</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">html</span>&gt;</span></span><br></pre></td></tr></table></figure>



<blockquote>
<p>相对路径3：<code>web/WEB-INF/views/view1.html</code>中引入<code>web/static/img/logo.png</code>（受保护资源访问）</p>
</blockquote>
<ul>
<li>受保护目录下资源，只能通过Servlet<code>请求转发</code>获得，此时找的是磁盘目录，从web目录开始拼接</li>
<li>对于view1的代码，从<a target="_blank" rel="noopener" href="http://localhost:8080/web03_war_exploded/view1Servlet%E5%BC%80%E5%A7%8B%E6%8B%BC%E6%8E%A5%EF%BC%8C%E5%9B%A0%E6%AD%A4%E8%B7%9F%E4%B8%8Astatic%E5%90%8E%E9%9D%A2%E7%9A%84%E9%83%A8%E5%88%86">http://localhost:8080/web03_war_exploded/view1Servlet开始拼接，因此跟上static后面的部分</a></li>
</ul>
<p>View1Servelt.java代码</p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="meta">@WebServlet(&quot;/view1Servlet&quot;)</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">View1Servlet</span> <span class="keyword">extends</span> <span class="title class_">HttpServlet</span> &#123;</span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="keyword">protected</span> <span class="keyword">void</span> <span class="title function_">service</span><span class="params">(HttpServletRequest req, HttpServletResponse resp)</span> <span class="keyword">throws</span> ServletException, IOException &#123;</span><br><span class="line">        <span class="type">RequestDispatcher</span> <span class="variable">requestDispatcher</span> <span class="operator">=</span> req.getRequestDispatcher(<span class="string">&quot;WEB-INF/views/view1.html&quot;</span>);</span><br><span class="line">        requestDispatcher.forward(req,resp);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>



<p>view1.html代码</p>
<figure class="highlight html"><table><tr><td class="code"><pre><span class="line"><span class="meta">&lt;!DOCTYPE <span class="keyword">html</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">html</span> <span class="attr">lang</span>=<span class="string">&quot;en&quot;</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">head</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">meta</span> <span class="attr">charset</span>=<span class="string">&quot;UTF-8&quot;</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">title</span>&gt;</span>Title<span class="tag">&lt;/<span class="name">title</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">head</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">body</span>&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="tag">&lt;<span class="name">img</span> <span class="attr">src</span>=<span class="string">&quot;static/img/logo.png&quot;</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">body</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">html</span>&gt;</span></span><br></pre></td></tr></table></figure>



<blockquote>
<p>绝对路径1：<code>web/index.html</code>中引入<code>web/static/img/logo.png</code>（正常访问）</p>
</blockquote>
<ul>
<li>根目录从<a target="_blank" rel="noopener" href="http://localhost:8080/%E5%BC%80%E5%A7%8B%E6%8B%BC%E6%8E%A5%EF%BC%8C%E9%9C%80%E8%A6%81%E5%8A%A0%E4%B8%8A%E8%B5%84%E6%BA%90%E4%B8%8A%E4%B8%8B%E6%96%87%E7%9A%84%E8%B7%AF%E5%BE%84%60web03_war_exploded%60">http://localhost:8080/开始拼接，需要加上资源上下文的路径`web03_war_exploded`</a></li>
</ul>
<figure class="highlight html"><table><tr><td class="code"><pre><span class="line"><span class="meta">&lt;!DOCTYPE <span class="keyword">html</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">html</span> <span class="attr">lang</span>=<span class="string">&quot;en&quot;</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">head</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">meta</span> <span class="attr">charset</span>=<span class="string">&quot;UTF-8&quot;</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">title</span>&gt;</span>Title<span class="tag">&lt;/<span class="name">title</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">head</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">body</span>&gt;</span></span><br><span class="line">    <span class="comment">&lt;!-- 绝对路径写法 --&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">img</span> <span class="attr">src</span>=<span class="string">&quot;/web03_war_exploded/static/img/logo.png&quot;</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">body</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">html</span>&gt;</span></span><br></pre></td></tr></table></figure>



<blockquote>
<p>绝对路径2：<code>web/a/b/c/test.html</code>中引入<code>web/static/img/logo.png</code>（多级目录访问）</p>
</blockquote>
<ul>
<li>根目录从<a target="_blank" rel="noopener" href="http://localhost:8080/%E5%BC%80%E5%A7%8B%E6%8B%BC%E6%8E%A5%EF%BC%8C%E9%9C%80%E8%A6%81%E5%8A%A0%E4%B8%8A%E8%B5%84%E6%BA%90%E4%B8%8A%E4%B8%8B%E6%96%87%E7%9A%84%E8%B7%AF%E5%BE%84%60web03_war_exploded%60%EF%BC%8C%E5%90%8E%E9%9D%A2%E8%B7%9F%E4%B8%8Astatic%E9%83%A8%E5%88%86%EF%BC%8C%E6%97%A0%E9%9C%80%E8%80%83%E8%99%91%E5%BD%93%E5%89%8D%E7%9B%AE%E5%BD%95%E4%BD%8D%E7%BD%AE">http://localhost:8080/开始拼接，需要加上资源上下文的路径`web03_war_exploded`，后面跟上static部分，无需考虑当前目录位置</a></li>
<li>预告：<code>重定向</code>绝对路径根目录位置不自带上下文路径，而<code>请求转发</code>因为只能访问内部资源，因此会自带上下文路径</li>
</ul>
<figure class="highlight html"><table><tr><td class="code"><pre><span class="line"><span class="meta">&lt;!DOCTYPE <span class="keyword">html</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">html</span> <span class="attr">lang</span>=<span class="string">&quot;en&quot;</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">head</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">meta</span> <span class="attr">charset</span>=<span class="string">&quot;UTF-8&quot;</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">title</span>&gt;</span>Title<span class="tag">&lt;/<span class="name">title</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">head</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">body</span>&gt;</span></span><br><span class="line">    <span class="comment">&lt;!-- 绝对路径写法 --&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">img</span> <span class="attr">src</span>=<span class="string">&quot;/web03_war_exploded/static/img/logo.png&quot;</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">body</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">html</span>&gt;</span></span><br></pre></td></tr></table></figure>



<blockquote>
<p>绝对路径情况3:<code>web/WEB-INF/views/view1.html</code>中引入<code>web/static/img/logo.png</code>（受保护资源访问）</p>
</blockquote>
<ul>
<li>这里同样是只能通过Servlet<code>请求转发</code>获得受保护资源，代码见上面相对路径，不再赘述</li>
<li>根目录从<a target="_blank" rel="noopener" href="http://localhost:8080/%E5%BC%80%E5%A7%8B%E6%8B%BC%E6%8E%A5%EF%BC%8C%E9%9C%80%E8%A6%81%E5%8A%A0%E4%B8%8A%E8%B5%84%E6%BA%90%E4%B8%8A%E4%B8%8B%E6%96%87%E7%9A%84%E8%B7%AF%E5%BE%84%60web03_war_exploded%60%EF%BC%8C%E5%90%8E%E9%9D%A2%E8%B7%9F%E4%B8%8Astatic%E9%83%A8%E5%88%86%EF%BC%8C%E6%97%A0%E9%9C%80%E8%80%83%E8%99%91%E5%BD%93%E5%89%8D%E7%9B%AE%E5%BD%95%E4%BD%8D%E7%BD%AE">http://localhost:8080/开始拼接，需要加上资源上下文的路径`web03_war_exploded`，后面跟上static部分，无需考虑当前目录位置</a></li>
</ul>
<figure class="highlight html"><table><tr><td class="code"><pre><span class="line"><span class="meta">&lt;!DOCTYPE <span class="keyword">html</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">html</span> <span class="attr">lang</span>=<span class="string">&quot;en&quot;</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">head</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">meta</span> <span class="attr">charset</span>=<span class="string">&quot;UTF-8&quot;</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">title</span>&gt;</span>Title<span class="tag">&lt;/<span class="name">title</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">head</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">body</span>&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="tag">&lt;<span class="name">img</span> <span class="attr">src</span>=<span class="string">&quot;/web03_war_exploded/static/img/logo.png&quot;</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">body</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">html</span>&gt;</span></span><br></pre></td></tr></table></figure>





<h5 id="路径存在的缺陷和改进思路"><a href="#路径存在的缺陷和改进思路" class="headerlink" title="路径存在的缺陷和改进思路"></a>路径存在的缺陷和改进思路</h5><p>我们发现<code>相对路径</code>和<code>绝对路径</code>存在缺陷，如下：</p>
<ul>
<li>相对路径在部署到不同的环境下，是可能会动态变化的，牵一发而动全身的情况是有的</li>
<li>而绝对路径又需加上<code>资源上下文路径</code>，而资源路径又是动态变化的，此时资源路径若发生了更改，修改后 将违背开闭原则</li>
</ul>
<p>解决方案1：使用base标签定义公共标签，<code>相对路径同一转化为绝对路径</code>（不完美的方案，依旧可能要修改源码）</p>
<figure class="highlight html"><table><tr><td class="code"><pre><span class="line"><span class="meta">&lt;!DOCTYPE <span class="keyword">html</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">html</span> <span class="attr">lang</span>=<span class="string">&quot;en&quot;</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">head</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">meta</span> <span class="attr">charset</span>=<span class="string">&quot;UTF-8&quot;</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">title</span>&gt;</span>Title<span class="tag">&lt;/<span class="name">title</span>&gt;</span></span><br><span class="line">    <span class="comment">&lt;!--定义相对路径的公共前缀,将相对路径转化成了绝对路径--&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">base</span> <span class="attr">href</span>=<span class="string">&quot;/web03_war_exploded/&quot;</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">head</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">body</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">img</span> <span class="attr">src</span>=<span class="string">&quot;static/img/logo.png&quot;</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">body</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">html</span>&gt;</span></span><br></pre></td></tr></table></figure>



<p>解决方案2：项目上下文路径直接设置为<code>/</code>，此时绝对路径无需因为上下文路径变化而发生更改（<a target="_blank" rel="noopener" href="https://www.runoob.com/django/django-tutorial.html"><strong>Django</strong></a>框架的做法）</p>
<h4 id="10-2-2-重定向路径问题"><a href="#10-2-2-重定向路径问题" class="headerlink" title="10.2.2 重定向路径问题"></a>10.2.2 重定向路径问题</h4><p>以<a target="_blank" rel="noopener" href="http://localhost:8080/web03_war_exploded/x/y/z/servletA%E9%87%8D%E5%AE%9A%E5%90%91%E5%88%B0http://localhost:8080/web03_war_exploded/a/b/c/test.html%E4%B8%BA%E4%BE%8B%EF%BC%8C%E4%B8%BB%E8%A6%81%E5%8C%BA%E5%88%AB%E5%9C%A8%E4%BA%8E%E7%BB%9D%E5%AF%B9%E8%B7%AF%E5%BE%84%E7%9A%84%E5%9F%BA%E5%87%86%E4%B8%8A">http://localhost:8080/web03_war_exploded/x/y/z/servletA重定向到http://localhost:8080/web03_war_exploded/a/b/c/test.html为例，主要区别在于绝对路径的基准上</a></p>
<blockquote>
<p>相对写法</p>
</blockquote>
<ul>
<li>在当前资源所在路径(<a target="_blank" rel="noopener" href="http://localhost:8080/web03_war_exploded/x/y/a/b/c/test/html),%E5%BD%A2%E6%88%90">http://localhost:8080/web03_war_exploded/x/y/z/)后拼接(../../../a/b/c/test/html),形成</a></li>
</ul>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="meta">@WebServlet(&quot;/x/y/z/servletA&quot;)</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">ServletA</span> <span class="keyword">extends</span> <span class="title class_">HttpServlet</span> &#123;</span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="keyword">protected</span> <span class="keyword">void</span> <span class="title function_">service</span><span class="params">(HttpServletRequest req, HttpServletResponse resp)</span> <span class="keyword">throws</span> ServletException, IOException &#123;</span><br><span class="line">        <span class="comment">// 相对路径重定向到test.html</span></span><br><span class="line">        resp.sendRedirect(<span class="string">&quot;../../../a/b/c/test.html&quot;</span>);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>



<blockquote>
<p>绝对写法</p>
</blockquote>
<ul>
<li>在基准路径(<a href="http://localhost:8080)后面拼接(/web03_war_exploded/a/b/c/test.html),得到">http://localhost:8080)后面拼接(/web03_war_exploded/a/b/c/test.html),得到</a>( <a target="_blank" rel="noopener" href="http://localhost:8080/web03_war_exploded/a/b/c/test.html">http://localhost:8080/web03_war_exploded/a/b/c/test.html</a>)</li>
<li>如果定义了缺省上下文路径，则无需考虑上下文路径的问题。</li>
</ul>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="comment">//绝对路径中,要写项目上下文路径</span></span><br><span class="line"><span class="comment">//resp.sendRedirect(&quot;/web03_war_exploded/a/b/c/test.html&quot;);</span></span><br><span class="line"><span class="comment">// 通过ServletContext对象动态获取项目上下文路径</span></span><br><span class="line"><span class="comment">//resp.sendRedirect(getServletContext().getContextPath()+&quot;/a/b/c/test.html&quot;);</span></span><br><span class="line"><span class="comment">// 缺省项目上下文路径时,直接以/开头即可</span></span><br><span class="line">resp.sendRedirect(<span class="string">&quot;/a/b/c/test.html&quot;</span>);</span><br></pre></td></tr></table></figure>





<h4 id="10-2-3-请求转发路径问题"><a href="#10-2-3-请求转发路径问题" class="headerlink" title="10.2.3 请求转发路径问题"></a>10.2.3 请求转发路径问题</h4><p>以<a target="_blank" rel="noopener" href="http://localhost:8080/web03_war_exploded/x/y/z/servletB%E9%87%8D%E5%AE%9A%E5%90%91%E5%88%B0http://localhost:8080/web03_war_exploded/a/b/c/test.html%E4%B8%BA%E4%BE%8B">http://localhost:8080/web03_war_exploded/x/y/z/servletB重定向到http://localhost:8080/web03_war_exploded/a/b/c/test.html为例</a></p>
<blockquote>
<p>相对写法</p>
</blockquote>
<ul>
<li>同上，和重定向没区别，就是从当前资源路径<a target="_blank" rel="noopener" href="http://localhost:8080/web03_war_exploded/x/y/z/%E5%BC%80%E5%A7%8B%E6%89%BE">http://localhost:8080/web03_war_exploded/x/y/z/开始找</a></li>
</ul>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="meta">@WebServlet(&quot;/x/y/servletB&quot;)</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">ServletB</span> <span class="keyword">extends</span> <span class="title class_">HttpServlet</span> &#123;</span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="keyword">protected</span> <span class="keyword">void</span> <span class="title function_">service</span><span class="params">(HttpServletRequest req, HttpServletResponse resp)</span> <span class="keyword">throws</span> ServletException, IOException &#123;</span><br><span class="line">        <span class="type">RequestDispatcher</span> <span class="variable">requestDispatcher</span> <span class="operator">=</span> req.getRequestDispatcher(<span class="string">&quot;../../a/b/c/test.html&quot;</span>);</span><br><span class="line">        requestDispatcher.forward(req,resp);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>





<blockquote>
<p>绝对写法</p>
</blockquote>
<ul>
<li>在基准路径(<a target="_blank" rel="noopener" href="http://localhost:8080/web03_war_exploded/a/b/c/test.html),%E5%BE%97%E5%88%B0">http://localhost:8080/web03_war_exploded/a/b/c/test.html),得到</a>( <a target="_blank" rel="noopener" href="http://localhost:8080/web03_war_exploded/a/b/c/test.html">http://localhost:8080/web03_war_exploded/a/b/c/test.html</a>)</li>
<li>因为请求转发只能访问内部资源，因此不管是否设置了缺省上下文路径，都无需考虑<code>上下文路径的问题</code>。</li>
</ul>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="meta">@WebServlet(&quot;/x/y/servletB&quot;)</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">ServletB</span> <span class="keyword">extends</span> <span class="title class_">HttpServlet</span> &#123;</span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="keyword">protected</span> <span class="keyword">void</span> <span class="title function_">service</span><span class="params">(HttpServletRequest req, HttpServletResponse resp)</span> <span class="keyword">throws</span> ServletException, IOException &#123;</span><br><span class="line">        <span class="type">RequestDispatcher</span> <span class="variable">requestDispatcher</span> <span class="operator">=</span> req.getRequestDispatcher(<span class="string">&quot;/a/b/c/test.html&quot;</span>);</span><br><span class="line">        requestDispatcher.forward(req,resp);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>



<h2 id="11-MVC结构模式"><a href="#11-MVC结构模式" class="headerlink" title="11. MVC结构模式"></a>11. MVC结构模式</h2><blockquote>
<p>MVC（Model View Controller）是软件工程的一种<code>软件架构模式</code>，分为model、view、Controller三个部分，将<code>业务逻辑、数据、界面</code>展示隔离开了，在个性化界面的同时，无需重写业务逻辑</p>
</blockquote>
<ul>
<li><p>Model层</p>
<ul>
<li>存放<code>实体类</code>和存储非数据表库完整VO对象</li>
<li>存放对数据进行逻辑运算的<code>业务代码</code></li>
</ul>
</li>
<li><p>View层</p>
<ul>
<li>存放html css js</li>
<li>前后端分离，一般前端工程化，衍生为独立的前端项目</li>
</ul>
</li>
<li><p>Controller层</p>
<ul>
<li>接收用户请求，得到请求数据</li>
<li>将数据相应给客户端</li>
</ul>
</li>
</ul>
<ul>
<li><p>M:</p>
<ol>
<li>实体类包(pojo &#x2F;entity &#x2F;bean) 专门存放和数据库对应的实体类和一些VO对象</li>
<li>数据库访问包(dao&#x2F;mapper)  专门存放对数据库不同表格CURD方法封装的一些类</li>
<li>服务包(service)                       专门存放对数据进行业务逻辑运算的一些类</li>
</ol>
</li>
<li><p>C:</p>
<ol>
<li>控制层包(controller)</li>
</ol>
</li>
<li><p>V:</p>
<ol>
<li>web目录下的视图资源 html css js img 等</li>
<li>前端工程化后,在后端项目中已经不存在</li>
</ol>
</li>
</ul>
<p>前后端分离模式为例的图示。</p>
<img src="/img/loading.gif" data-original="https://yuezi-1308313119.cos.ap-guangzhou.myqcloud.com/typora-user-images%2Fimage-20240906210641545.png" alt="image-20240906210641545" style="zoom:80%;" />	



<h2 id="12-案例——日程管理第二期"><a href="#12-案例——日程管理第二期" class="headerlink" title="12. 案例——日程管理第二期"></a>12. 案例——日程管理第二期</h2><h3 id="12-1-DB"><a href="#12-1-DB" class="headerlink" title="12.1 DB"></a>12.1 DB</h3><p>数据库搭建</p>
<figure class="highlight sql"><table><tr><td class="code"><pre><span class="line"><span class="keyword">SET</span> NAMES utf8mb4;</span><br><span class="line"><span class="keyword">SET</span> FOREIGN_KEY_CHECKS <span class="operator">=</span> <span class="number">0</span>;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment">-- ----------------------------</span></span><br><span class="line"><span class="comment">-- 创建日程表</span></span><br><span class="line"><span class="comment">-- ----------------------------</span></span><br><span class="line"><span class="keyword">DROP</span> <span class="keyword">TABLE</span> IF <span class="keyword">EXISTS</span> `sys_schedule`;</span><br><span class="line"><span class="keyword">CREATE TABLE</span> `sys_schedule`  (</span><br><span class="line">  `sid` <span class="type">int</span> <span class="keyword">NOT NULL</span> AUTO_INCREMENT,</span><br><span class="line">  `uid` <span class="type">int</span> <span class="keyword">NULL</span> <span class="keyword">DEFAULT</span> <span class="keyword">NULL</span>,</span><br><span class="line">  `title` <span class="type">varchar</span>(<span class="number">20</span>) <span class="keyword">CHARACTER SET</span> utf8mb4 <span class="keyword">COLLATE</span> utf8mb4_0900_ai_ci <span class="keyword">NULL</span> <span class="keyword">DEFAULT</span> <span class="keyword">NULL</span>,</span><br><span class="line">  `completed` <span class="type">int</span>(<span class="number">1</span>) <span class="keyword">NULL</span> <span class="keyword">DEFAULT</span> <span class="keyword">NULL</span>,</span><br><span class="line">  <span class="keyword">PRIMARY KEY</span> (`sid`) <span class="keyword">USING</span> BTREE</span><br><span class="line">) ENGINE <span class="operator">=</span> InnoDB AUTO_INCREMENT <span class="operator">=</span> <span class="number">1</span> <span class="keyword">CHARACTER SET</span> <span class="operator">=</span> utf8mb4 <span class="keyword">COLLATE</span> <span class="operator">=</span> utf8mb4_0900_ai_ci ROW_FORMAT <span class="operator">=</span> <span class="keyword">Dynamic</span>;</span><br><span class="line"></span><br><span class="line"><span class="comment">-- ----------------------------</span></span><br><span class="line"><span class="comment">-- 插入日程数据</span></span><br><span class="line"><span class="comment">-- ----------------------------</span></span><br><span class="line"></span><br><span class="line"><span class="comment">-- ----------------------------</span></span><br><span class="line"><span class="comment">-- 创建用户表</span></span><br><span class="line"><span class="comment">-- ----------------------------</span></span><br><span class="line"><span class="keyword">DROP</span> <span class="keyword">TABLE</span> IF <span class="keyword">EXISTS</span> `sys_user`;</span><br><span class="line"><span class="keyword">CREATE TABLE</span> `sys_user`  (</span><br><span class="line">  `uid` <span class="type">int</span> <span class="keyword">NOT NULL</span> AUTO_INCREMENT,</span><br><span class="line">  `username` <span class="type">varchar</span>(<span class="number">10</span>) <span class="keyword">CHARACTER SET</span> utf8mb4 <span class="keyword">COLLATE</span> utf8mb4_0900_ai_ci <span class="keyword">NULL</span> <span class="keyword">DEFAULT</span> <span class="keyword">NULL</span>,</span><br><span class="line">  `user_pwd` <span class="type">varchar</span>(<span class="number">100</span>) <span class="keyword">CHARACTER SET</span> utf8mb4 <span class="keyword">COLLATE</span> utf8mb4_0900_ai_ci <span class="keyword">NULL</span> <span class="keyword">DEFAULT</span> <span class="keyword">NULL</span>,</span><br><span class="line">  <span class="keyword">PRIMARY KEY</span> (`uid`) <span class="keyword">USING</span> BTREE,</span><br><span class="line">  <span class="keyword">UNIQUE</span> INDEX `username`(`username`) <span class="keyword">USING</span> BTREE</span><br><span class="line">) ENGINE <span class="operator">=</span> InnoDB <span class="keyword">CHARACTER SET</span> <span class="operator">=</span> utf8mb4 <span class="keyword">COLLATE</span> <span class="operator">=</span> utf8mb4_0900_ai_ci ROW_FORMAT <span class="operator">=</span> <span class="keyword">Dynamic</span>;</span><br><span class="line"></span><br><span class="line"><span class="comment">-- ----------------------------</span></span><br><span class="line"><span class="comment">-- 插入用户数据</span></span><br><span class="line"><span class="comment">-- ----------------------------</span></span><br><span class="line"><span class="keyword">INSERT INTO</span> `sys_user` <span class="keyword">VALUES</span> (<span class="number">1</span>, <span class="string">&#x27;zhangsan&#x27;</span>, <span class="string">&#x27;e10adc3949ba59abbe56e057f20f883e&#x27;</span>);</span><br><span class="line"><span class="keyword">INSERT INTO</span> `sys_user` <span class="keyword">VALUES</span> (<span class="number">2</span>, <span class="string">&#x27;lisi&#x27;</span>, <span class="string">&#x27;e10adc3949ba59abbe56e057f20f883e&#x27;</span>);</span><br><span class="line"></span><br><span class="line"><span class="keyword">SET</span> FOREIGN_KEY_CHECKS <span class="operator">=</span> <span class="number">1</span>;</span><br><span class="line"></span><br></pre></td></tr></table></figure>



<h3 id="12-2-项目架构"><a href="#12-2-项目架构" class="headerlink" title="12.2 项目架构"></a>12.2 项目架构</h3><p>model和controller相关</p>
<p><img src="/img/loading.gif" data-original="https://yuezi-1308313119.cos.ap-guangzhou.myqcloud.com/typora-user-images%2Fimage-20240906211508877.png" alt="image-20240906211508877">	</p>
<p>view相关以及相关依赖</p>
<p><img src="/img/loading.gif" data-original="https://yuezi-1308313119.cos.ap-guangzhou.myqcloud.com/typora-user-images%2Fimage-20240906211527665.png" alt="image-20240906211527665">	</p>
<h3 id="12-3-工具类"><a href="#12-3-工具类" class="headerlink" title="12.3 工具类"></a>12.3 工具类</h3><p>JDBC链接相关</p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="keyword">package</span> com.atguigu.schedule.util;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> com.alibaba.druid.pool.DruidDataSourceFactory;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> javax.sql.DataSource;</span><br><span class="line"><span class="keyword">import</span> java.io.IOException;</span><br><span class="line"><span class="keyword">import</span> java.io.InputStream;</span><br><span class="line"><span class="keyword">import</span> java.sql.Connection;</span><br><span class="line"><span class="keyword">import</span> java.sql.SQLException;</span><br><span class="line"><span class="keyword">import</span> java.util.Properties;</span><br><span class="line"></span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@author</span> yuezi2048</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@version</span> 1.0</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">JDBCUtil</span> &#123;</span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">static</span> ThreadLocal&lt;Connection&gt; threadLocal =<span class="keyword">new</span> <span class="title class_">ThreadLocal</span>&lt;&gt;();</span><br><span class="line"></span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">static</span> DataSource dataSource;</span><br><span class="line">    <span class="comment">// 初始化连接池</span></span><br><span class="line">    <span class="keyword">static</span>&#123;</span><br><span class="line">        <span class="comment">// 可以帮助我们读取.properties配置文件</span></span><br><span class="line">        <span class="type">Properties</span> <span class="variable">properties</span> <span class="operator">=</span><span class="keyword">new</span> <span class="title class_">Properties</span>();</span><br><span class="line">        <span class="type">InputStream</span> <span class="variable">resourceAsStream</span> <span class="operator">=</span> JDBCUtil.class.getClassLoader().getResourceAsStream(<span class="string">&quot;jdbc.properties&quot;</span>);</span><br><span class="line">        <span class="keyword">try</span> &#123;</span><br><span class="line">            properties.load(resourceAsStream);</span><br><span class="line">        &#125; <span class="keyword">catch</span> (IOException e) &#123;</span><br><span class="line">            <span class="keyword">throw</span> <span class="keyword">new</span> <span class="title class_">RuntimeException</span>(e);</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        <span class="keyword">try</span> &#123;</span><br><span class="line">            dataSource = DruidDataSourceFactory.createDataSource(properties);</span><br><span class="line">        &#125; <span class="keyword">catch</span> (Exception e) &#123;</span><br><span class="line">            <span class="keyword">throw</span> <span class="keyword">new</span> <span class="title class_">RuntimeException</span>(e);</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/*1 向外提供连接池的方法*/</span></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> DataSource <span class="title function_">getDataSource</span><span class="params">()</span>&#123;</span><br><span class="line">        <span class="keyword">return</span> dataSource;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/*2 向外提供连接的方法*/</span></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> Connection <span class="title function_">getConnection</span><span class="params">()</span>&#123;</span><br><span class="line">        <span class="type">Connection</span> <span class="variable">connection</span> <span class="operator">=</span> threadLocal.get();</span><br><span class="line">        <span class="keyword">if</span> (<span class="literal">null</span> == connection) &#123;</span><br><span class="line">            <span class="keyword">try</span> &#123;</span><br><span class="line">                connection = dataSource.getConnection();</span><br><span class="line">            &#125; <span class="keyword">catch</span> (SQLException e) &#123;</span><br><span class="line">                <span class="keyword">throw</span> <span class="keyword">new</span> <span class="title class_">RuntimeException</span>(e);</span><br><span class="line">            &#125;</span><br><span class="line">            threadLocal.set(connection);</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        <span class="keyword">return</span> connection;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">    <span class="comment">/*定义一个归还连接的方法 (解除和ThreadLocal之间的关联关系) */</span></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title function_">releaseConnection</span><span class="params">()</span>&#123;</span><br><span class="line">        <span class="type">Connection</span> <span class="variable">connection</span> <span class="operator">=</span> threadLocal.get();</span><br><span class="line">        <span class="keyword">if</span> (<span class="literal">null</span> != connection) &#123;</span><br><span class="line">            threadLocal.remove();</span><br><span class="line">            <span class="comment">// 把连接设置回自动提交的连接</span></span><br><span class="line">            <span class="keyword">try</span> &#123;</span><br><span class="line">                connection.setAutoCommit(<span class="literal">true</span>);</span><br><span class="line">                <span class="comment">// 自动归还到连接池</span></span><br><span class="line">                connection.close();</span><br><span class="line">            &#125; <span class="keyword">catch</span> (SQLException e) &#123;</span><br><span class="line">                <span class="keyword">throw</span> <span class="keyword">new</span> <span class="title class_">RuntimeException</span>(e);</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>





<p>MD5加密</p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="keyword">package</span> com.atguigu.schedule.util;</span><br><span class="line"><span class="keyword">import</span> java.security.MessageDigest;</span><br><span class="line"><span class="keyword">import</span> java.security.NoSuchAlgorithmException;</span><br><span class="line"></span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@author</span> yuezi2048</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@version</span> 1.0</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">final</span> <span class="keyword">class</span> <span class="title class_">MD5Util</span> &#123;</span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> String <span class="title function_">encrypt</span><span class="params">(String strSrc)</span> &#123;</span><br><span class="line">        <span class="keyword">try</span> &#123;</span><br><span class="line">            <span class="type">char</span> hexChars[] = &#123; <span class="string">&#x27;0&#x27;</span>, <span class="string">&#x27;1&#x27;</span>, <span class="string">&#x27;2&#x27;</span>, <span class="string">&#x27;3&#x27;</span>, <span class="string">&#x27;4&#x27;</span>, <span class="string">&#x27;5&#x27;</span>, <span class="string">&#x27;6&#x27;</span>, <span class="string">&#x27;7&#x27;</span>, <span class="string">&#x27;8&#x27;</span>,</span><br><span class="line">                    <span class="string">&#x27;9&#x27;</span>, <span class="string">&#x27;a&#x27;</span>, <span class="string">&#x27;b&#x27;</span>, <span class="string">&#x27;c&#x27;</span>, <span class="string">&#x27;d&#x27;</span>, <span class="string">&#x27;e&#x27;</span>, <span class="string">&#x27;f&#x27;</span> &#125;;</span><br><span class="line">            <span class="type">byte</span>[] bytes = strSrc.getBytes();</span><br><span class="line">            <span class="type">MessageDigest</span> <span class="variable">md</span> <span class="operator">=</span> MessageDigest.getInstance(<span class="string">&quot;MD5&quot;</span>);</span><br><span class="line">            md.update(bytes);</span><br><span class="line">            bytes = md.digest();</span><br><span class="line">            <span class="type">int</span> <span class="variable">j</span> <span class="operator">=</span> bytes.length;</span><br><span class="line">            <span class="type">char</span>[] chars = <span class="keyword">new</span> <span class="title class_">char</span>[j * <span class="number">2</span>];</span><br><span class="line">            <span class="type">int</span> <span class="variable">k</span> <span class="operator">=</span> <span class="number">0</span>;</span><br><span class="line">            <span class="keyword">for</span> (<span class="type">int</span> <span class="variable">i</span> <span class="operator">=</span> <span class="number">0</span>; i &lt; bytes.length; i++) &#123;</span><br><span class="line">                <span class="type">byte</span> <span class="variable">b</span> <span class="operator">=</span> bytes[i];</span><br><span class="line">                chars[k++] = hexChars[b &gt;&gt;&gt; <span class="number">4</span> &amp; <span class="number">0xf</span>];</span><br><span class="line">                chars[k++] = hexChars[b &amp; <span class="number">0xf</span>];</span><br><span class="line">            &#125;</span><br><span class="line">            <span class="keyword">return</span> <span class="keyword">new</span> <span class="title class_">String</span>(chars);</span><br><span class="line">        &#125; <span class="keyword">catch</span> (NoSuchAlgorithmException e) &#123;</span><br><span class="line">            e.printStackTrace();</span><br><span class="line">            <span class="keyword">throw</span> <span class="keyword">new</span> <span class="title class_">RuntimeException</span>(<span class="string">&quot;MD5加密出错!!!&quot;</span>);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br></pre></td></tr></table></figure>





<h3 id="12-4-pojo层"><a href="#12-4-pojo层" class="headerlink" title="12.4 pojo层"></a>12.4 pojo层</h3><p><strong>SysUser</strong></p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="keyword">package</span> com.atguigu.schedule.pojo;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> java.io.Serializable;</span><br><span class="line"><span class="keyword">import</span> java.util.Objects;</span><br><span class="line"></span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * 1. 实体类的类名和表格名称应该对应（驼峰式+见名知意）</span></span><br><span class="line"><span class="comment"> * 2. 实体类属性名和表格的列名要对应</span></span><br><span class="line"><span class="comment"> * 3. 每个属性必须私有</span></span><br><span class="line"><span class="comment"> * 4. 每个属性必须有getter setter</span></span><br><span class="line"><span class="comment"> * 5. 一定有无参构造器（Tomcat建议显式地写出来）</span></span><br><span class="line"><span class="comment"> * 6. 应该实现序列化接口（缓存 分布式项目数据传递，可能会将对象序列化）</span></span><br><span class="line"><span class="comment"> * 7. 应该重写类的hashCode和equals方法</span></span><br><span class="line"><span class="comment"> * 8. toString是否重写 都可以</span></span><br><span class="line"><span class="comment"> *</span></span><br><span class="line"><span class="comment"> * 使用lombok帮助我们生成getter setter 全参构造 无参构造 equals hashCode 使用步骤</span></span><br><span class="line"><span class="comment"> *      1. 检查是否安装lombok插件</span></span><br><span class="line"><span class="comment"> *      2. 检查是否勾选enable annotation processing</span></span><br><span class="line"><span class="comment"> *      3. 导入lombok依赖</span></span><br><span class="line"><span class="comment"> *      4. 实体类上添加注解</span></span><br><span class="line"><span class="comment"> *</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@author</span> yuezi2048</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@version</span> 1.0</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">SysUser</span> <span class="keyword">implements</span> <span class="title class_">Serializable</span> &#123;</span><br><span class="line">    <span class="keyword">private</span> Integer uid;</span><br><span class="line">    <span class="keyword">private</span> String username;</span><br><span class="line">    <span class="keyword">private</span> String userPwd;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="title function_">SysUser</span><span class="params">()</span> &#123;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="title function_">SysUser</span><span class="params">(Integer uid, String username, String userPwd)</span> &#123;</span><br><span class="line">        <span class="built_in">this</span>.uid = uid;</span><br><span class="line">        <span class="built_in">this</span>.username = username;</span><br><span class="line">        <span class="built_in">this</span>.userPwd = userPwd;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> Integer <span class="title function_">getUid</span><span class="params">()</span> &#123;</span><br><span class="line">        <span class="keyword">return</span> uid;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">setUid</span><span class="params">(Integer uid)</span> &#123;</span><br><span class="line">        <span class="built_in">this</span>.uid = uid;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> String <span class="title function_">getUsername</span><span class="params">()</span> &#123;</span><br><span class="line">        <span class="keyword">return</span> username;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">setUsername</span><span class="params">(String username)</span> &#123;</span><br><span class="line">        <span class="built_in">this</span>.username = username;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> String <span class="title function_">getUserPwd</span><span class="params">()</span> &#123;</span><br><span class="line">        <span class="keyword">return</span> userPwd;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">setUserPwd</span><span class="params">(String userPwd)</span> &#123;</span><br><span class="line">        <span class="built_in">this</span>.userPwd = userPwd;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="keyword">public</span> <span class="type">boolean</span> <span class="title function_">equals</span><span class="params">(Object o)</span> &#123;</span><br><span class="line">        <span class="keyword">if</span> (<span class="built_in">this</span> == o) <span class="keyword">return</span> <span class="literal">true</span>;</span><br><span class="line">        <span class="keyword">if</span> (o == <span class="literal">null</span> || getClass() != o.getClass()) <span class="keyword">return</span> <span class="literal">false</span>;</span><br><span class="line">        <span class="type">SysUser</span> <span class="variable">sysUser</span> <span class="operator">=</span> (SysUser) o;</span><br><span class="line">        <span class="keyword">return</span> Objects.equals(uid, sysUser.uid) &amp;&amp; Objects.equals(username, sysUser.username) &amp;&amp; Objects.equals(userPwd, sysUser.userPwd);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="keyword">public</span> <span class="type">int</span> <span class="title function_">hashCode</span><span class="params">()</span> &#123;</span><br><span class="line">        <span class="keyword">return</span> Objects.hash(uid, username, userPwd);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="keyword">public</span> String <span class="title function_">toString</span><span class="params">()</span> &#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="string">&quot;SysUser&#123;&quot;</span> +</span><br><span class="line">                <span class="string">&quot;uid=&quot;</span> + uid +</span><br><span class="line">                <span class="string">&quot;, username=&#x27;&quot;</span> + username + <span class="string">&#x27;\&#x27;&#x27;</span> +</span><br><span class="line">                <span class="string">&quot;, userPwd=&#x27;&quot;</span> + userPwd + <span class="string">&#x27;\&#x27;&#x27;</span> +</span><br><span class="line">                <span class="string">&#x27;&#125;&#x27;</span>;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br></pre></td></tr></table></figure>



<p>SysSchedule（使用<code>lombok</code>简化代码）</p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="keyword">package</span> com.atguigu.schedule.pojo;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> lombok.*;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> java.io.Serializable;</span><br><span class="line"></span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@author</span> yuezi2048</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@version</span> 1.0</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="meta">@AllArgsConstructor</span> <span class="comment">// 添加全参构造</span></span><br><span class="line"><span class="meta">@NoArgsConstructor</span></span><br><span class="line"><span class="meta">@Data</span> <span class="comment">// getter setter equals hashCode</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">SysSchedule</span> <span class="keyword">implements</span> <span class="title class_">Serializable</span> &#123;</span><br><span class="line">    <span class="keyword">private</span> Integer sid;</span><br><span class="line">    <span class="keyword">private</span> Integer uid;</span><br><span class="line">    <span class="keyword">private</span> String title;</span><br><span class="line">    <span class="keyword">private</span> Integer completed;</span><br><span class="line"></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>



<h3 id="12-5-Dao层"><a href="#12-5-Dao层" class="headerlink" title="12.5 Dao层"></a>12.5 Dao层</h3><p>基于之前学的Druid实现。</p>
<p>SysUser接口方法</p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="keyword">package</span> com.atguigu.schedule.dao;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> com.atguigu.schedule.pojo.SysUser;</span><br><span class="line"></span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * Data access Object</span></span><br><span class="line"><span class="comment"> * 该类用于定义针对表格的crud方法</span></span><br><span class="line"><span class="comment"> * DAO一般定义接口和实现类</span></span><br><span class="line"><span class="comment"> *</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@author</span> yuezi2048</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@version</span> 1.0</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">interface</span> <span class="title class_">SysUserDao</span> &#123;</span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * 向数据库中增加一条SysUser对象的信息</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@param</span> sysUser 要增加的记录username和userPwd字段通过sysUser实体类对象接收</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@return</span> 增加成功返回1，增加失败返回0</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="type">int</span> <span class="title function_">addSysUser</span><span class="params">(SysUser sysUser)</span>;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * 根据用户名获得用户完整信息的方法</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@param</span> username 要查询的用户方法</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@return</span> 如果找到了返回SysUser对象，否则返回NULL</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    SysUser <span class="title function_">findByUsername</span><span class="params">(String username)</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br></pre></td></tr></table></figure>





<p>SysSchedule接口方法</p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="keyword">package</span> com.atguigu.schedule.dao;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> com.atguigu.schedule.pojo.SysSchedule;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> java.util.List;</span><br><span class="line"></span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@author</span> yuezi2048</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@version</span> 1.0</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">interface</span> <span class="title class_">SysScheduleDao</span> &#123;</span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * 该方法用于向数据库中增加一条日程记录</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@param</span> schedule 日程数据以SysSchedule实体类对象形式入参</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@return</span> 增加成功返回影响数据库记录的行数，行数为0说明增加失败，行数&gt;0说明增加成功</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="type">int</span> <span class="title function_">addSchedule</span><span class="params">(SysSchedule schedule)</span>;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * 查询所有用户的所有日程</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@return</span> 将所有日程放入List集合中</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    List&lt;SysSchedule&gt; <span class="title function_">findAll</span><span class="params">()</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br></pre></td></tr></table></figure>



<p>SysUser实现</p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="keyword">package</span> com.atguigu.schedule.dao.impl;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> com.atguigu.schedule.dao.BaseDao;</span><br><span class="line"><span class="keyword">import</span> com.atguigu.schedule.dao.SysUserDao;</span><br><span class="line"><span class="keyword">import</span> com.atguigu.schedule.pojo.SysUser;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> java.util.List;</span><br><span class="line"></span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@author</span> yuezi2048</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@version</span> 1.0</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">SysUserDaoImpl</span> <span class="keyword">extends</span> <span class="title class_">BaseDao</span> <span class="keyword">implements</span> <span class="title class_">SysUserDao</span> &#123;</span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="keyword">public</span> <span class="type">int</span> <span class="title function_">addSysUser</span><span class="params">(SysUser sysUser)</span> &#123;</span><br><span class="line">        <span class="type">String</span> <span class="variable">sql</span> <span class="operator">=</span> <span class="string">&quot;insert into sys_user values(DEFAULT, ?, ?)&quot;</span>;</span><br><span class="line">        <span class="keyword">return</span> baseUpdate(sql, sysUser.getUsername(), sysUser.getUserPwd());</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="keyword">public</span> SysUser <span class="title function_">findByUsername</span><span class="params">(String username)</span> &#123;</span><br><span class="line">        <span class="type">String</span> <span class="variable">sql</span> <span class="operator">=</span> <span class="string">&quot;SELECT uid, username, user_pwd &#x27;userPwd&#x27; FROM sys_user where username = ?&quot;</span>;</span><br><span class="line">        List&lt;SysUser&gt; sysUsers = baseQuery(SysUser.class, sql, username);</span><br><span class="line">        <span class="keyword">if</span> (sysUsers != <span class="literal">null</span> &amp;&amp; sysUsers.size() &gt; <span class="number">0</span>) &#123;</span><br><span class="line">            <span class="keyword">return</span> sysUsers.get(<span class="number">0</span>);</span><br><span class="line">        &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">            <span class="keyword">return</span> <span class="literal">null</span>;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>



<p>SysSchedule实现</p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="keyword">package</span> com.atguigu.schedule.dao.impl;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> com.atguigu.schedule.dao.BaseDao;</span><br><span class="line"><span class="keyword">import</span> com.atguigu.schedule.dao.SysScheduleDao;</span><br><span class="line"><span class="keyword">import</span> com.atguigu.schedule.pojo.SysSchedule;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> java.util.List;</span><br><span class="line"></span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * 介绍一下当前类</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@author</span> yuezi2048</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@version</span> 1.0</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">SysScheduleDaoImpl</span> <span class="keyword">extends</span> <span class="title class_">BaseDao</span> <span class="keyword">implements</span> <span class="title class_">SysScheduleDao</span> &#123;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="keyword">public</span> <span class="type">int</span> <span class="title function_">addSchedule</span><span class="params">(SysSchedule schedule)</span> &#123;</span><br><span class="line">        <span class="type">String</span> <span class="variable">sql</span> <span class="operator">=</span> <span class="string">&quot;insert into sys_schedule(sid, uid, title, completed) values(?,?,?,?)&quot;</span>;</span><br><span class="line">        <span class="type">int</span> <span class="variable">rows</span> <span class="operator">=</span> baseUpdate(sql, schedule.getSid(), schedule.getUid(), schedule.getTitle(), schedule.getCompleted());</span><br><span class="line">        <span class="keyword">return</span> rows;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="keyword">public</span> List&lt;SysSchedule&gt; <span class="title function_">findAll</span><span class="params">()</span> &#123;</span><br><span class="line">        <span class="type">String</span> <span class="variable">sql</span> <span class="operator">=</span> <span class="string">&quot;select sid, uid, title, completed from sys_schedule&quot;</span>;</span><br><span class="line">        List&lt;SysSchedule&gt; sysSchedules = baseQuery(SysSchedule.class, sql);</span><br><span class="line">        <span class="keyword">return</span> sysSchedules;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>



<p>BaseDao公共方法具体实现</p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="keyword">package</span> com.atguigu.schedule.dao;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> com.atguigu.schedule.util.JDBCUtil;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> java.lang.reflect.Field;</span><br><span class="line"><span class="keyword">import</span> java.sql.*;</span><br><span class="line"><span class="keyword">import</span> java.time.LocalDateTime;</span><br><span class="line"><span class="keyword">import</span> java.util.ArrayList;</span><br><span class="line"><span class="keyword">import</span> java.util.List;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@author</span> yuezi2048</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@version</span> 1.0</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">BaseDao</span> &#123;</span><br><span class="line">    <span class="comment">// 公共的查询方法  返回的是单个对象</span></span><br><span class="line">    <span class="keyword">public</span> &lt;T&gt; T <span class="title function_">baseQueryObject</span><span class="params">(Class&lt;T&gt; clazz, String sql, Object ... args)</span> &#123;</span><br><span class="line">        <span class="type">T</span> <span class="variable">t</span> <span class="operator">=</span> <span class="literal">null</span>;</span><br><span class="line">        <span class="type">Connection</span> <span class="variable">connection</span> <span class="operator">=</span> JDBCUtil.getConnection();</span><br><span class="line">        <span class="type">PreparedStatement</span> <span class="variable">preparedStatement</span> <span class="operator">=</span> <span class="literal">null</span>;</span><br><span class="line">        <span class="type">ResultSet</span> <span class="variable">resultSet</span> <span class="operator">=</span> <span class="literal">null</span>;</span><br><span class="line">        <span class="type">int</span> <span class="variable">rows</span> <span class="operator">=</span> <span class="number">0</span>;</span><br><span class="line">        <span class="keyword">try</span> &#123;</span><br><span class="line">            <span class="comment">// 准备语句对象</span></span><br><span class="line">            preparedStatement = connection.prepareStatement(sql);</span><br><span class="line">            <span class="comment">// 设置语句上的参数</span></span><br><span class="line">            <span class="keyword">for</span> (<span class="type">int</span> <span class="variable">i</span> <span class="operator">=</span> <span class="number">0</span>; i &lt; args.length; i++) &#123;</span><br><span class="line">                preparedStatement.setObject(i + <span class="number">1</span>, args[i]);</span><br><span class="line">            &#125;</span><br><span class="line"></span><br><span class="line">            <span class="comment">// 执行 查询</span></span><br><span class="line">            resultSet = preparedStatement.executeQuery();</span><br><span class="line">            <span class="keyword">if</span> (resultSet.next()) &#123;</span><br><span class="line">                t = (T) resultSet.getObject(<span class="number">1</span>);</span><br><span class="line">            &#125;</span><br><span class="line">        &#125; <span class="keyword">catch</span> (Exception e) &#123;</span><br><span class="line">            e.printStackTrace();</span><br><span class="line">        &#125; <span class="keyword">finally</span> &#123;</span><br><span class="line">            <span class="keyword">if</span> (<span class="literal">null</span> != resultSet) &#123;</span><br><span class="line">                <span class="keyword">try</span> &#123;</span><br><span class="line">                    resultSet.close();</span><br><span class="line">                &#125; <span class="keyword">catch</span> (SQLException e) &#123;</span><br><span class="line">                    e.printStackTrace();</span><br><span class="line">                &#125;</span><br><span class="line">            &#125;</span><br><span class="line">            <span class="keyword">if</span> (<span class="literal">null</span> != preparedStatement) &#123;</span><br><span class="line">                <span class="keyword">try</span> &#123;</span><br><span class="line">                    preparedStatement.close();</span><br><span class="line">                &#125; <span class="keyword">catch</span> (SQLException e) &#123;</span><br><span class="line">                    e.printStackTrace();</span><br><span class="line">                &#125;</span><br><span class="line"></span><br><span class="line">            &#125;</span><br><span class="line">            JDBCUtil.releaseConnection();</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">return</span> t;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="comment">// 公共的查询方法  返回的是对象的集合</span></span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> &lt;T&gt; List&lt;T&gt; <span class="title function_">baseQuery</span><span class="params">(Class clazz, String sql, Object ... args)</span>&#123;</span><br><span class="line">        List&lt;T&gt; list =<span class="keyword">new</span> <span class="title class_">ArrayList</span>&lt;&gt;();</span><br><span class="line">        <span class="type">Connection</span> <span class="variable">connection</span> <span class="operator">=</span> JDBCUtil.getConnection();</span><br><span class="line">        PreparedStatement preparedStatement=<span class="literal">null</span>;</span><br><span class="line">        <span class="type">ResultSet</span> <span class="variable">resultSet</span> <span class="operator">=</span><span class="literal">null</span>;</span><br><span class="line">        <span class="type">int</span> <span class="variable">rows</span> <span class="operator">=</span> <span class="number">0</span>;</span><br><span class="line">        <span class="keyword">try</span> &#123;</span><br><span class="line">            <span class="comment">// 准备语句对象</span></span><br><span class="line">            preparedStatement = connection.prepareStatement(sql);</span><br><span class="line">            <span class="comment">// 设置语句上的参数</span></span><br><span class="line">            <span class="keyword">for</span> (<span class="type">int</span> <span class="variable">i</span> <span class="operator">=</span> <span class="number">0</span>; i &lt; args.length; i++) &#123;</span><br><span class="line">                preparedStatement.setObject(i+<span class="number">1</span>,args[i]);</span><br><span class="line">            &#125;</span><br><span class="line"></span><br><span class="line">            <span class="comment">// 执行 查询</span></span><br><span class="line">            resultSet = preparedStatement.executeQuery();</span><br><span class="line"></span><br><span class="line">            <span class="type">ResultSetMetaData</span> <span class="variable">metaData</span> <span class="operator">=</span> resultSet.getMetaData();</span><br><span class="line">            <span class="type">int</span> <span class="variable">columnCount</span> <span class="operator">=</span> metaData.getColumnCount();</span><br><span class="line"></span><br><span class="line">            <span class="comment">// 将结果集通过反射封装成实体类对象</span></span><br><span class="line">            <span class="keyword">while</span> (resultSet.next()) &#123;</span><br><span class="line">                <span class="comment">// 使用反射实例化对象</span></span><br><span class="line">                <span class="type">Object</span> <span class="variable">obj</span> <span class="operator">=</span>clazz.getDeclaredConstructor().newInstance();</span><br><span class="line"></span><br><span class="line">                <span class="keyword">for</span> (<span class="type">int</span> <span class="variable">i</span> <span class="operator">=</span> <span class="number">1</span>; i &lt;= columnCount; i++) &#123;</span><br><span class="line">                    <span class="type">String</span> <span class="variable">columnName</span> <span class="operator">=</span> metaData.getColumnLabel(i);</span><br><span class="line">                    <span class="type">Object</span> <span class="variable">value</span> <span class="operator">=</span> resultSet.getObject(columnName);</span><br><span class="line">                    <span class="comment">// 处理datetime类型字段和java.util.Data转换问题</span></span><br><span class="line">                    <span class="keyword">if</span>(value.getClass().equals(LocalDateTime.class))&#123;</span><br><span class="line">                        value= Timestamp.valueOf((LocalDateTime) value);</span><br><span class="line">                    &#125;</span><br><span class="line">                    <span class="type">Field</span> <span class="variable">field</span> <span class="operator">=</span> clazz.getDeclaredField(columnName);</span><br><span class="line">                    field.setAccessible(<span class="literal">true</span>);</span><br><span class="line">                    field.set(obj,value);</span><br><span class="line">                &#125;</span><br><span class="line"></span><br><span class="line">                list.add((T)obj);</span><br><span class="line">            &#125;</span><br><span class="line"></span><br><span class="line">        &#125; <span class="keyword">catch</span> (Exception e) &#123;</span><br><span class="line">            e.printStackTrace();</span><br><span class="line">        &#125; <span class="keyword">finally</span> &#123;</span><br><span class="line">            <span class="keyword">if</span> (<span class="literal">null</span> !=resultSet) &#123;</span><br><span class="line">                <span class="keyword">try</span> &#123;</span><br><span class="line">                    resultSet.close();</span><br><span class="line">                &#125; <span class="keyword">catch</span> (SQLException e) &#123;</span><br><span class="line">                    <span class="keyword">throw</span> <span class="keyword">new</span> <span class="title class_">RuntimeException</span>(e);</span><br><span class="line">                &#125;</span><br><span class="line">            &#125;</span><br><span class="line">            <span class="keyword">if</span> (<span class="literal">null</span> != preparedStatement) &#123;</span><br><span class="line">                <span class="keyword">try</span> &#123;</span><br><span class="line">                    preparedStatement.close();</span><br><span class="line">                &#125; <span class="keyword">catch</span> (SQLException e) &#123;</span><br><span class="line">                    <span class="keyword">throw</span> <span class="keyword">new</span> <span class="title class_">RuntimeException</span>(e);</span><br><span class="line">                &#125;</span><br><span class="line">            &#125;</span><br><span class="line">            JDBCUtil.releaseConnection();</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">return</span> list;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">// 通用的增删改方法</span></span><br><span class="line">    <span class="keyword">public</span> <span class="type">int</span> <span class="title function_">baseUpdate</span><span class="params">(String sql,Object ... args)</span> &#123;</span><br><span class="line">        <span class="comment">// 获取连接</span></span><br><span class="line">        <span class="type">Connection</span> <span class="variable">connection</span> <span class="operator">=</span> JDBCUtil.getConnection();</span><br><span class="line">        PreparedStatement preparedStatement=<span class="literal">null</span>;</span><br><span class="line">        <span class="type">int</span> <span class="variable">rows</span> <span class="operator">=</span> <span class="number">0</span>;</span><br><span class="line">        <span class="keyword">try</span> &#123;</span><br><span class="line">            <span class="comment">// 准备语句对象</span></span><br><span class="line">            preparedStatement = connection.prepareStatement(sql);</span><br><span class="line">            <span class="comment">// 设置语句上的参数</span></span><br><span class="line">            <span class="keyword">for</span> (<span class="type">int</span> <span class="variable">i</span> <span class="operator">=</span> <span class="number">0</span>; i &lt; args.length; i++) &#123;</span><br><span class="line">                preparedStatement.setObject(i+<span class="number">1</span>,args[i]);</span><br><span class="line">            &#125;</span><br><span class="line"></span><br><span class="line">            <span class="comment">// 执行 增删改 executeUpdate</span></span><br><span class="line">            rows = preparedStatement.executeUpdate();</span><br><span class="line">            <span class="comment">// 释放资源(可选)</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">        &#125; <span class="keyword">catch</span> (SQLException e) &#123;</span><br><span class="line">            e.printStackTrace();</span><br><span class="line">        &#125; <span class="keyword">finally</span> &#123;</span><br><span class="line">            <span class="keyword">if</span> (<span class="literal">null</span> != preparedStatement) &#123;</span><br><span class="line">                <span class="keyword">try</span> &#123;</span><br><span class="line">                    preparedStatement.close();</span><br><span class="line">                &#125; <span class="keyword">catch</span> (SQLException e) &#123;</span><br><span class="line">                    <span class="keyword">throw</span> <span class="keyword">new</span> <span class="title class_">RuntimeException</span>(e);</span><br><span class="line">                &#125;</span><br><span class="line"></span><br><span class="line">            &#125;</span><br><span class="line">            JDBCUtil.releaseConnection();</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="comment">// 返回的是影响数据库记录数</span></span><br><span class="line">        <span class="keyword">return</span> rows;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>



<h3 id="12-6-Cotroller层"><a href="#12-6-Cotroller层" class="headerlink" title="12.6 Cotroller层"></a>12.6 Cotroller层</h3><p>SysUser部分</p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="keyword">package</span> com.atguigu.schedule.controller;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> com.atguigu.schedule.pojo.SysUser;</span><br><span class="line"><span class="keyword">import</span> com.atguigu.schedule.service.SysUserService;</span><br><span class="line"><span class="keyword">import</span> com.atguigu.schedule.service.impl.SysUserServiceImpl;</span><br><span class="line"><span class="keyword">import</span> com.atguigu.schedule.util.MD5Util;</span><br><span class="line"><span class="keyword">import</span> jakarta.servlet.ServletException;</span><br><span class="line"><span class="keyword">import</span> jakarta.servlet.annotation.WebServlet;</span><br><span class="line"><span class="keyword">import</span> jakarta.servlet.http.HttpServlet;</span><br><span class="line"><span class="keyword">import</span> jakarta.servlet.http.HttpServletRequest;</span><br><span class="line"><span class="keyword">import</span> jakarta.servlet.http.HttpServletResponse;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> java.io.IOException;</span><br><span class="line"></span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@author</span> yuezi2048</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@version</span> 1.0</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="meta">@WebServlet(&quot;/user/*&quot;)</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">SysUserController</span> <span class="keyword">extends</span> <span class="title class_">BaseController</span> &#123;</span><br><span class="line">    <span class="keyword">private</span> <span class="type">SysUserService</span> <span class="variable">userService</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">SysUserServiceImpl</span>();</span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * 接收用户登录请求的业务方法（完成登录的业务接口）</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@param</span> request</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@param</span> response</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@throws</span> ServletException</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@throws</span> IOException</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="keyword">protected</span> <span class="keyword">void</span> <span class="title function_">login</span><span class="params">(HttpServletRequest request, HttpServletResponse response)</span> <span class="keyword">throws</span> ServletException, IOException &#123;</span><br><span class="line">        <span class="comment">// 1. 接收用户名密码</span></span><br><span class="line">        <span class="type">String</span> <span class="variable">username</span> <span class="operator">=</span> request.getParameter(<span class="string">&quot;username&quot;</span>);</span><br><span class="line">        <span class="type">String</span> <span class="variable">userPwd</span> <span class="operator">=</span> request.getParameter(<span class="string">&quot;userPwd&quot;</span>);</span><br><span class="line"></span><br><span class="line">        <span class="comment">// 2. 调用服务层方法，根据用户名查询用户信息</span></span><br><span class="line">        <span class="type">SysUser</span> <span class="variable">loginUser</span> <span class="operator">=</span> userService.findUserName(username);</span><br><span class="line">        <span class="keyword">if</span> (loginUser == <span class="literal">null</span>) &#123;</span><br><span class="line">            <span class="comment">// 用户名有误，跳转到用户名有误提示页</span></span><br><span class="line">            response.sendRedirect(<span class="string">&quot;/loginUsernameError.html&quot;</span>);</span><br><span class="line">        &#125; <span class="keyword">else</span> <span class="keyword">if</span> (!MD5Util.encrypt(userPwd).equals(loginUser.getUserPwd())) &#123;</span><br><span class="line">            <span class="comment">// 密码有误，跳转到密码有误提示也</span></span><br><span class="line">            response.sendRedirect(<span class="string">&quot;/loginUserPwdError.html&quot;</span>);</span><br><span class="line">        &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">            <span class="comment">// 跳转成功，跳转到首页</span></span><br><span class="line">            response.sendRedirect(<span class="string">&quot;/showSchedule.html&quot;</span>);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * 接收用户注册请求的业务处理方法（接口 不是java的接口）</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@param</span> req</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@param</span> resp</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@throws</span> ServletException</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@throws</span> IOException</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="keyword">protected</span> <span class="keyword">void</span> <span class="title function_">register</span><span class="params">(HttpServletRequest req, HttpServletResponse resp)</span> <span class="keyword">throws</span> ServletException, IOException &#123;</span><br><span class="line">        <span class="comment">// 1.接收用户提交的参数</span></span><br><span class="line">        <span class="type">String</span> <span class="variable">username</span> <span class="operator">=</span> req.getParameter(<span class="string">&quot;username&quot;</span>);</span><br><span class="line">        <span class="type">String</span> <span class="variable">userPwd</span> <span class="operator">=</span> req.getParameter(<span class="string">&quot;userPwd&quot;</span>);</span><br><span class="line"></span><br><span class="line">        <span class="comment">// 2. 调用service层方法 完成注册功能</span></span><br><span class="line">        <span class="comment">// 将参数封装为SysUser对象中 再调用register方法时传入（后续框架会自动完成封装 传参 先养成习惯）</span></span><br><span class="line">        <span class="type">SysUser</span> <span class="variable">sysUser</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">SysUser</span>(<span class="literal">null</span>, username, userPwd);</span><br><span class="line">        <span class="type">int</span> <span class="variable">rows</span> <span class="operator">=</span> userService.register(sysUser);</span><br><span class="line"></span><br><span class="line">        <span class="comment">// 3. 根据注册结果（成功 or 失败），做页面跳转</span></span><br><span class="line">        <span class="keyword">if</span> (rows &gt; <span class="number">0</span>) &#123;</span><br><span class="line">            resp.sendRedirect(<span class="string">&quot;/registerSuccess.html&quot;</span>);</span><br><span class="line">        &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">            resp.sendRedirect(<span class="string">&quot;/registerFail.html&quot;</span>);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">&#125;</span><br><span class="line"></span><br></pre></td></tr></table></figure>



<p>SysSchedule部分</p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="keyword">package</span> com.atguigu.schedule.controller;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> jakarta.servlet.ServletException;</span><br><span class="line"><span class="keyword">import</span> jakarta.servlet.annotation.WebServlet;</span><br><span class="line"><span class="keyword">import</span> jakarta.servlet.http.HttpServlet;</span><br><span class="line"><span class="keyword">import</span> jakarta.servlet.http.HttpServletRequest;</span><br><span class="line"><span class="keyword">import</span> jakarta.servlet.http.HttpServletResponse;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> java.io.IOException;</span><br><span class="line"><span class="keyword">import</span> java.lang.reflect.Method;</span><br><span class="line"></span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * 增加日程的请求 /schedule/add</span></span><br><span class="line"><span class="comment"> * 查询日程的请求 /schedule/find</span></span><br><span class="line"><span class="comment"> * 修改日程的请求 /schedule/update</span></span><br><span class="line"><span class="comment"> * 删除日程的请求 /schedule/remove</span></span><br><span class="line"><span class="comment"> *</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@author</span> yuezi2048</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@version</span> 1.0</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="meta">@WebServlet(&quot;/schedule/*&quot;)</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">SysScheduleController</span> <span class="keyword">extends</span> <span class="title class_">BaseController</span> &#123;</span><br><span class="line">    <span class="keyword">protected</span> <span class="keyword">void</span> <span class="title function_">add</span><span class="params">(HttpServletRequest req, HttpServletResponse resp)</span> <span class="keyword">throws</span> ServletException, IOException &#123;</span><br><span class="line">        System.out.println(<span class="string">&quot;add&quot;</span>);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">protected</span> <span class="keyword">void</span> <span class="title function_">find</span><span class="params">(HttpServletRequest req, HttpServletResponse resp)</span> <span class="keyword">throws</span> ServletException, IOException &#123;</span><br><span class="line">        System.out.println(<span class="string">&quot;find&quot;</span>);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">protected</span> <span class="keyword">void</span> <span class="title function_">update</span><span class="params">(HttpServletRequest req, HttpServletResponse resp)</span> <span class="keyword">throws</span> ServletException, IOException &#123;</span><br><span class="line">        System.out.println(<span class="string">&quot;update&quot;</span>);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">protected</span> <span class="keyword">void</span> <span class="title function_">remove</span><span class="params">(HttpServletRequest req, HttpServletResponse resp)</span> <span class="keyword">throws</span> ServletException, IOException &#123;</span><br><span class="line">        System.out.println(<span class="string">&quot;remove&quot;</span>);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">&#125;</span><br><span class="line"></span><br></pre></td></tr></table></figure>



<p>公共部分代码<code>BaseController</code>（根据URL的参数来执行对应的请求）</p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="keyword">package</span> com.atguigu.schedule.controller;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> jakarta.servlet.ServletException;</span><br><span class="line"><span class="keyword">import</span> jakarta.servlet.http.HttpServlet;</span><br><span class="line"><span class="keyword">import</span> jakarta.servlet.http.HttpServletRequest;</span><br><span class="line"><span class="keyword">import</span> jakarta.servlet.http.HttpServletResponse;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> java.io.IOException;</span><br><span class="line"><span class="keyword">import</span> java.lang.reflect.Method;</span><br><span class="line"></span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@author</span> yuezi2048</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@version</span> 1.0</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">BaseController</span> <span class="keyword">extends</span> <span class="title class_">HttpServlet</span> &#123;</span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="keyword">protected</span> <span class="keyword">void</span> <span class="title function_">service</span><span class="params">(HttpServletRequest req, HttpServletResponse resp)</span> <span class="keyword">throws</span> ServletException, IOException &#123;</span><br><span class="line">        <span class="type">String</span> <span class="variable">requestURI</span> <span class="operator">=</span> req.getRequestURI(); <span class="comment">// /schedule/add</span></span><br><span class="line">        String[] split = requestURI.split(<span class="string">&quot;/&quot;</span>);</span><br><span class="line">        <span class="type">String</span> <span class="variable">methodName</span> <span class="operator">=</span> split[split.length - <span class="number">1</span>];</span><br><span class="line"></span><br><span class="line">        <span class="comment">// 通过反射，使用方法名来调用方法</span></span><br><span class="line">        Class&lt;?&gt; aClass = <span class="built_in">this</span>.getClass();</span><br><span class="line">        <span class="keyword">try</span> &#123;</span><br><span class="line">            <span class="type">Method</span> <span class="variable">declaredMethod</span> <span class="operator">=</span> aClass.getDeclaredMethod(methodName, HttpServletRequest.class, HttpServletResponse.class);</span><br><span class="line">            declaredMethod.setAccessible(<span class="literal">true</span>); <span class="comment">// 暴力破解</span></span><br><span class="line">            declaredMethod.invoke(<span class="built_in">this</span>, req, resp);</span><br><span class="line">        &#125; <span class="keyword">catch</span> (Exception e) &#123;</span><br><span class="line">            e.printStackTrace();</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br></pre></td></tr></table></figure>



<h3 id="12-7-Service层"><a href="#12-7-Service层" class="headerlink" title="12.7 Service层"></a>12.7 Service层</h3><p>SysUserService</p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="keyword">package</span> com.atguigu.schedule.service;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> com.atguigu.schedule.pojo.SysUser;</span><br><span class="line"></span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * 该接口定义以sys_user为核心的业务处理</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@author</span> yuezi2048</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@version</span> 1.0</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">interface</span> <span class="title class_">SysUserService</span> &#123;</span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * 注册用户的方法</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@param</span> sysUser 包括用户注册的用户名和明文密码以SysUser对象的形式接收</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@return</span> 注册成功返回1，著猜测失败返回0</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="type">int</span> <span class="title function_">register</span><span class="params">(SysUser sysUser)</span>;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * 根据用户名获得完整用户信息的方法</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@param</span> username 要查询的用户名</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@return</span> 如果找到了 返回SysUser对象，找不到返回NULL</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    SysUser <span class="title function_">findUserName</span><span class="params">(String username)</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br></pre></td></tr></table></figure>



<p>SysUserService实现</p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="keyword">package</span> com.atguigu.schedule.service.impl;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> com.atguigu.schedule.dao.SysUserDao;</span><br><span class="line"><span class="keyword">import</span> com.atguigu.schedule.dao.impl.SysUserDaoImpl;</span><br><span class="line"><span class="keyword">import</span> com.atguigu.schedule.pojo.SysUser;</span><br><span class="line"><span class="keyword">import</span> com.atguigu.schedule.service.SysUserService;</span><br><span class="line"><span class="keyword">import</span> com.atguigu.schedule.util.MD5Util;</span><br><span class="line"></span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@author</span> yuezi2048</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@version</span> 1.0</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">SysUserServiceImpl</span> <span class="keyword">implements</span> <span class="title class_">SysUserService</span> &#123;</span><br><span class="line">    <span class="keyword">private</span> <span class="type">SysUserDao</span> <span class="variable">userDao</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">SysUserDaoImpl</span>();</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="keyword">public</span> <span class="type">int</span> <span class="title function_">register</span><span class="params">(SysUser sysUser)</span> &#123;</span><br><span class="line">        <span class="comment">// 将用户的明文密码转化成密文密码</span></span><br><span class="line">        sysUser.setUserPwd(MD5Util.encrypt(sysUser.getUserPwd()));</span><br><span class="line"></span><br><span class="line">        <span class="comment">// 调用Dao, 将sysUser信息存入数据库(可以将Dao对象单独定义到外面去 new一次就行)</span></span><br><span class="line">        <span class="keyword">return</span> userDao.addSysUser(sysUser);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="keyword">public</span> SysUser <span class="title function_">findUserName</span><span class="params">(String username)</span> &#123;</span><br><span class="line">        <span class="keyword">return</span> userDao.findByUsername(username);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>



<p>SysSchedule部分（待实现）</p>
</article><div class="post-copyright"><div class="post-copyright__author"><span class="post-copyright-meta"><i class="fas fa-circle-user fa-fw"></i>文章作者: </span><span class="post-copyright-info"><a href="https://yuezi2048.github.io">yuezi</a></span></div><div class="post-copyright__type"><span class="post-copyright-meta"><i class="fas fa-square-arrow-up-right fa-fw"></i>文章链接: </span><span class="post-copyright-info"><a href="https://yuezi2048.github.io/2024/10/02/2.Areas%F0%9F%8C%90/back-end-java/4.JavaWeb/5.%20Servlet/">https://yuezi2048.github.io/2024/10/02/2.Areas🌐/back-end-java/4.JavaWeb/5. Servlet/</a></span></div><div class="post-copyright__notice"><span class="post-copyright-meta"><i class="fas fa-circle-exclamation fa-fw"></i>版权声明: </span><span class="post-copyright-info">本博客所有文章除特别声明外，均采用 <a href="https://creativecommons.org/licenses/by-nc-sa/4.0/" target="_blank">CC BY-NC-SA 4.0</a> 许可协议。转载请注明来源 <a href="https://yuezi2048.github.io" target="_blank">yuezi</a>！</span></div></div><div class="tag_share"><div class="post-meta__tag-list"><a class="post-meta__tags" href="/tags/4-JavaWeb/">4.JavaWeb</a></div><div class="post-share"><div class="social-share" data-image="/img/touxiang.jpg" data-sites="qq,wechat"></div><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/butterfly-extsrc/sharejs/dist/css/share.min.css" media="print" onload="this.media='all'"><script src="https://cdn.jsdelivr.net/npm/butterfly-extsrc/sharejs/dist/js/social-share.min.js" defer></script></div></div><nav class="pagination-post" id="pagination"><a class="pagination-related" href="/2024/10/02/2.Areas%F0%9F%8C%90/back-end-java/4.JavaWeb/3.%20JavaScript/" title="3. JavaScript"><div class="cover" style="background: var(--default-bg-color)"></div><div class="info"><div class="info-1"><div class="info-item-1">上一篇</div><div class="info-item-2">3. JavaScript</div></div><div class="info-2"><div class="info-item-1">第三章 JavaScript1. JS简介1.1 JS起源和特点 JavaScript：由Netscape(网景)的LiveScript发展而来的基于对象的动态类型区分大小写的客户端脚本语言，最初目的是为了解决服务端语言，为用户提供流畅的访问速度，而当时服务端对数据验证慢，Netscape公司的浏览器Navigator提供了数据验证的基本功能 ECMA-262是正式JavaScript标准，基于 JavaScript (Netscape) 和JScript (Microsoft)，在1996年开始，1997.7采纳了首个版本 JavaScript正式名称为ECMAScript JS包括ECMAScript、DOM、BOM  	 JS是一种运行于浏览器端上的小脚本语句,可以实现网页如文本内容动,数据动态变化和动画特效等， 特点如下  脚本语言  解释型脚本语言，不同于C&#x2F;C++ Java...</div></div></div></a><a class="pagination-related" href="/2024/10/03/2.Areas%F0%9F%8C%90/back-end-java/4.JavaWeb/9.%E5%89%8D%E7%AB%AF%E5%B7%A5%E7%A8%8B%E5%8C%96%E4%B8%8B%E7%AF%87_%E6%95%B0%E6%8D%AE%E8%AF%B7%E6%B1%82_%E7%8A%B6%E6%80%81%E7%AE%A1%E7%90%86/" title="9.前端工程化下篇_数据请求_状态管理"><div class="cover" style="background: var(--default-bg-color)"></div><div class="info text-right"><div class="info-1"><div class="info-item-1">下一篇</div><div class="info-item-2">9.前端工程化下篇_数据请求_状态管理</div></div><div class="info-2"><div class="info-item-1">9. Vue3数据交互axios9.0 前置知识——promise9.0.1 回调函数 普通函数: 正常调用的函数,一般函数执行完毕后才会继续执行下一行代码 回调函数: 一些特殊的函数,表示未来才会执行的一些功能,后续代码不会等待该函数执行完毕就开始执行了  function fun1() &#123;    console.log(&quot;fun1 invoked&quot;);&#125;// 测试普通函数调用;console.log(&quot;code1 invoked&quot;);fun1();console.log(&quot;code2 invoked&quot;);/*	测试回调函数，以setTimeout为例	回调函数是一种基于事件的，自动调用函数	回调函数的其他代码不会等待回调函数执行完毕	回调函数是一种未来会执行的函数，回调函数以外的其他代码	生活案例：		邻家小美，那年18岁		承诺：10年之后，他未娶，你未嫁，匿名就结婚 &gt;&gt;&gt; function() &#123;&#125;			1. 进行中   其他代码继续执行			2....</div></div></div></a></nav><div class="relatedPosts"><div class="headline"><i class="fas fa-thumbs-up fa-fw"></i><span>相关推荐</span></div><div class="relatedPosts-list"><a class="pagination-related" href="/2024/09/01/2.Areas%F0%9F%8C%90/back-end-java/4.JavaWeb/1.%20JavaWeb%E6%A6%82%E8%BF%B0/" title="1. JavaWeb概述"><div class="cover" style="background: var(--default-bg-color)"></div><div class="info text-center"><div class="info-1"><div class="info-item-1"><i class="far fa-calendar-alt fa-fw"></i> 2024-09-01</div><div class="info-item-2">1. JavaWeb概述</div></div><div class="info-2"><div class="info-item-1">第一章 Web概述1.1 JavaWeb是什么 通过Java技术解决Web互联网领域的技术栈（使用JavaEE技术开发企业级互联网项目，项目规模和架构模式和JavaSE有很大区别） 客户-服务器模式 客户端：与用户交互，接收用户的输入，向服务器发送数据并返回服务器输出的数据 服务器：从硬件和软件两个方面描述(广义和狭义) 硬件上，是比普通计算机运行更快 负载更高 价格更贵，一般是网络中的大型客户机提供计算服务 软件上，是安装在计算机上的某个进程，根据不同的作用可以分为不同的服务器，如DNS redis ftp服务器等     应用 APP 微信小程序 PC端程序 PC浏览器 外设（小米音箱 电话手表 POS机等）    1.2 JavaWeb技术栈前端 HTML CSS JS ES6 Nodejs npm vite vue3 router pinia axios element-plus… 后端 HTTP xml Tomcat Servlet Request Response Cookie Session Filter Listener MySQL JDBC Druid...</div></div></div></a><a class="pagination-related" href="/2024/09/26/2.Areas%F0%9F%8C%90/back-end-java/4.JavaWeb/2.%20HTML_CSS/" title="2. HTML_CSS"><div class="cover" style="background: var(--default-bg-color)"></div><div class="info text-center"><div class="info-1"><div class="info-item-1"><i class="far fa-calendar-alt fa-fw"></i> 2024-09-26</div><div class="info-item-2">2. HTML_CSS</div></div><div class="info-2"><div class="info-item-1">第二章 HTML-CSS1. HTML入门1.1 HTML_CSS_JS作用 HTML用于搭建网站主体 CSS用于对页面元素美化 JS用于对页面元素动态处理  1.2 HTML概念HTML  HTML(Hyper Test Markup Language 超文本标记语言)，搭建网站结构，显示相关元素 HTML5   HTML5 技术结合了 HTML4.01 的相关标准并革新，符合现代网络发展要求，在 2008 年正式发布。HTML5 由不同的技术构成，其在互联网中得到了非常广泛的应用，提供更多增强网络应用的标准机。 与传统的技术相比，HTML5 的语法特征更加明显，并且结合了 SVG 的内容。这些内容在网页中使用可以更加便捷地处理多媒体内容，而且 HTML5中还结合了其他元素，对原有的功能进行调整和修改，进行标准化工作。 HTML5 在 2012...</div></div></div></a><a class="pagination-related" href="/2024/10/02/2.Areas%F0%9F%8C%90/back-end-java/4.JavaWeb/3.%20JavaScript/" title="3. JavaScript"><div class="cover" style="background: var(--default-bg-color)"></div><div class="info text-center"><div class="info-1"><div class="info-item-1"><i class="far fa-calendar-alt fa-fw"></i> 2024-10-02</div><div class="info-item-2">3. JavaScript</div></div><div class="info-2"><div class="info-item-1">第三章 JavaScript1. JS简介1.1 JS起源和特点 JavaScript：由Netscape(网景)的LiveScript发展而来的基于对象的动态类型区分大小写的客户端脚本语言，最初目的是为了解决服务端语言，为用户提供流畅的访问速度，而当时服务端对数据验证慢，Netscape公司的浏览器Navigator提供了数据验证的基本功能 ECMA-262是正式JavaScript标准，基于 JavaScript (Netscape) 和JScript (Microsoft)，在1996年开始，1997.7采纳了首个版本 JavaScript正式名称为ECMAScript JS包括ECMAScript、DOM、BOM  	 JS是一种运行于浏览器端上的小脚本语句,可以实现网页如文本内容动,数据动态变化和动画特效等， 特点如下  脚本语言  解释型脚本语言，不同于C&#x2F;C++ Java...</div></div></div></a><a class="pagination-related" href="/2024/09/15/2.Areas%F0%9F%8C%90/back-end-java/4.JavaWeb/4.%20XML_Tomcat_HTTP/" title="4. XML_Tomcat_HTTP"><div class="cover" style="background: var(--default-bg-color)"></div><div class="info text-center"><div class="info-1"><div class="info-item-1"><i class="far fa-calendar-alt fa-fw"></i> 2024-09-15</div><div class="info-item-2">4. XML_Tomcat_HTTP</div></div><div class="info-2"><div class="info-item-1">第四章 XML_Tomcat10_HTTP1. XML XML（EXtensible Markup Lanauage 可扩展标记语言），同和HTML一样，基本语法是标签	 可扩展：含义是XML允许自定义格式 在XML语法规范基础上，第三方应用程序、框架都会通过XML约束来规定配置文件中可以写什么以及怎么写 我们只需在第三方APP或框架上定义好的配置文件基础上，根据需求加以修改即可    	 1.1...</div></div></div></a><a class="pagination-related" href="/2024/10/13/2.Areas%F0%9F%8C%90/back-end-java/4.JavaWeb/10.%E9%98%B6%E6%AE%B5%E9%A1%B9%E7%9B%AE%E2%80%94%E2%80%94%E5%BE%AE%E5%A4%B4%E6%9D%A1/" title="10.阶段项目——微头条"><div class="cover" style="background: var(--default-bg-color)"></div><div class="info text-center"><div class="info-1"><div class="info-item-1"><i class="far fa-calendar-alt fa-fw"></i> 2024-10-13</div><div class="info-item-2">10.阶段项目——微头条</div></div><div class="info-2"><div class="info-item-1">10. 阶段项目——微头条1....</div></div></div></a><a class="pagination-related" href="/2025/05/06/2.Areas%F0%9F%8C%90/back-end-java/4.JavaWeb/6.%20Session_filter_listener/" title="6. Session_filter_listener"><div class="cover" style="background: var(--default-bg-color)"></div><div class="info text-center"><div class="info-1"><div class="info-item-1"><i class="far fa-calendar-alt fa-fw"></i> 2025-05-06</div><div class="info-item-2">6. Session_filter_listener</div></div><div class="info-2"><div class="info-item-1">第六章 Session_filter_listener1. Session1.1 为什么要Session HTTP是无状态协议(Stateless)，即HTTP协议本身不会保存请求和响应的通信状态 例如，在客户端请求——服务端回应 的C&#x2F;S响应模式下，服务器并不会记录该请求来自于哪个浏览器，即客户端的状态 生活例子：张三下馆子吃了一次，第二次再来吃，老板在有状态的情况下知道张三上次吃的啥，在无状态的情况下则不知道，需要张三重新点   引出使用Cookie配合Session解决HTTP协议中请求和响应的持久化问题 Cookie记录少量数据，通过响应头set-cookie来向客户端响应用户要保留的信息 Session记录更多数据，通过HttpSession对象保存和客户端相关的信息 Session的传递配合Cookie一起使用 生活例子：张三去银行办业务，银行给张三开户（Session），并发了银行卡（Cookie），后续张三通过Cookie给银行，银行就会通过Cookie查询到张三的Session    1.2 Cookie1.2.1...</div></div></div></a></div></div></div><div class="aside-content" id="aside-content"><div class="card-widget card-info text-center"><div class="avatar-img"><img src="/img/loading.gif" data-original="/img/touxiang.jpg" onerror="this.onerror=null;this.src='/img/friend_404.gif'" alt="avatar"/></div><div class="author-info-name">yuezi</div><div class="author-info-description">积微者速成</div><div class="site-data"><a href="/archives/"><div class="headline">文章</div><div class="length-num">603</div></a><a href="/tags/"><div class="headline">标签</div><div class="length-num">61</div></a><a href="/categories/"><div class="headline">分类</div><div class="length-num">85</div></a></div><a id="card-info-btn" target="_blank" rel="noopener" href="https://github.com/yuezi2048"><i class="fab fa-github"></i><span>Follow Me</span></a><div class="card-info-social-icons"><a class="social-icon" href="https://githubfast.com/yuezi2048" target="_blank" title="Github"><i class="fab fa-github"></i></a><a class="social-icon" href="https://blog.csdn.net/qq_46345703" target="_blank" title="CSDN"><i class="fa fa-book-open"></i></a><a class="social-icon" href="https://qm.qq.com/cgi-bin/qm/qr?k=dD62GIPTf5-iS4UdSfJRy7NHwsrCh3-j" target="_blank" title="QQ"><i class="fab fa-qq"></i></a><a class="social-icon" href="mailto:joyLing@stumail.nwu.edu.cn" target="_blank" title="Email"><i class="fas fa-envelope-open-text"></i></a></div></div><div class="card-widget card-announcement"><div class="item-headline"><i class="fas fa-bullhorn fa-shake"></i><span>公告</span></div><div class="announcement_content">积微者速成</div></div><div class="sticky_layout"><div class="card-widget" id="card-toc"><div class="item-headline"><i class="fas fa-stream"></i><span>目录</span><span class="toc-percentage"></span></div><div class="toc-content"><ol class="toc"><li class="toc-item toc-level-1"><a class="toc-link" href="#%E7%AC%AC%E4%BA%94%E7%AB%A0-Servlet"><span class="toc-text">第五章 Servlet</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#1-Servlet%E7%AE%80%E4%BB%8B"><span class="toc-text">1. Servlet简介</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#2-Servlet%E5%BC%80%E5%8F%91%E6%B5%81%E7%A8%8B-%E9%AA%8C%E8%AF%81%E6%B3%A8%E5%86%8C%E6%A1%88%E4%BE%8B"><span class="toc-text">2. Servlet开发流程(验证注册案例)</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#3-Servlet%E6%B3%A8%E8%A7%A3"><span class="toc-text">3. Servlet注解</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#3-1-WebServlet%E6%BA%90%E7%A0%81"><span class="toc-text">3.1 @WebServlet源码</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#3-2-WebServlet%E4%BD%BF%E7%94%A8"><span class="toc-text">3.2 @WebServlet使用</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#4-Servlet%E7%94%9F%E5%91%BD%E5%91%A8%E6%9C%9F"><span class="toc-text">4. Servlet生命周期</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#4-1-%E7%94%9F%E5%91%BD%E5%91%A8%E6%9C%9F%E7%AE%80%E4%BB%8B"><span class="toc-text">4.1 生命周期简介</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#4-2-%E7%94%9F%E5%91%BD%E5%91%A8%E6%9C%9F%E6%96%B9%E6%B3%95%E6%B5%8B%E8%AF%95"><span class="toc-text">4.2 生命周期方法测试</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#4-3-%E4%BD%BF%E7%94%A8%E7%BB%93%E8%AE%BA"><span class="toc-text">4.3 使用结论</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#5-Servlet%E6%BA%90%E7%A0%81%E8%BF%BD%E6%BA%AF%E5%92%8C%E7%BB%93%E8%AE%BA"><span class="toc-text">5. Servlet源码追溯和结论</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#5-1-%E7%BB%A7%E6%89%BF%E7%BB%93%E6%9E%84"><span class="toc-text">5.1 继承结构</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#5-2-%E6%BA%90%E7%A0%81%E5%88%86%E6%9E%90"><span class="toc-text">5.2 源码分析</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#5-3-%E7%BB%93%E8%AE%BA"><span class="toc-text">5.3 结论</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#6-ServletConfig%E5%92%8CServletContext"><span class="toc-text">6. ServletConfig和ServletContext</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#6-1-ServletConfig"><span class="toc-text">6.1 ServletConfig</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#6-2-ServletContext"><span class="toc-text">6.2 ServletContext</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#6-3-ServletContext%E5%85%B6%E4%BB%96%E9%87%8D%E8%A6%81API"><span class="toc-text">6.3 ServletContext其他重要API</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#7-HttpServletRequest"><span class="toc-text">7. HttpServletRequest</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#7-1-%E6%A6%82%E8%BF%B0"><span class="toc-text">7.1 概述</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#7-2-%E7%9B%B8%E5%85%B3API"><span class="toc-text">7.2 相关API</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#7-3-API%E6%B5%8B%E8%AF%95"><span class="toc-text">7.3 API测试</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#8-HttpServletResponse"><span class="toc-text">8. HttpServletResponse</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#8-1-%E6%A6%82%E8%BF%B0"><span class="toc-text">8.1 概述</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#8-2-%E7%9B%B8%E5%85%B3API"><span class="toc-text">8.2 相关API</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#8-3-%E6%B5%8B%E8%AF%95"><span class="toc-text">8.3 测试</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#9-%E8%AF%B7%E6%B1%82%E8%BD%AC%E5%8F%91%E5%92%8C%E5%93%8D%E5%BA%94%E9%87%8D%E5%AE%9A%E5%90%91"><span class="toc-text">9. 请求转发和响应重定向</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#9-1-%E6%A6%82%E5%BF%B5"><span class="toc-text">9.1 概念</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#9-2-%E8%AF%B7%E6%B1%82%E8%BD%AC%E5%8F%91"><span class="toc-text">9.2 请求转发</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#9-3-%E5%93%8D%E5%BA%94%E9%87%8D%E5%AE%9A%E5%90%91"><span class="toc-text">9.3 响应重定向</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#10-%E4%B9%B1%E7%A0%81%E5%92%8C%E8%B7%AF%E5%BE%84%E9%97%AE%E9%A2%98%E6%80%BB%E7%BB%93"><span class="toc-text">10. 乱码和路径问题总结</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#10-1-%E4%B9%B1%E7%A0%81%E9%97%AE%E9%A2%98"><span class="toc-text">10.1 乱码问题</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#10-2-%E8%B7%AF%E5%BE%84%E9%97%AE%E9%A2%98"><span class="toc-text">10.2 路径问题</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#10-2-1-%E5%89%8D%E7%AB%AF%E8%B7%AF%E5%BE%84%E9%97%AE%E9%A2%98"><span class="toc-text">10.2.1 前端路径问题</span></a><ol class="toc-child"><li class="toc-item toc-level-5"><a class="toc-link" href="#%E8%B7%AF%E5%BE%84%E5%AD%98%E5%9C%A8%E7%9A%84%E7%BC%BA%E9%99%B7%E5%92%8C%E6%94%B9%E8%BF%9B%E6%80%9D%E8%B7%AF"><span class="toc-text">路径存在的缺陷和改进思路</span></a></li></ol></li><li class="toc-item toc-level-4"><a class="toc-link" href="#10-2-2-%E9%87%8D%E5%AE%9A%E5%90%91%E8%B7%AF%E5%BE%84%E9%97%AE%E9%A2%98"><span class="toc-text">10.2.2 重定向路径问题</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#10-2-3-%E8%AF%B7%E6%B1%82%E8%BD%AC%E5%8F%91%E8%B7%AF%E5%BE%84%E9%97%AE%E9%A2%98"><span class="toc-text">10.2.3 请求转发路径问题</span></a></li></ol></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#11-MVC%E7%BB%93%E6%9E%84%E6%A8%A1%E5%BC%8F"><span class="toc-text">11. MVC结构模式</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#12-%E6%A1%88%E4%BE%8B%E2%80%94%E2%80%94%E6%97%A5%E7%A8%8B%E7%AE%A1%E7%90%86%E7%AC%AC%E4%BA%8C%E6%9C%9F"><span class="toc-text">12. 案例——日程管理第二期</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#12-1-DB"><span class="toc-text">12.1 DB</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#12-2-%E9%A1%B9%E7%9B%AE%E6%9E%B6%E6%9E%84"><span class="toc-text">12.2 项目架构</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#12-3-%E5%B7%A5%E5%85%B7%E7%B1%BB"><span class="toc-text">12.3 工具类</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#12-4-pojo%E5%B1%82"><span class="toc-text">12.4 pojo层</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#12-5-Dao%E5%B1%82"><span class="toc-text">12.5 Dao层</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#12-6-Cotroller%E5%B1%82"><span class="toc-text">12.6 Cotroller层</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#12-7-Service%E5%B1%82"><span class="toc-text">12.7 Service层</span></a></li></ol></li></ol></li></ol></div></div><div class="card-widget card-recent-post"><div class="item-headline"><i class="fas fa-history"></i><span>最新文章</span></div><div class="aside-list"><div class="aside-list-item no-cover"><div class="content"><a class="title" href="/2025/10/31/Excalidraw/Drawing%202024-11-01%2015.37.37.excalidraw/" title="Drawing 2024-11-01 15.37.37.excalidraw">Drawing 2024-11-01 15.37.37.excalidraw</a><time datetime="2025-10-31T04:19:26.621Z" title="发表于 2025-10-31 12:19:26">2025-10-31</time></div></div><div class="aside-list-item no-cover"><div class="content"><a class="title" href="/2025/10/31/2.Areas%F0%9F%8C%90/01.project/condefather/yupao/back-end/7.%E4%BC%98%E5%8C%96%E4%B8%BB%E9%A1%B5%E6%80%A7%E8%83%BD-%E4%BC%98%E5%8C%96%E6%89%B9%E9%87%8F%E5%AF%BC%E5%85%A5%E6%95%B0%E6%8D%AE/" title="7.优化主页性能-优化批量导入数据">7.优化主页性能-优化批量导入数据</a><time datetime="2025-10-31T04:19:26.102Z" title="发表于 2025-10-31 12:19:26">2025-10-31</time></div></div><div class="aside-list-item no-cover"><div class="content"><a class="title" href="/2025/10/31/2.Areas%F0%9F%8C%90/02.%E9%9D%A2%E7%BB%8F%E8%AE%B0%E5%BD%95/MySQL/81.%E4%BB%80%E4%B9%88%E6%98%AF%E6%B8%B8%E6%A0%87Cursor%E5%88%86%E9%A1%B5_%E5%AF%B9%E6%AF%94%E4%BC%A0%E7%BB%9FLIMIT_OFFSET%E5%88%86%E9%A1%B5%E7%9A%84%E4%BC%98%E5%8A%BF%E6%98%AF%E4%BB%80%E4%B9%88/" title="81.什么是游标Cursor分页_对比传统LIMIT_OFFSET分页的优势是什么">81.什么是游标Cursor分页_对比传统LIMIT_OFFSET分页的优势是什么</a><time datetime="2025-10-31T04:14:27.000Z" title="发表于 2025-10-31 12:14:27">2025-10-31</time></div></div><div class="aside-list-item no-cover"><div class="content"><a class="title" href="/2025/10/31/2.Areas%F0%9F%8C%90/02.%E9%9D%A2%E7%BB%8F%E8%AE%B0%E5%BD%95/MySQL/80.%E5%85%A8%E9%87%8F%E5%90%8C%E6%AD%A5%E5%92%8C%E5%A2%9E%E9%87%8F%E5%90%8C%E6%AD%A5%E5%90%84%E8%87%AA%E4%BC%98%E7%BC%BA%E7%82%B9/" title="80.全量同步和增量同步各自优缺点">80.全量同步和增量同步各自优缺点</a><time datetime="2025-10-31T04:13:32.000Z" title="发表于 2025-10-31 12:13:32">2025-10-31</time></div></div><div class="aside-list-item no-cover"><div class="content"><a class="title" href="/2025/10/31/2.Areas%F0%9F%8C%90/02.%E9%9D%A2%E7%BB%8F%E8%AE%B0%E5%BD%95/MySQL/79.%E4%BB%80%E4%B9%88%E6%98%AF%E6%89%B9%E9%87%8F%E6%95%B0%E6%8D%AE%E5%85%A5%E5%BA%93_%E7%9B%B8%E6%AF%94%E5%8D%95%E6%9D%A1%E6%8F%92%E5%85%A5%E4%BC%98%E5%8A%BF/" title="79.什么是批量数据入库_相比单条插入优势">79.什么是批量数据入库_相比单条插入优势</a><time datetime="2025-10-31T04:03:26.000Z" title="发表于 2025-10-31 12:03:26">2025-10-31</time></div></div></div></div></div></div></main><footer id="footer" style="background-image: url(/img/default.png);"><div id="footer-wrap"><div class="copyright">&copy;2019 - 2025 By yuezi</div><div class="framework-info"><span>框架 </span><a target="_blank" rel="noopener" href="https://hexo.io">Hexo 8.0.0</a><span class="footer-separator">|</span><span>主题 </span><a target="_blank" rel="noopener" href="https://github.com/jerryc127/hexo-theme-butterfly">Butterfly 5.3.5</a></div></div></footer></div><div id="rightside"><div id="rightside-config-hide"><button id="readmode" type="button" title="阅读模式"><i class="fas fa-book-open"></i></button><button id="darkmode" type="button" title="日间和夜间模式切换"><i class="fas fa-adjust"></i></button><button id="hide-aside-btn" type="button" title="单栏和双栏切换"><i class="fas fa-arrows-alt-h"></i></button></div><div id="rightside-config-show"><button id="rightside-config" type="button" title="设置"><i class="fas fa-cog fa-spin"></i></button><button class="close" id="mobile-toc-button" type="button" title="目录"><i class="fas fa-list-ul"></i></button><button id="go-up" type="button" title="回到顶部"><span class="scroll-percent"></span><i class="fas fa-arrow-up"></i></button></div></div><div><script src="/js/utils.js"></script><script src="/js/main.js"></script><div class="js-pjax"></div><script id="canvas_nest" defer="defer" color="0,0,255" opacity="0.7" zIndex="-1" count="99" mobile="false" src="https://cdn.jsdelivr.net/npm/butterfly-extsrc/dist/canvas-nest.min.js"></script><script async data-pjax src="//busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js"></script><div id="algolia-search"><div class="search-dialog"><nav class="search-nav"><span class="search-dialog-title">搜索</span><button class="search-close-button"><i class="fas fa-times"></i></button></nav><div class="search-wrap"><div id="algolia-search-input"></div><hr/><div id="algolia-search-results"><div id="algolia-hits"></div><div id="algolia-pagination"></div><div id="algolia-info"><div class="algolia-stats"></div><div class="algolia-poweredBy"></div></div></div></div></div><div id="search-mask"></div><script src="https://cdn.jsdelivr.net/npm/algoliasearch/dist/lite/builds/browser.umd.min.js"></script><script src="https://cdn.jsdelivr.net/npm/instantsearch.js/dist/instantsearch.production.min.js"></script><script src="/js/search/algolia.js"></script></div></div>
        <style>
            [bg-lazy] {
                background-image: none !important;
                background-color: #eee !important;
            }
        </style>
        <script>
            window.imageLazyLoadSetting = {
                isSPA: false,
                preloadRatio: 1,
                processImages: null,
            };
        </script><script>window.addEventListener("load",function(){var t=/\.(gif|jpg|jpeg|tiff|png)$/i,r=/^data:image\/[a-z\d\-\.\+]+;base64,/;Array.prototype.slice.call(document.querySelectorAll("img[data-original]")).forEach(function(a){var e=a.parentNode;"A"===e.tagName&&(t.test(e.href)||r.test(e.href))&&(e.href=a.dataset.original)})});</script><script>(r=>{r.imageLazyLoadSetting.processImages=t;var a=r.imageLazyLoadSetting.isSPA,o=r.imageLazyLoadSetting.preloadRatio||1,d=i();function i(){var t=Array.prototype.slice.call(document.querySelectorAll("img[data-original]")),e=Array.prototype.slice.call(document.querySelectorAll("[bg-lazy]"));return t.concat(e)}function t(t){(a||t)&&(d=i());for(var e,n=0;n<d.length;n++)0<=(e=(e=d[n]).getBoundingClientRect()).bottom&&0<=e.left&&e.top<=(r.innerHeight*o||document.documentElement.clientHeight*o)&&(()=>{var t,e,a,o,i=d[n];e=function(){d=d.filter(function(t){return i!==t}),r.imageLazyLoadSetting.onImageLoaded&&r.imageLazyLoadSetting.onImageLoaded(i)},(t=i).dataset.loaded||(t.hasAttribute("bg-lazy")?(t.removeAttribute("bg-lazy"),e&&e()):(a=new Image,o=t.getAttribute("data-original"),a.onload=function(){t.src=o,t.removeAttribute("data-original"),t.setAttribute("data-loaded",!0),e&&e()},a.onerror=function(){t.removeAttribute("data-original"),t.setAttribute("data-loaded",!1),t.src=o},t.src!==o&&(a.src=o)))})()}function e(){clearTimeout(t.tId),t.tId=setTimeout(t,500)}t(),document.addEventListener("scroll",e),r.addEventListener("resize",e),r.addEventListener("orientationchange",e)})(this);</script></body></html>